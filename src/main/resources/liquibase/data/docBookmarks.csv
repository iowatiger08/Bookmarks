MARK_ID,MARK_NAME,INTERNAL_NAME,MARK_SQL,DOC_SUBTYPE_ID,DOC_TYPE_NAME
55,Member Dependent Address,MEMBER_DEPENDENT_ADDRESS,"select a.address_1 as address_line_1, nvl(a.address_2,'') as address_line_2,
                  nvl(a.address_3,'') as address_line_3, a.city ||', ' || a.state ||' ' || dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_line ,a.city as city, a.state as state,
                  a.county as county,
                  dbo.pkg_benefit_s.f_build_zipcode(a.zip) as zip_code,
                  nvl((REPLACE(TO_CHAR(a.phone_1,'000,999,9999'),',','-')),'') as phone1,
                  nvl((REPLACE(TO_CHAR(a.phone_2,'000,999,9999'),',','-')),'') as phone2 ,
                  nvl((REPLACE(TO_CHAR(a.phone_3,'000,999,9999'),',','-')),'') as phone3,
                  nvl((REPLACE(TO_CHAR(a.phone_4,'000,999,9999'),',','-')),'') as phone4
                  from dbo.addresses a
                  where a.address_id = client.f_evalute_id(%MEMBER_ID,%DEPENDENT_ID,'ADDRESS')",,Member
56,Person Address,PERSON_ADDRESS,"select a.address_1 as address_line_1, nvl(a.address_2,'') as address_line_2, nvl(a.address_3,'') as address_line_3, 
                                   a.city ||', ' || a.state ||' ' || dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_line ,
                                   a.city as city, a.state as state, a.county as county, 
                                   dbo.pkg_benefit_s.f_build_zipcode(a.zip) as zip_code, 
                                   nvl((REPLACE(TO_CHAR(a.phone_1,'000,999,9999'),',','-')),'') as phone1, 
                                   nvl((REPLACE(TO_CHAR(a.phone_2,'000,999,9999'),',','-')),'') as phone2 , 
                                   nvl((REPLACE(TO_CHAR(a.phone_3,'000,999,9999'),',','-')),'') as phone3, 
                                   nvl((REPLACE(TO_CHAR(a.phone_4,'000,999,9999'),',','-')),'') as phone4 
                                   from dbo.addresses a where a.address_id = 
                                   nvl(%RCPT_ADDRESS_ID,dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'), %PERSON_ID,null,'C,R'))",,Member
58,Dependent Info,DEPENDENT_INFO,"select dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') ||' '|| (p.first_name) ||' '|| (p.middle_name) ||' '||
                                   (p.last_name) ||' '|| dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N') as dependentName,dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') as prefix, (p.first_name)
                                   as firstName, (p.middle_name) as middleName, (p.last_name) as lastName, dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N') as suffix,
                                   p.birth_date as birthDate, p.sex as sex, p.alt_identifier as altId, p.ssn as ssn,
                                   dbo.pkg_benefit_s.f_get_value_description('RELATION',d.relation,'Y','N') as relation
                                   from dbo.dependent d, dbo.person p where d.dependent_id = p.person_id and p.person_id = %DEPENDENT_ID",,Member
142,Employer Address,EMPLOYER_ADDRESS,"select ad.address_1 as ad1, ad.address_2 as ad2, ad.address_3 as ad3, ad.city as c , ad.state as s, ad.zip as z from dbo.addresses ad where ad.entity_id = dbo.pkg_benefit_s.f_get_entity_id('EMPLOYER') and ad.key_value=%EMPLOYER_ID",,Employer
81,Member Adjustments Grid,MEMBER_ADJUSTMENTS_GRID,"select ee.employer_name as employer, 
                                                             wh.job_category as Occupation_Code,  
                                                             to_char(wh.start_date,'mm/dd/yyyy')  ||' to ' ||to_char(wh.stop_date,'mm/dd/yyyy')  as Adjustment_TimeFrame,
                                                             wh.due_02 as Mem_Contr_Due, 
                                                             wh.work_01 as Adjustment_Amount,
                                                             wh.start_date
                                                             from  dbo.v_member_q     vmq,
                                                              dbo.employer            ee,
                                                              dbo.work_history_1      wh,
                                                              dbo.work_report         wr
                                                             where wh.member_id = vmq.member_id
                                                             and ee.employer_id=wh.employer_id
                                                             and wr.report_id = wh.report_id
                                                             and wr.report_status = 'RE'
                                                             and wr.report_type = 'AD'
                                                             and nvl(wh.wh_reason_code,'99') not in ('04') 
                                                             and trunc(wr.date_released) between trunc(%START_DATE) and trunc(%STOP_DATE)
                                                             and wh.member_id=%MEMBER_ID
                                                             and wh.employer_id=%EMPLOYER_ID
                                                             order by wh.start_date",,Member
118,Member Address Grid 5,MEM_ADDR_GRID_5,"select client.f_member_address_grid(%MEMBER_ID,5)
                                                         from dual",,Member
119,Member Address Grid 6,MEM_ADDR_GRID_6,"select client.f_member_address_grid(%MEMBER_ID,6)
                                                         from dual",,Member
59,Member Dependent Info,MEMBER_DEPENDENT_INFO,"select rtrim(dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') ||' '|| (p.first_name) ||' '||  NVL2(P.MIDDLE_NAME, p.middle_name ||' ', p.middle_name) ||
                  (p.last_name) ||' '|| dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N')) as dependentName,dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') as prefix, (p.first_name)
                  as firstName, (p.middle_name) as middleName, (p.last_name) as lastName, dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N') as suffix,
                  to_char(p.birth_date,'MM/DD/YYYY') as birthDate, p.sex as sex, p.alt_identifier as altId, REPLACE(TO_CHAR(p.ssn,'000,99,9999'),',','-') as ssn
                  from dbo.person p where p.person_id = client.f_evalute_id(%MEMBER_ID,%DEPENDENT_ID,'PERSON')",,Member
82,Contrib Sum,Contrib_Sum,"select  sum(nvl(pad.tax_deferred_contribution,0)) as Ctbr_Sum 
                                                                     from dbo.part_account        pa,
                                                                     dbo.part_account_detail pad,
                                                                     dbo.v_member_q          vmq,
                                                                     dbo.employer ee
                                                                     where pa.part_account_id = pad.part_account_id
                                                                     and pa.member_id = vmq.member_id
                                                                     and pad.part_account_detail_type_id =
                                                                     (Select padt.part_account_detail_type_id
                                                                     from dbo.part_account_detail_type padt
                                                                     where padt.internal_name = 'AC')
                                                                     and ee.employer_id=pad.employer_id
                                                                     and pa.member_id=%MEMBER_ID
                                                                     and pad.employer_id=%EMPLOYER_ID
                                                                     and to_char(pad.activity_date,'mm/dd/yyyy') between  to_char(%START_DATE,'mm/dd/yyyy') and  to_char(%STOP_DATE,'mm/dd/yyyy')",,Member
83,Total Empl Amt Due,Ttl_Empl_Amt_Due,"select sum(nvl(pad.tax_deferred_interest,0))+sum(nvl(padv.amount_02,0))+sum(nvl(padv.amount_03,0)) as Ctbr_Sum 
                                                                     from dbo.part_account pa,
                                                                     dbo.part_account_detail pad,
                                                                     dbo.v_member_q          vmq,
                                                                     dbo.employer ee,
                                                                     dbo.part_acct_detail_value padv
                                                                     where pa.part_account_id = pad.part_account_id
                                                                     and pa.member_id = vmq.member_id
                                                                     and pad.part_account_detail_id=padv.part_account_detail_id
                                                                     and ee.employer_id=pad.employer_id
                                                                     and pa.member_id=%MEMBER_ID
                                                                     and pad.employer_id=%EMPLOYER_ID
                                                                     and to_char(pad.activity_date,'mm/dd/yyyy') between  to_char(%START_DATE,'mm/dd/yyyy') and  to_char(%STOP_DATE,'mm/dd/yyyy')",,Member
84,Inserted By,INSERTED_BY,"select distinct(pa1.inserted_by) 
                                                                    from dbo.part_account pa1
                                                                    where pa1.inserted_date in 
                                                                    (select max(pa.inserted_date)
                                                                    from dbo.part_account        pa,
                                                                    dbo.part_account_detail pad,
                                                                    dbo.v_member_q          vmq,
                                                                    dbo.employer ee
                                                                    where pa.part_account_id = pad.part_account_id
                                                                    and pa.member_id = vmq.member_id
                                                                    and pad.part_account_detail_type_id =
                                                                    (Select padt.part_account_detail_type_id
                                                                    from dbo.part_account_detail_type padt
                                                                    where padt.internal_name = 'AC')
                                                                    and ee.employer_id=pad.employer_id
                                                                    and pa.member_id=%MEMBER_ID
                                                                    and pad.employer_id=%EMPLOYER_ID
                                                                     )",,Member
140,Member Old Address,MEMBER_OLD_ADDRESS,"select
                                             addr.address_1 as OLD_ADDRESS_1,
                                             addr.address_2 as OLD_ADDRESS_2,
                                             addr.address_3 as OLD_ADDRESS_3,
                                             addr.city      as OLD_CITY,
                                             addr.state     as OLD_STATE,
                                             addr.zip       as OLD_ZIP_CODE
                                          from 
                                             dbo.addresses addr
                                          where
                                             addr.address_id = client.f_get_member_old_address_id(%MEMBER_ID)",,Member
74,Current Date(mm/dd/yyyy),CURRENT_DATE1,"select to_char(sysdate,'mm/dd/yyyy') from dual",,Employer
120,Reporting Official Name Init,REP_OFF_NAME_INIT,"select dbo.pkg_benefit_s.f_get_value_description('PREFIX',Initcap(P.PREFIX),'Y','N') ||' '|| Initcap(P.FIRST_NAME) ||' '|| Initcap(p.middle_name) ||' '|| 
                                   Initcap(p.last_name) ||' '|| dbo.pkg_benefit_s.f_get_value_description('SUFFIX',Initcap(P.SUFFIX),'Y','N') as OfficialName,dbo.pkg_benefit_s.f_get_value_description('PREFIX',Initcap(P.PREFIX),'Y','N') as prefix, Initcap(p.first_name) 
                                   as firstName, Initcap(p.middle_name) as middleName, Initcap(p.last_name) as lastName, dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N') as suffix, 
                                   p.birth_date as birthDate, upper(p.sex) as sex, p.alt_identifier as altId, Initcap(p.status) as status, p.ssn as ssn
                                   from dbo.person p 
where
p.person_id in (select oi.person_id from dbo.oi_person oi where oi.oi_person_id in 
(select bek.key_value from dbo.business_entity_key bek where bek.business_entity_key_id in (
select ber.business_entity_key_id from dbo.business_entity_relation ber where ber.key_value=%EMPLOYER_ID
and ber.relation_role='RO')))",,Employer
122,Dependent Info Init,DEPENDENT_INFO_INIT,"select initcap(dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N')) ||' '|| initcap(p.first_name) ||' '|| initcap(p.middle_name) ||' '||
                                   initcap(p.last_name) ||' '|| initcap(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N')) as dependentName,initcap(dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N')) as prefix, initcap(p.first_name)
                                   as firstName, initcap(p.middle_name) as middleName, initcap(p.last_name) as lastName, initcap(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N')) as suffix,
                                   p.birth_date as birthDate, initcap(p.sex) as sex, p.alt_identifier as altId, p.ssn as ssn,
                                   initcap(dbo.pkg_benefit_s.f_get_value_description('RELATION',d.relation,'Y','N')) as relation
                                   from dbo.dependent d, dbo.person p where d.dependent_id = p.person_id and p.person_id = %DEPENDENT_ID",,Member
123,Member Information,MEMBER_INFORMATION,"select dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') ||' '|| p.sort_name as memberName,dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') as prefix, 
                                   p.birth_date as birthDate, p.sex as sex, p.alt_identifier as altId, p.status as status, p.ssn as ssn
                                   from dbo.member m, dbo.person p 
                                   where m.member_id = %MEMBER_ID and p.person_id = m.person_id",,Member
124,Member Address Grid 7,MEM_ADDR_GRID_7,"select client.f_member_address_grid(%MEMBER_ID,7)
                                                         from dual",,Member
125,Member Address Grid 8,MEM_ADDR_GRID_8,"select client.f_member_address_grid(%MEMBER_ID,8)
                                                         from dual",,Member
126,Member Address Grid 9,MEM_ADDR_GRID_9,"select client.f_member_address_grid(%MEMBER_ID,9)
                                                         from dual",,Member
134,Final report Date,FINAL_REPORT_DATE,"select max(mc.final_report_date) 
from dbo.member_contract mc 
where mc.employer_id=%EMPLOYER_ID",,Employer
135,Next Due Date,NEXT_DUE_DATE,select CLIENT.f_get_next_due_date(%EMPLOYER_ID) from dual,,Employer
104,Reporting Official Name,REP_OFF_NAME,"select dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') ||' '|| (P.FIRST_NAME) ||' '|| (p.middle_name) ||' '|| 
                                   (p.last_name) ||' '|| dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N') as OfficialName,dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') as prefix, (p.first_name) 
                                   as firstName, (p.middle_name) as middleName, (p.last_name) as lastName, dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N') as suffix, 
                                   p.birth_date as birthDate, p.sex as sex, p.alt_identifier as altId, p.status as status, p.ssn as ssn
                                   from dbo.person p 
where
p.person_id in (select oi.person_id from dbo.oi_person oi where oi.oi_person_id in 
(select bek.key_value from dbo.business_entity_key bek where bek.business_entity_key_id in (
select ber.business_entity_key_id from dbo.business_entity_relation ber where ber.key_value=%EMPLOYER_ID
and ber.relation_role='RO')))",,Employer
75,Compliance Issue,COMPLIANCE_ISSUE,"select val.value as ISSUE,av.Description 
  from dbo.attribute_value av
  left outer join 
  (select dv.value
          from dbo.datasheet_value          dv,
               dbo.datasheet_owner          do,
               dbo.datasheet_value_instance dvi
         where dv.owner_id = do.owner_id
           and dv.instance_id = dvi.instance_id
           and dv.key_value = %employer_id
           and dvi.description = to_char(%REVIEW_DATE)
           and dv.datasheet_id =
               dbo.pkg_benefit_ds.f_get_datasheet_id('DS_AUDIT_HISTORY')
           and do.entity_id = dbo.pkg_benefit_s.f_get_entity_id('EMPLOYER')) val on
  (av.internal_value = val.value)    
where
av.attribute_id = dbo.pkg_benefit_s.f_get_attribute_id('DS_ISSUE_TYPE')
order by av.Description    ",,Employer
77,Review Date,REVIEW_DATE,select distinct dvi.description from dbo.datasheet_value_instance dvi where dvi.description=to_char(%REVIEW_DATE),,Employer
78,Reporting Officer Address,REPORTING_OFFICER_ADDRESS,"select decode(address_1,null,' ',address_1) as Address1,
    decode(address_2,null,' ',chr(10)||address_2) as Address2,
    decode(address_3,null,' ',chr(10)||address_3) as Address3,
    city ||', '||state ||' '||
    DECODE(country,'US',
                    substr(to_char(nvl(zip,0),'000000000'),1,6)||
                    decode(substr(to_char(nvl(zip,0),'000000000'),7,4),'0000','','-'||
                    substr(to_char(nvl(zip,0),'000000000'),7,4)),
                    postal_code -- if not US
        )
    ||chr(10)||
    decode(country,'US','',country)
    as Reporting_Person_City_State
    from dbo.addresses
    where address_id = dbo.f_Get_current_address_id((select vopq.entity_id from dbo.V_OI_PARTY_Q vopq where vopq.key_value in (
select bek.key_value from dbo.business_entity_key bek where bek.business_entity_key_id in (
select ber.business_entity_key_id from dbo.business_entity_relation ber where ber.key_value=%EMPLOYER_ID
and ber.relation_role='RO'))),(select vopq.key_value from dbo.V_OI_PARTY_Q vopq where vopq.key_value in (
select bek.key_value from dbo.business_entity_key bek where bek.business_entity_key_id in (
select ber.business_entity_key_id from dbo.business_entity_relation ber where ber.key_value=%EMPLOYER_ID
and ber.relation_role='RO'))))",,Employer
92,Member Name Info,MEMBER_NAME_INFO," 
                                                    select trim(decode(PREFIX, null, null,
                                                                               DBO.pkg_benefit_s.f_get_value_description('PREFIX',PREFIX, 'Y', 'N')||' ' ) ||
                                                           FIRST_NAME||' '||
                                                           decode(trim(MIDDLE_NAME), null, null, (trim(MIDDLE_NAME)||' '))||
                                                           last_name ||      
                                                           decode(SUFFIX, null, null,
                                                                               ' '||DBO.pkg_benefit_s.f_get_value_description('SUFFIX',SUFFIX, 'Y', 'N') ))  as member_names,
                                                           trim(first_name) as first_name ,
                                                           to_char(birth_date , 'MM/DD/YYYY') as birth_date_FM                  
                                                    from                           
                                                            DBO.V_MEMBER_Q
                                                     WHERE MEMBER_ID = %MEMBER_ID
                                                    ",,Member
93,Member Address Info,MEMBER_ADDRESS_INFO,"select UPPER(trim(a.address_1)) as address_1,--SV1
                                                              UPPER(trim(a.address_2)) as address_2,
                                                              UPPER(trim(a.address_3)) as address_3,
                                                              UPPER(a.city||' '||a.state||' '||dbo.pkg_benefit_s.f_build_zipcode(a.zip)) as city_state_zip,
                                                              UPPER(decode(trim( a.address_3), null, null,
                                                                                      trim( a.address_3)||chr(10)) ||
                                                               trim(a.address_1) ||chr(10)||
                                                               decode(trim( a.address_2), null, null,
                                                                                          trim( a.address_2)||chr(10)) ||                          
                                                                 a.city||' '||a.state||' '||dbo.pkg_benefit_s.f_build_zipcode(a.zip))  as member_address,
                                                                 UPPER(a.city) as city,
                                                                 UPPER(decode(trim( a.address_3), null, null,
                                                                                      trim( a.address_3)||chr(10)) ||
                                                               trim(a.address_1) ||chr(10)||
                                                               decode(trim( a.address_2), null, null,
                                                                                          trim( a.address_2)||chr(10)) ||                          
                                                                 a.city||'  '||a.state||' '||dbo.pkg_benefit_s.f_build_zipcode(a.zip))  as member_address_new                                                                 
                                                        from dbo.addresses a, dbo.v_member_q m
                                                        where m.member_id = %MEMBER_ID
                                                        and  a.address_id =  dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'), m.person_id, 'R') 
                                                        ",,Member
85,Member Address Upper,MEMBER_ADDRESS_UPPER,"select upper(a.address_1) as address_line_1, upper(nvl(a.address_2,'')) as address_line_2, 
                                                   upper(nvl(a.address_3,'')) as address_line_3, upper(a.city) ||' ' || upper(a.state) ||' ' || dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_line ,upper(a.city) as city, upper(a.state) as state, upper(a.county) as county, 
                                                   dbo.pkg_benefit_s.f_build_zipcode(a.zip) as zip_code, nvl(a.phone_1,'') as phone1, nvl(a.phone_2,'') as phone2 , 
                                                   nvl(a.phone_3,'') as phone3, nvl(a.phone_4,'') as phone4 from dbo.addresses a, dbo.member m 
                                                   where m.member_id = %MEMBER_ID and a.address_id = 
                                                   dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'), m.person_id,null,'C,R')",,Member
86,Member Dependent Address Upper,MEMBER_DEPENDENT_ADDRESS_UPPER,"select upper(a.address_1) as address_line_1, upper(nvl(a.address_2,'')) as address_line_2,
                  upper(nvl(a.address_3,'')) as address_line_3, upper(a.city) ||', ' || upper(a.state) ||' ' || dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_line ,upper(a.city) as city, upper(a.state) as state,
                  upper(a.county) as county,
                  dbo.pkg_benefit_s.f_build_zipcode(a.zip) as zip_code,
                  nvl((REPLACE(TO_CHAR(a.phone_1,'000,999,9999'),',','-')),'') as phone1,
                  nvl((REPLACE(TO_CHAR(a.phone_2,'000,999,9999'),',','-')),'') as phone2 ,
                  nvl((REPLACE(TO_CHAR(a.phone_3,'000,999,9999'),',','-')),'') as phone3,
                  nvl((REPLACE(TO_CHAR(a.phone_4,'000,999,9999'),',','-')),'') as phone4
                  from dbo.addresses a
                  where a.address_id = client.f_evalute_id(%MEMBER_ID,%DEPENDENT_ID,'ADDRESS')",,Member
87,Person Address Upper,PERSON_ADDRESS_UPPER,"select upper(a.address_1) as address_line_1, upper(nvl(a.address_2,'')) as address_line_2, upper(nvl(a.address_3,'')) as address_line_3, 
                                   upper(a.city) ||', ' || upper(a.state) ||' ' || dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_line ,
                                   upper(a.city) as city, upper(a.state) as state, upper(a.county) as county, 
                                   dbo.pkg_benefit_s.f_build_zipcode(a.zip) as zip_code, 
                                   nvl((REPLACE(TO_CHAR(a.phone_1,'000,999,9999'),',','-')),'') as phone1, 
                                   nvl((REPLACE(TO_CHAR(a.phone_2,'000,999,9999'),',','-')),'') as phone2 , 
                                   nvl((REPLACE(TO_CHAR(a.phone_3,'000,999,9999'),',','-')),'') as phone3, 
                                   nvl((REPLACE(TO_CHAR(a.phone_4,'000,999,9999'),',','-')),'') as phone4 
                                   from dbo.addresses a where a.address_id = 
                                   nvl(%RCPT_ADDRESS_ID,dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'), %PERSON_ID,null,'C,R'))",,Member
89,Dependent Info Upper,DEPENDENT_INFO_UPPER,"select upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N')) ||' '|| upper(p.first_name) ||' '|| upper(p.middle_name) ||' '||
                                   upper(p.last_name) ||' '|| upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N')) as dependentName,upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N')) as prefix, upper(p.first_name)
                                   as firstName, upper(p.middle_name) as middleName, upper(p.last_name) as lastName, upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N')) as suffix,
                                   p.birth_date as birthDate, upper(p.sex) as sex, p.alt_identifier as altId, p.ssn as ssn,
                                   upper(dbo.pkg_benefit_s.f_get_value_description('RELATION',d.relation,'Y','N')) as relation
                                   from dbo.dependent d, dbo.person p where d.dependent_id = p.person_id and p.person_id = %DEPENDENT_ID",,Member
90,Member Dependent Info Upper,MEMBER_DEPENDENT_INFO_UPPER,"select upper(rtrim(dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') ||' '|| upper(p.first_name) ||' '||  upper(NVL2(P.MIDDLE_NAME, p.middle_name ||' ', p.middle_name)) ||
                  upper(p.last_name) ||' '|| upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N'))) as dependentName,upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N')) as prefix, upper(p.first_name)
                  as firstName, upper(p.middle_name) as middleName, upper(p.last_name) as lastName, upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N')) as suffix,
                  to_char(p.birth_date,'MM/DD/YYYY') as birthDate, upper(p.sex) as sex, p.alt_identifier as altId, REPLACE(TO_CHAR(p.ssn,'000,99,9999'),',','-') as ssn
                  from dbo.person p where p.person_id = client.f_evalute_id(%MEMBER_ID,%DEPENDENT_ID,'PERSON')",,Member
91,Employer Information Upper,EMPLOYER_INFORMATION_UPPER,"select upper(e.sort_name) as empSortName, e.employer_code as empCode, upper(e.employer_name) as empName 
                                                   from dbo.member_contract mc, dbo.employer e where mc.member_contract_id = 
                                                   client.f_get_current_member_contract(%MEMBER_ID,NVL(%AS_OF_DATE,SYSDATE)) and e.employer_id = mc.employer_id",,Employer
141,Member Address Grid,MEM_ADDR_GRID,"select client.f_member_address_grid(m.member_id)
                                     from dbo.member m where m.member_id=%MEMBER_ID",,Member
69,Member Self Service Document Page Link,V3_MEMBER_SS_WEBSITE_DOCUMENT_PAGE_INFO,select  'http://localhost:8080/app?service=external/MemberPages:MemberDocuments' as memberSelfServiceURL from dual,,Member
51,Rcpt Address,RCPT_ADDRESS,bookmarks.global.RcptAddressBookmark,,Member
52,User Info,USER_INFO,"select CASE
         WHEN initcap(nvl(p.last_name, su.user_name)) = 'Exebatch' THEN
          ''
         ELSE
          initcap(nvl(p.last_name, su.user_name))
       END as last_name,
       CASE
         WHEN initcap(first_name) = 'Exebatch' THEN
          'IPERS Benefits Staff.'
            ELSE
          initcap(first_name)
       END as first_name
  from dbo.security_users su, dbo.person p
 where su.security_users_id = %SECURITY_USERS_ID
   and p.person_id(+) = su.person_id",,Member
54,Member Address,MEMBER_ADDRESS,"select a.address_1 as address_line_1, nvl(a.address_2,'') as address_line_2, 
                                                   nvl(a.address_3,'') as address_line_3, a.city ||' ' || a.state ||' ' || dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_line ,a.city as city, a.state as state, a.county as county, 
                                                   dbo.pkg_benefit_s.f_build_zipcode(a.zip) as zip_code, nvl(a.phone_1,'') as phone1, nvl(a.phone_2,'') as phone2 , 
                                                   nvl(a.phone_3,'') as phone3, nvl(a.phone_4,'') as phone4 from dbo.addresses a, dbo.member m 
                                                   where m.member_id = %MEMBER_ID and a.address_id = 
                                                   dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'), m.person_id,null,'C,R')",,Member
121,Member Info Init,MEMBER_INFO_INIT,"select initcap(dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N')) ||' '|| initcap(P.FIRST_NAME) ||' '|| initcap(p.middle_name) ||' '|| 
                                   initcap(p.last_name) ||' '|| initcap(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N')) as memberName,initcap(dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N')) as prefix, initcap(p.first_name) 
                                   as firstName, initcap(p.middle_name) as middleName, initcap(p.last_name) as lastName, initcap(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N')) as suffix, 
                                   p.birth_date as birthDate, initcap(p.sex) as sex, p.alt_identifier as altId, initcap(p.status) as status, p.ssn as ssn
                                   from dbo.member m, dbo.person p 
                                   where m.member_id = %MEMBER_ID and p.person_id = m.person_id",,Member
600,BENEFICIARY_SALUTATION_1,BENEFICIARY_SALUTATION_1,"SELECT UPPER(bp.first_name) || CASE
         WHEN bp.last_name IS NOT NULL THEN
          ' ' || UPPER(bp.last_name) || ':'
       END beneficiary_name
  FROM web.v_linked_beneficiaries lb,
       dbo.beneficiary            be,
       dbo.beneficiary_type       bt,
       dbo.person                 bp,
       DBO.Member                 m
 WHERE lb.alt_beneficiary_id = be.alt_beneficiary_id
   AND be.beneficiary_type_id = bt.beneficiary_type_id
   AND (be.stop_date IS NULL OR be.stop_date > TRUNC(SYSDATE))
   AND be.start_date <= TRUNC(SYSDATE)
   AND be.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
   AND lb.dependent_id = bp.person_id
   AND m.person_id = be.person_id
   AND m.member_id = %MEMBER_ID
 ORDER BY bt.beneficiary_type_code, bp.last_name, bp.first_name",,Pension
601,User Info 1,USER_INFO_1,"select CASE
         WHEN initcap(nvl(p.last_name, su.user_name)) = 'Exebatch' THEN
          ''
         ELSE
          initcap(nvl(p.last_name, su.user_name))
       END as last_name,
       CASE
         WHEN initcap(first_name) = 'Exebatch' THEN
          'IPERS Benefits Staff'
            ELSE
          initcap(first_name)
       END as first_name
  from dbo.security_users su, dbo.person p
 where su.security_users_id = %SECURITY_USERS_ID
   and p.person_id(+) = su.person_id",,Pension
602,Next Payroll Date,NEXT_PAYROLL_DATE,"select trim(TO_CHAR(SYSDATE + 30,'fm Month yyyy')) as dayPlus30,TO_CHAR(sysdate,'MM/DD/YYYY')||',' as currentDate from dual",,Pension
182,Taxable Amount,TAXABLE_AMOUNT,"select client.f_get_refund_info ((select pa.part_account_id from dbo.part_account pa
                                                             where pa.member_id = %MEMBER_ID), 1)
                                                             from dual",,Member
183,Non-Taxable Amount,NON_TAXABLE_AMOUNT,"select client.f_get_refund_info ((select pa.part_account_id from dbo.part_account pa
                                                             where pa.member_id = %MEMBER_ID), 2)
                                                             from dual",,Member
184,Federal WH Amount,FEDERAL_WH_AMOUNT,"select client.f_get_refund_info ((select pa.part_account_id from dbo.part_account pa
                                                             where pa.member_id = %MEMBER_ID), 3)
                                                             from dual",,Member
185,State WH Amount,STATE_WH_AMOUNT,"select client.f_get_refund_info ((select pa.part_account_id from dbo.part_account pa
                                                             where pa.member_id = %MEMBER_ID), 4)
                                                             from dual",,Member
186,Member ID,MEMBER_ID,"SELECT P.ALT_IDENTIFIER AS MEMBER_ID
                                                             from dbo.member m, dbo.person p
                                                             where m.member_id = %MEMBER_ID
                                                             and p.person_id = m.person_id",,Member
187,Full User Info,FULL_USER_INFO,"select initcap(nvl(p.prefix,'')) ||' '||
                                                             initcap(first_name) ||' '||
                                                             initcap(nvl(p.middle_name,'')) ||' '||
                                                             initcap(nvl(p.last_name, su.user_name)) ||' '||
                                                             initcap(nvl(p.suffix,'')) as Full_User_Info
                                                             from dbo.security_users su, dbo.person p
                                                             where su.security_users_id = %SECURITY_USERS_ID
                                                             and p.person_id(+) = su.person_id",,Member
188,Member Meeting Details,MEM_MEETING_DETAILS,"Select m.subject as Meeting_Name, TO_CHAR(cd.start_date, 'mm/dd/yyyy') as Meeting_Date, 
                                                             to_char(cd.start_date,'Day') as Meeting_WeekDay,
                                                             to_char(m.start_date,'HH:MI AM') as Meeting_Start_time, 
                                                             to_char(m.stop_date,'HH:MI AM') as Meeting_Stop_time,
                                                             oio.Oi_name as Facility_Name
                                                             from workforce.meeting m, workforce.meeting_participant mp,
                                                             workforce.conference_days cd, workforce.conference c, dbo.oi_organization oio
                                                             where m.conference_days_id = cd.conference_days_id
                                                             and cd.conference_id = c.conference_id
                                                             and c.Location_Id = oio.organization_id
                                                             and m.meeting_id = mp.meeting_Id
                                                             and m.meeting_Id = %MEETING_ID
                                                             and mp.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                                                             and mp.key_value = (Select m.Person_Id 
                                                             from dbo.Member m where m.member_Id = %MEMBER_ID)",,Member
189,Conference Location Address,CONF_LOCATION_ADDRESS,"Select ad.address_1 as Ad1, ad.address_2 as Ad2, ad.Address_3 as Ad3,
                                                             ad.city, ad.state,
                                                             dbo.pkg_benefit_s.f_build_zipcode(ad.zip) as Zip
                                                             from dbo.addresses ad
                                                             where ad.entity_Id = dbo.pkg_Benefit_s.f_get_entity_Id('OI_ORGANIZATION')
                                                             and ad.key_value =
                                                             (Select oio.oi_Organization_id
                                                             from dbo.oi_Organization oio, workforce.conference c,
                                                             workforce.conference_days cd, workforce.meeting mt
                                                             where oio.organization_id = c.location_Id
                                                             and c.conference_Id = cd.conference_id
                                                             and cd.conference_days_id = mt.conference_days_id
                                                             and mt.meeting_id = %MEETING_ID)",,Employer
603,Age 70 continued working,AGE_70_CONTINUED_WORKING," select pp.code_03
   from dbo.pension_preapp pp, dbo.v_pension_application_q vq
  where vq.application_id = pp.pension_application_id
    and vq.application_id = %PENSION_APPLICATION_ID",,Member
525,Pension Bene Expiry Date,PEN_BENE_EXP_DATE,"select add_months(to_date(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                            'PN_FME'),'mm/dd/yyyy'),119) from dual",,Pension
526,Beneficiary Summary - AMDB,BEN_SUMMARY_BLOCK_AMDB,"select Display_name as Descrip,
                                                      Amount_01 as Current_Month,
                                                      Amount_02 as Next_Month
                                                      from table(CLIENT.f_get_ben_summary_block_amdb(%PENSION_APPLICATION_ID))",,Pension
527,AP Address Info,AP_ADDR_INFO,"select trim(a.address_1) as address_1, trim(a.address_2) as address_2,
                                                             trim(a.address_3) as address_3, a.city || ' ' || a.state || ' ' ||
                                                             dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_zip,
  case --NG2
  when a.country = 'US' then
   TRIM(decode(a.address_3,
               null,
               '',
               upper(a.address_3) || chr(10)) ||
        decode(a.address_1, null, '', upper(a.address_1)) ||
        decode(a.address_2,
               null,
               '',
               chr(10) || upper(a.address_2)) || chr(10) ||
        upper(a.city) || ' ' || upper(a.state) || ' ' ||
        dbo.pkg_benefit_s.f_build_zipcode(a.zip))
  else
   TRIM(decode(a.address_3,
            null,
            '',
            upper(a.address_3) || chr(10)) ||
     decode(a.address_1, null, '', upper(a.address_1)) ||
     decode(a.address_2,
            null,
            '',
            chr(10) || upper(a.address_2)) || chr(10) ||
     upper(a.city) ||
     (select case
               when upper((Select upper(s.state_name)
                            from dbo.state s, dbo.country c
                           where s.country_id = c.country_id
                             and c.country_code = a.country
                             and s.state_code = a.state)) is not null then
                ', ' ||
                upper((Select upper(s.state_name)
                        from dbo.state s, dbo.country c
                       where s.country_id = c.country_id
                         and c.country_code = a.country
                         and s.state_code = a.state))
               else
                ''
             end
        from dual) ||
        (select case
               when a.postal_code  is not null then
                ', ' ||
                a.postal_code
               else
                ''
             end
        from dual)|| chr(10) ||
     upper((Select upper(c.country_name)
             from dbo.country c
            where c.country_code = a.country)))
end as member_address,
                                                             initcap(a.city) as city
                                                             from dbo.addresses a, dbo.v_member_q m, dbo.dependent d
                                                             where m.member_id = %MEMBER_ID
                                                             AND m.person_id = d.person_id
                                                             and d.dependent_id = %PERSON_ID
                                                             and a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                             d.dependent_id,'R')",,Pension
529,AP Info,AP_INFO,"select trim(decode(mp.PREFIX,null,
                                                             null,upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                             mP.PREFIX,'Y',
                                                             'N')) || ' ') ||
                                                             upper(mP.FIRST_NAME) || ' ' || upper(mp.middle_name) || ' ' ||
                                                             upper(mp.last_name) || ' ' || upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                             mP.SUFFIX,'Y','N'))) as memberName,
                                                             upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',mP.PREFIX,
                                                             'Y','N')) as Memprefix,
                                                             upper(mp.first_name) as MemfirstName,
                                                             upper(mp.middle_name) as MemmiddleName,
                                                             upper(mp.last_name) as MemlastName,
                                                             upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX', mP.SUFFIX,
                                                             'Y','N')) as Memsuffix,
                                                             mp.alt_identifier as MemberID,
                                                             trim(decode(ap.PREFIX, null,null,
                                                             upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX', aP.PREFIX,
                                                              'Y','N')) || ' ') ||
                                                              upper(aP.FIRST_NAME) || ' ' || upper(ap.middle_name) || ' ' ||
                                                              upper(ap.last_name) || ' ' ||
                                                              upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                              aP.SUFFIX,'Y','N'))) as APName       
                                                              from dbo.member m, dbo.person mp, dbo.person ap, dbo.dependent d
                                                              where m.member_id = %MEMBER_ID
                                                              and mp.person_id = m.person_id
                                                              and ap.person_id = d.dependent_id
                                                              and d.person_id = mp.person_id
                                                              and ap.person_id = %PERSON_ID",,Pension
530,Month/Year of Last Payment,MONTH_YEAR_LAST_PAYMENT,"select to_char(add_months(trunc(sysdate),1),'fmMonth YYYY') OLD,
                                     to_char(add_months(trunc(sysdate),1),'fmMonth YYYY')||'.' NEW from dual",,Pension
531,AP Name - QDRO type,AP_NAME_QDRO,"select TRIM(NVL2(ap.prefix,
                 upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                                 ap.prefix,
                                                                 'Y',
                                                                 'N')) || ' ',
                 '') || upper(ap.first_name) || ' ' ||
            NVL2(ap.middle_name, upper(ap.middle_name) || ' ', '') ||
            upper(ap.last_name) || ' ' ||
            upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                            ap.suffix,
                                                            'Y',
                                                            'N')))
       
       ap_full_name
  from dbo.pension_application pa,
       dbo.pension_option      po,
       dbo.pension_type        pt,
       dbo.business_entity_key bek,
       dbo.person              ap
 where pa./*parent_*/application_id = %PENSION_APPLICATION_ID-----NG
   and pa.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPQDRO'
   and bek.business_entity_key_id = pa.owner_business_entity_key_id
   and bek.key_value = ap.person_id",,Pension
533,Pay By Date,PAY_BY_DATE,select CLIENT.f_get_rfd_amount(%PENSION_APPLICATION_ID) from dual,,Pension
534,AMDB Pension FME Month,AMDB_PENSION_FME_MONTH,"SELECT (CASE
         WHEN SYSDATE > to_date(f.rate_value_01, 'MM/dd/yyyy') THEN
          (SELECT TRIM(to_char(to_date(f.rate_value_01, 'MM/dd/yyyy'),
                               'Month'))
             FROM dbo.factor f
            WHERE f.factor_id =
                  web.pkg_util.f_get_factor_id('MONTHLY_PAYROLL_DATE')
              AND f.lookup_value_01 =
                  (TRIM(to_char(add_months(SYSDATE, 1), 'Month')) || ' ' ||
                  TRIM(to_char(SYSDATE, 'yyyy'))))
         ELSE
          TRIM(to_char(SYSDATE, 'Month'))
       END) fme_month
  FROM dbo.factor f
 WHERE f.factor_id = web.pkg_util.f_get_factor_id('MONTHLY_PAYROLL_DATE')
   AND f.lookup_value_01 = (TRIM(to_char(SYSDATE, 'Month')) || ' ' ||
       TRIM(to_char(SYSDATE, 'yyyy')))",,Pension
61,Employer Information,EMPLOYER_INFORMATION,"select e.sort_name as empSortName, e.employer_code as empCode, e.employer_name as empName 
                                                   from dbo.member_contract mc, dbo.employer e where mc.member_contract_id = 
                                                   client.f_get_current_member_contract(%MEMBER_ID,NVL(%AS_OF_DATE,SYSDATE)) and e.employer_id = mc.employer_id",,Employer
99,Member Alt ID,MEMBER_ALT_ID,"select trim(replace(alt_identifier, '-')) alt_id
                                                      From dbo.v_member_q
                                                      where member_id =%MEMBER_ID                                                       
                                                    ",,Member
95,Dependent Cnt,DEPENDENT_CNT,"   select count(*) AS CNT from DBO.dependent where dependent_id = nvl( %DEPENDENT_ID,-1)                                                    
                                                    ",,Member
96,Beneficiary Cnt,BENEFICIARY_CNT,"select count(*) cnt 
                                                     from dbo.beneficiary
                                                     where beneficiary_id = nvl( %DEPENDENT_ID,-1)                                                    
                                                    ",,Member
144,Reporting Official Name By Stop Date,RO_NAME_BY_STOPDATE,"select initcap(translate(vopq.other_party_name, ',', ' '))
                                                             from dbo.V_OI_PARTY_Q vopq
                                                             where vopq.key_value in
                                                             (select bek.key_value
                                                              from dbo.business_entity_key bek
                                                              where bek.business_entity_key_id in
                                                              (select ber.business_entity_key_id
                                                               from dbo.business_entity_relation ber
                                                               where ber.key_value =
                                                                   (select mc1.employer_id
                                                                    from dbo.member_contract mc1
                                                                    where mc1.stop_date in
                                                                    (select max(mc.stop_date)
                                                                     from dbo.member_contract mc
                                                                     where mc.member_id = %MEMBER_ID)
                                                                     and mc1.member_id = %MEMBER_ID)
                                                                 and ber.relation_role = 'RO'))",,Employer
266,Member Pension,MEMBER_PENSION,"select reemp_age_limit.age Age_Limit, reemp_earning_limit.earning Earnings_Limit, trim(TO_CHAR(ADD_MONTHS(sysdate, -1), 'Month')) ||', '|| TO_CHAR(ADD_MONTHS(sysdate, -6),'YYYY') earning_limit_reach_date
													from 
													(
													    select max(f.rate_value_01) age 
													    from dbo.factor_definition fd, dbo.factor f
													    where
													    f.lookup_value_02 is null
													    and f.factor_id = fd.factor_id
													    and fd.factor_name like 'RE_EMPLOYED_AGE_EXCEPTION_FACTOR_TABLE'
													) reemp_age_limit,
													(
													    select trim(to_char(to_number(max(f.rate_value_01)), '999,999.99')) earning
													    from dbo.factor_definition fd, dbo.factor f
													    where
													    f.lookup_value_02 is null
													    and f.factor_id = fd.factor_id
													    and fd.factor_name like 'RE_EMPLOYED_EARNINGS_LIMIT_FACTOR_TABLE'
													) reemp_earning_limit",,Member
541,Static Bookmarks 1,STATIC_BOOKMARKS_1,"Select trim('$30,000.00') as EARNING_LIMIT,
                                                      trim('Fifty cents') as REDUCTION_WORDS,
                                                      trim('David Martin') as IPERS_CBO,
                                                      '$'||trim('0.50') as REDUCTION_NUMBER
                                                      from dual",,Member
128,Beneficiary Statement List,BENEFICIARY_STMT_LIST,"select bp.last_name || case
         when bp.first_name is not null THEN
          ', ' || bp.First_name
       end beneficiary_name,
       bt.beneficiary_type_code,
       to_char(be.start_date,'mm/dd/rrrr') start_date,
       dbo.pkg_benefit_s.f_get_value_description('RELATION',
                                                 lb.relation,
                                                 lb.relation,
                                                 'N') relation
  from web.v_linked_beneficiaries lb,
       dbo.beneficiary            be,
       dbo.beneficiary_type       bt,
       dbo.person                 bp,
       DBO.Member                 m
 where lb.alt_beneficiary_id = be.alt_beneficiary_id
   and be.beneficiary_type_id = bt.beneficiary_type_id
   and (be.stop_date is null or be.stop_date > sysdate)
   and be.start_date <= sysdate
   and be.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
   and lb.dependent_id = bp.person_id
   and m.person_id = be.person_id
   and m.member_id=%MEMBER_ID
   order by bt.beneficiary_type_code, bp.last_name, bp.first_name",,Member
130,Previous Year,PREVIOUS_YEAR,"select  TO_CHAR(TRUNC(sysdate,'YYYY')-1,'YYYY') as Previous_Year
                                   from dual",,Employer
131,Employer Contact List,EMPLOYER_CONTACT_LIST,"select p.first_name,
          p.last_name,
          Dbo.pkg_benefit_s.f_get_value_description('RELATION_ROLE',
                                                    ber.relation_role,
                                                    ber.relation_role,
                                                    'N') Role,
          Dbo.pkg_benefit_s.f_get_value_description('TITLE',
                                                    p.title,
                                                    p.title,
                                                    'N') Title,
          ad.address_1,
          ad.address_2,
          ad.address_3,
          ad.city,
          st.state_name,
          substr(lpad(nvl(zip, 0), 9, '0'), 1, 5) || '-' ||
          substr(lpad(nvl(zip, 0), 9, '0'), 6, 4) zip,
          ad.char_phone_2 work_phone,
          ad.char_phone_4 fax_no,
          ad.e_mail
     from dbo.business_entity_key      bek,
          dbo.oi_person                op,
          dbo.person                   p,
          dbo.business_entity_relation ber,
          dbo.addresses                ad,
          dbo.state                    st
    where bek.business_entity_key_id = ber.business_entity_key_id
      and ad.entity_id = dbo.pkg_benefit_s.f_get_entity_id('OI_PERSON')
      and ad.address_type = 'C' 
      and (ad.stop_date is null or ad.stop_date > sysdate)
      and bek.key_value = ad.key_value
      and bek.key_value = op.oi_person_id
      and op.person_id = p.person_id
      and st.state_code = ad.state
      and ber.key_value = %EMPLOYER_ID",,Employer
57,Member Info,MEMBER_INFO,"select dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') ||' '|| (P.FIRST_NAME) ||' '|| (p.middle_name) ||' '|| 
                                   (p.last_name) ||' '|| dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N') as memberName,dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') as prefix, (p.first_name) 
                                   as firstName, (p.middle_name) as middleName, (p.last_name) as lastName, dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N') as suffix, 
                                   p.birth_date as birthDate, p.sex as sex, p.alt_identifier as altId,'*'||substr(p.alt_identifier,1,4)||substr(p.alt_identifier,6,4) as altidnodash, p.status as status, p.ssn as ssn
                                   from dbo.member m, dbo.person p 
                                   where m.member_id = %MEMBER_ID and p.person_id = m.person_id",,Member
159,User Title Info,USER_TITLE, select client.f_get_security_role(%SECURITY_USERS_ID) from dual,,Employer
105,Reporting Official Name Upper,REP_OFF_NAME_UPPER,"select trim(dbo.pkg_benefit_s.f_get_value_description('PREFIX',UPPER(P.PREFIX),'Y','N') ||' '|| upper(P.FIRST_NAME) ||' '|| upper(p.middle_name) ||' '|| 

                                   upper(p.last_name) ||' '|| dbo.pkg_benefit_s.f_get_value_description('SUFFIX',upper(P.SUFFIX),'Y','N')) as OfficialName,dbo.pkg_benefit_s.f_get_value_description('PREFIX',upper(P.PREFIX),'Y','N') as prefix, upper(p.first_name) 

                                   as firstName, upper(p.middle_name) as middleName, upper(p.last_name) as lastName, dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N') as suffix, 

                                   p.birth_date as birthDate, upper(p.sex) as sex, p.alt_identifier as altId, upper(p.status) as status, p.ssn as ssn

                                   from dbo.person p 

where

p.person_id in (select oi.person_id from dbo.oi_person oi where oi.oi_person_id in 

(select bek.key_value from dbo.business_entity_key bek where bek.business_entity_key_id in (

select ber.business_entity_key_id from dbo.business_entity_relation ber where ber.key_value=%EMPLOYER_ID

and ber.relation_role='RO')))",,Employer
528,AP Dates Info,AP_DATES_INFO,"select trim(Initcap(to_char((Select to_date(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                                  'PN_FME'),
                                           'MM/dd/yyyy')
                              from dual),
                            'Month'))) as FME_DATE,
       (select pp.date_04
          from dbo.PENSION_PREAPP pp
         where pp.pension_application_id = %PENSION_APPLICATION_ID) as RECEIVED_DATE,

         trim(to_char(to_date(client.f_get_pfv_value((select pa.parent_application_id
                                                     from dbo.pension_application pa
                                                    where pa.application_id =
                                                          %PENSION_APPLICATION_ID), 'PN_FME'),
                            'mm/dd/yyyy'),
                    'Month')) || ' ' ||
       trim(to_char(to_date(client.f_get_pfv_value((select pa.parent_application_id
                                                     from dbo.pension_application pa
                                                    where pa.application_id =
                                                          %PENSION_APPLICATION_ID), 'PN_FME'),
                            'mm/dd/yyyy'),
                    'YYYY'))||'.' FME_DATE_NEW
  from dual",,Pension
553,Beneficiary Summary Months New,BEN_SUMMARY_MONTHS_NEW,"Select Amount_01||' Payment' as Current_Month,
       Amount_02 as Next_Month
       from table(client.f_get_ben_summary_months(%PENSION_APPLICATION_ID))",,Pension
106,Reporting Officer Address Upper,REPORTING_OFFICER_ADDRESS_UPPER,"select upper(address_1) as address_line_1, upper(nvl(address_2,'')) as address_line_2, 
                                                   upper(nvl(address_3,'')) as address_line_3,
                                                   upper(city) as city, upper(state) as state,
                  upper(county) as county,
                  dbo.pkg_benefit_s.f_build_zipcode(zip) as zip_code,
    upper(city) ||', '||upper(state) ||' '||
    DECODE(country,'US',
                    substr(to_char(nvl(zip,0),'000000000'),1,6)||
                    decode(substr(to_char(nvl(zip,0),'000000000'),7,4),'0000','','-'||
                    substr(to_char(nvl(zip,0),'000000000'),7,4)),
                    postal_code -- if not US
        )
    ||chr(10)||
    decode(country,'US','',country)
    as Reporting_Person_City_State, 
          char_phone_2 work_phone,
       Char_Phone_4 fax_phone,
       e_Mail
    from dbo.addresses
    where entity_id = dbo.pkg_benefit_s.f_get_entity_id('OI_PERSON')
                                                             and (stop_date is null or stop_date > sysdate)
                                                             and key_value in
                                                             (SELECT bek.key_value
                                                             FROM dbo.business_entity_key bek
                                                             WHERE 1 = 1
                                                             and bek.business_entity_key_id IN
                                                            (SELECT max(ber.business_entity_key_id)
                                                             FROM dbo.business_entity_relation ber
                                                             WHERE ber.key_value = %EMPLOYER_ID
                                                             AND ber.entity_id =dbo.pkg_benefit_s.f_get_entity_id('EMPLOYER')
                                                             and ber.relation_role = 'RO'))",,Employer
107,Employer Address upper,EMPLOYER_ADDRESS_UPPER,"select upper(ad.address_1) as ad1, 
upper(ad.address_2) as ad2, 
upper(ad.address_3) as ad3, 
upper(ad.city) as c , 
upper(ad.state) as s, 
ad.zip as z ,
substr(to_char(nvl(ad.zip,0),'000000000'),1,6)||
decode(substr(to_char(nvl(ad.zip,0),'000000000'),7,4),'0000','','-'||
substr(to_char(nvl(ad.zip,0),'000000000'),7,4)) as ZIP                  
from  dbo.addresses ad, dbo.employer e 
where e.employer_id = %EMPLOYER_ID and 
ad.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('EMPLOYER'), e.employer_id,null,'C,R')",,Employer
108,Employer Contact Info,EMPLOYER_CONTACT_INFO,"select ltrim(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                 P.PREFIX,
                                                 'Y',
                                                 'N') || ' ' ||
       (P.FIRST_NAME) || ' ' || (p.middle_name) || ' ' || (p.last_name) || ' ' ||
       dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                 P.SUFFIX,
                                                 'Y',
                                                 'N')) as contact_name, 
        p.last_name  as contact_last_name,
        p.first_name as contact_first_name,
        upper(a.address_1),
        upper(a.address_2),
        upper(a.address_3),
        upper(a.city),
        upper(a.state),
        dbo.pkg_benefit_s.f_build_zipcode(zip) as zip,
        e.employer_code as emp_id,
        e.employer_name as employer_name
  from dbo.business_entity_relation ber,
       dbo.business_entity_key bek,
       dbo.oi_person oip,
       dbo.person p,
       dbo.addresses a,
       dbo.employer e
 where ber.entity_id = dbo.pkg_benefit_s.f_get_entity_id('EMPLOYER')
   and ber.key_value = e.employer_id
   and e.employer_id = %EMPLOYER_ID   
   and ber.relation_role = 'RO'
   and ber.business_entity_key_id = bek.business_entity_key_id
   and bek.key_value = oip.oi_person_id 
   and oip.person_id = p.person_id
   and a.entity_id(+) =  dbo.pkg_benefit_s.f_get_entity_id('OI_PERSON') 
   and a.key_value(+) = oip.oi_person_id
   and a.start_date(+) <= trunc(sysdate) 
   and nvl(a.stop_date, trunc(sysdate)) >= trunc(sysdate) 
   and a.address_period(+) = 'P'",,Employer
138,Eft Info,EFT_INFO,"select nvl(efd.bank_account_type, '') as bank_account_type, nvl(efd.bank_name, '') as bank_name, 
       nvl(efd.bank_routing_number, '') as bank_routing_number, nvl(efd.bank_account_number, '') as bank_account_number,
       (lpad(substr(nvl(efd.bank_account_number, ''), length(nvl(efd.bank_account_number, '')) - 3),length(nvl(efd.bank_account_number, '')),'X')) as masked_bank_account_number,
       nvl(bat.description, '') as bank_account_type_name, nvl(efd.person_accepted, '') as person_accepted, 
       nvl(efd.person_accepted_title, '') as person_accepted_title
from dbo.eft_definition efd left outer join
     (select av.description, av.internal_value
      from dbo.v_entity_attribute ea inner join
           dbo.attribute_value av on ea.attribute_id = av.attribute_id
      where ea.entity_name = 'EFT_DEFINITION' and ea.attribute_name = 'BANK_ACCOUNT_TYPE') bat on efd.bank_account_type = bat.internal_value
where efd.eft_definition_id = %EFT_DEFINITION_ID",,Employer
158,Employee Under 6 Month Instruction Letter Table,EMP_UNDER_SIX_MONTH_INSTR_LETTER_TABLE,"select distinct 'XXXXX'||substr(p.ssn,6,4) ssn,
                                                           UPPER(p.first_name||' '|| nvl(substr(p.middle_name,1,1),'')||' '||p.last_name) as sort_name,
                                                          mc.start_date,
                                                          mc.stop_date,
                                                          mc.start_date as cove_date,
                                                          mc.stop_date as term_date,
                                                          mc.employer_id,
                                                          months_between(mc.stop_date, mc.start_date)
                                                          from dbo.member_contract mc, dbo.member m, dbo.person p,dbo.audit_trail_history ath
                                                          where mc.member_id = m.member_id and
                                                          mc.member_contract_id = ath.key_value_1
                                                          and ath.entity_id =dbo.pkg_benefit_s.f_get_entity_id('MEMBER_CONTRACT')
                                                          and ath.attribute_id = dbo.pkg_benefit_s.f_get_attribute_id('STOP_DATE','DA')
                                                          and trunc(ath.inserted_date) between %START_DATE and %STOP_DATE
                                                          and m.person_id = p.person_id
                                                          and mc.job_category not in 
                                                          (SELECT lpad(f.lookup_value_01, 2, '0') 
                    FROM dbo.factor f
                   WHERE f.factor_id =  web.pkg_util.f_get_factor_id('OCC_CODE_SPECIAL_VALIDATION_LOGIC')
                     AND nvl(f.lookup_value_02, 'N') = 'Y') --sv3
                                                          and months_between(mc.stop_date, mc.start_date) <= 6
                                                          and mc.stop_date is not null
                                                          and mc.employer_id = %EMPLOYER_ID
                                                          AND (p.status != 'D' AND p.death_date IS NULL)
                   AND m.member_id NOT IN
                   (Select  mc1.member_id from dbo.member_contract mc1 
                           where mc1.member_id = m.member_id
                           and (mc1.stop_date is null or mc1.stop_date > trunc(sysdate)))
                   AND m.member_id IN --PI
                   (SELECT pa.member_id
                      FROM dbo.Part_Account pa
                     WHERE pa.member_id = m.member_id)        
                   AND m.member_id NOT IN 
                       (SELECT pa.member_id
                          FROM --dbo.part_acct_detail_value pav
                              dbo.part_account_detail    pd
                              ,dbo.part_account           pa
                         WHERE --pd.part_account_detail_id = pav.part_account_detail_id
                           pa.part_account_id = pd.part_account_id
                           and pd.employer_id = mc.employer_id
                           AND pa.member_id = m.member_id
                         GROUP BY pa.member_id
                        HAVING nvl(sum(pd.wages),0) = 0)--nvl(SUM(pav.amount_01), 0) + nvl(SUM(pav.amount_04), 0) = 0)",93,Employer
109,Merge Employer Info,MERGE_EMPLOYER_INFO,"select ds_merge.merge_effective_date as merge_effective_date,
           ds_merge.merge_process_date as merge_process_date,
           ds_merge.merged_from_empl_id as merge_from_empl_id,
           ds_merge.merged_to_empl_id as merge_to_empl_id,
           e.employer_name as merge_from_name,
           e2.employer_name as merge_to_name,
          to_char(last_day(ds_merge.merge_effective_date) + 1, 'MM/YYYY') as following_month
     from (select to_date( max(decode(a.attribute_name, 'DS_MERGE_EFFECTIVE_DATE', dv.value, null)),'MMDDYYYY') as merge_effective_date, 
                         to_date( max(decode(a.attribute_name, 'DS_MERGE_PROCESS_DATE', dv.value, null)),'MMDDYYYY') as merge_process_date, 
                         max(decode(a.attribute_name, 'DS_MERGED_FROM_EMPLOYER_ID', dv.value, null)) as merged_from_empl_id,  
                         max(decode(a.attribute_name, 'DS_MERGED_TO_EMPLOYER_ID', dv.value, null)) as merged_to_empl_id,  
                         dv.key_value,  
                         dv.seq_no 
                    from dbo.datasheet_value dv, 
                         dbo.attribute a, 
                         dbo.datasheet_attribute da, 
                         dbo.datasheet_value_instance dvi  
                  where  dv.attribute_id = a.attribute_id  
                    and  da.datasheet_id = dbo.pkg_benefit_ds.f_get_datasheet_id('DS_MERGE_EMPLOYER') 
                    and  da.attribute_id = dv.attribute_id  
                    and  dv.instance_id = dvi.instance_id(+)  
                    and  dv.key_value = %EMPLOYER_ID
                    and  dv.attribute_id in (dbo.pkg_benefit_s.f_get_attribute_id('DS_MERGE_EFFECTIVE_DATE'),
                     dbo.pkg_benefit_s.f_get_attribute_id('DS_MERGE_PROCESS_DATE'), 
                     dbo.pkg_benefit_s.f_get_attribute_id('DS_MERGED_FROM_EMPLOYER_ID'), 
                     dbo.pkg_benefit_s.f_get_attribute_id('DS_MERGED_TO_EMPLOYER_ID'))
                    group  by dv.key_value, dv.instance_id, dvi.description, dv.seq_no) ds_merge,
                    dbo.employer e,
                    dbo.employer e2
   where ds_merge.merged_from_empl_id = e.employer_code
     and ds_merge.merged_to_empl_id = e2.employer_code",,Employer
114,Member Address Grid 1,MEM_ADDR_GRID_1,"select client.f_member_address_grid(%MEMBER_ID,1)
                                                         from dual",,Member
115,Member Address Grid 2,MEM_ADDR_GRID_2,"select client.f_member_address_grid(%MEMBER_ID,2)
                                                         from dual",,Member
116,Member Address Grid 3,MEM_ADDR_GRID_3,"select client.f_member_address_grid(%MEMBER_ID,3)
                                                         from dual",,Member
117,Member Address Grid 4,MEM_ADDR_GRID_4,"select client.f_member_address_grid(%MEMBER_ID,4)
                                                         from dual",,Member
163,Member Job Category,MEMBER_JOB_CATEGORY,"select jc.job_category from dbo.job_category jc
where
jc.job_category=client.f_get_job_category(%MEMBER_ID)",,Member
164,Owner Name,OWNER_NAME,Select %OWNER_NAME from dual,,Employer
165,Member Custom Comments,MEMBER_CUSTOM_COMMENTS,"Select dv.custom_comments
  from dbo.datasheet_value dv
 where dv.datasheet_id =
       dbo.pkg_benefit_ds.f_get_datasheet_id('DS_OTHER_MEMBER_INFORMATION')
   and dv.attribute_id =
       dbo.pkg_benefit_s.f_get_attribute_id('DS_LEGACY_MEM_BEN_STMT')
   and dv.key_value = to_char(%MEMBER_ID)",,Member
137,Member Beneficiary Info Init,MEMBER_BENEFICIARY_INFO_INIT,"select ssn as ssn,
       fund as fund,
       name as name,
       beneficiary_type as beneficiary_type,
       percentage as percentage,
       relationship as relationship,
       trim(to_char(start_date, 'mm/dd/yyyy')) as start_date,
       trim(to_char(stop_date, 'mm/dd/yyyy')) as stop_date,
       trim(to_char(birth_date, 'mm/dd/yyyy')) as birth_date
  from (select dbo.pkg_benefit_s.f_build_ssn(p.ssn) as ssn,
               f.fund_name as fund,(select client.f_get_temp_ltr_bkmrk_ext(%MEMBER_ID,p.person_id,p.ssn,'BKMRK_NAME') from dual) as name,
               bt.beneficiary_type_code as beneficiary_type,
               b.percent as percentage,
               nvl((select vav.DESCRIPTION
                   from dbo.dependent d, dbo.v_attribute_value vav
                   where d.dependent_id = b.key_value
                    and d.person_id = m.person_id
                    and d.relation = vav.INTERNAL_VALUE
                    and vav.attribute_name = 'RELATION'
                        ),bek.key_role_indicator)as relationship,
               b.start_date,
               to_char(b.stop_date, 'mm/dd/yyyy') as stop_date,
               p.birth_date
          from dbo.beneficiary b,
               dbo.member m,
               dbo.person p,
               dbo.beneficiary_type  bt,
               dbo.fund f,
               dbo.business_entity_key bek
         where m.member_id=%MEMBER_ID
           and m.person_id=b.person_id
           and p.person_id=b.key_value
           and bek.key_value=b.key_value
           and b.entity_id=dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and b.beneficiary_type_id = bt.beneficiary_type_id
           and f.fund_id = b.fund_id
           and b.stop_date is null
        union
        select '000-00-0000' as ssn,
               f.fund_name as fund,
               (select client.f_get_temp_ltr_bkmrk(%MEMBER_ID,p.ssn,'BKMRK_NAME')from dual) as name,
               bt.beneficiary_type_code as beneficiary_type,
               b.percent as percentage,
               'Other Person, Beneficiary' as relationship,
               b.start_date,
               to_char(b.stop_date, 'mm/dd/yyyy') as stop_date,
               p.birth_date
          from dbo.beneficiary b,
               dbo.member m,
               dbo.person p,
               dbo.beneficiary_type bt,
               dbo.fund f,
               dbo.oi_person op
         where m.member_id = %MEMBER_ID
           and m.person_id = b.person_id
           and p.person_id = op.person_id
           and b.beneficiary_type_id = bt.beneficiary_type_id
           and b.entity_id = dbo.pkg_benefit_s.f_get_entity_id('OI_PERSON')
           and op.oi_person_id = b.key_value
           and f.fund_id = b.fund_id
           and b.stop_date is null
        union
        select '000-00-0000' as ssn,
               f.fund_name as fund,
               initcap(oo.oi_name) as name,
               bt.beneficiary_type_code as beneficiary_type,
               b.percent as percentage,
               'Other Organization, Beneficiary' as relationship,
               b.start_date,
               to_char(b.stop_date, 'mm/dd/yyyy') as stop_date,
               null birth_date
          from dbo.beneficiary b,
               dbo.member m,
               dbo.beneficiary_type bt,
               dbo.fund f,
               dbo.oi_organization oo
         where m.member_id = %MEMBER_ID
           and m.person_id = b.person_id
           and b.beneficiary_type_id = bt.beneficiary_type_id
           and b.entity_id = dbo.pkg_benefit_s.f_get_entity_id('OI_ORGANIZATION')
           and oo.oi_organization_id = b.key_value
           and f.fund_id = b.fund_id
           and b.stop_date is null) y
 where trunc(y.start_date) > (select to_date(client.f_get_temp_ltr_bkmrk(%MEMBER_ID,null,'BKMRK_SIGN_DATE'),'mm/dd/yyyy')from dual)
 order by beneficiary_type, percentage",,Member
660,Reporting Official Full Name,REPORTING_OFFICIAL_NAME,"select p.sort_name
from dbo.person p 
where
p.person_id in 
(select oi.person_id from dbo.oi_person oi where oi.oi_person_id in 
(select bek.key_value from dbo.business_entity_key bek where bek.business_entity_key_id in (
select ber.business_entity_key_id from dbo.business_entity_relation ber where ber.key_value=%EMPLOYER_ID
and ber.relation_role='RO')))",,Employer
88,Member Info Upper,MEMBER_INFO_UPPER,"select trim(decode(PREFIX,
                   null,
                   null,
                   upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                                   P.PREFIX,
                                                                   'Y',
                                                                   'N')) || ' ') ||
            upper(P.FIRST_NAME) || ' ' || upper(p.middle_name) || ' ' ||
            upper(p.last_name) || ' ' ||
            upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                            P.SUFFIX,
                                                            'Y',
                                                            'N'))) as memberName,
       upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                       P.PREFIX,
                                                       'Y',
                                                       'N')) as prefix,
       TRIM(upper(p.first_name)) as firstName,
       upper(p.middle_name) as middleName,
       TRIM(upper(p.last_name)) as lastName,
       upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                       P.SUFFIX,
                                                       'Y',
                                                       'N')) as suffix,
       p.birth_date as birthDate,
       upper(p.sex) as sex,
       p.alt_identifier as altId,
       upper(p.status) as status,
       p.ssn as ssn
  from dbo.person p
 where p.person_id = case when %PERSON_ID is not null then %PERSON_ID
  else (select vmq.person_id from dbo.v_member_q vmq where vmq.member_id = %MEMBER_ID) end",,Member
227,Representative Payee Address,REPRESENTATIVE_PAYEE_ADDRESS,"select decode(a.address, null, '', a.address|| chr(10)) ||a.city || ' ' || a.state || ' ' ||(a.zip) as address from (
                                     select max(decode(a.attribute_name, 'DS_MC_ADDRESS', dv.value)) as address,
       max(decode(a.attribute_name, 'DS_MC_CITY', dv.value)) as city,
       max(decode(a.attribute_name, 'DS_MC_STATE', dv.value)) as state,
       max(decode(a.attribute_name, 'DS_MC_ZIP', dv.value)) as zip
  from dbo.datasheet_value dv
 inner join dbo.attribute a on dv.attribute_id = a.attribute_id
 where dv.datasheet_id =
       dbo.pkg_benefit_ds.f_get_datasheet_id('DS_MEMBER_CONTACTS')
   and dv.owner_id = dbo.pkg_benefit_ds.f_get_owner_id('MEMBER')
   and dv.key_value = to_char(%MEMBER_ID)
   and dv.seq_no =
       (select max(dv.seq_no)
          from dbo.datasheet_value dv
         where dv.key_value = to_char(%MEMBER_ID)
           and dv.datasheet_id =
               dbo.pkg_benefit_ds.f_get_datasheet_id('DS_MEMBER_CONTACTS')
           and dv.owner_id = dbo.pkg_benefit_ds.f_get_owner_id('MEMBER') and dv.value='PR')) a",,Member
229,SSD First Request Date,SSD_FIRST_REQUEST_DATE,"select first_request_date
  from (select to_char(bhl.inserted_date, 'MM/DD/YYYY') as first_request_date,
               bhl.process_id
          from dbo.batch_header_log bhl, dbo.batch_definition bd
         where bd.batch_id = bhl.batch_id
           and bd.description like 'Special Service Disability Income Batch'
           and to_char(bhl.inserted_date, 'yyyy') = to_char(sysdate, 'yyyy')
         order by bhl.process_id asc)
 where rownum = 1",,Member
230,SSD Second Request Date,SSD_SECOND_REQUEST_DATE,"select second_requset_date
  from (select lead(request_date, 1, null) over(order by process_id asc) as second_requset_date
          from (select to_char(bhl.inserted_date, 'MM/DD/YYYY') as request_date,
                       bhl.process_id
                  from dbo.batch_header_log bhl, dbo.batch_definition bd
                 where bd.batch_id = bhl.batch_id
                   and bd.description like
                       'Special Service Disability Income Batch'
                   and to_char(bhl.inserted_date, 'yyyy') =
                       to_char(sysdate, 'yyyy')
                 order by bhl.process_id asc))
 where rownum = 1",,Member
231,AP_Complete_Name_Reminder,AP_COMPLETE_NAME_REM,"select ap_complete_name_reminder
  from (select nvl2(dp.first_name, upper(dp.first_name) || ' ', '') ||
               upper(dp.last_name) as ap_complete_name_reminder
          from dbo.court_order         co,
               dbo.person              p,
               dbo.business_entity_key bek,
               dbo.business_entity_key bekp,
               dbo.person              dp
         where co.payor_business_entity_key_id = %MEMBER_ID
           and bek.business_entity_key_id = co.payor_business_entity_key_id
           and p.person_id = bek.key_value
           and trunc(co.date_of_order) < trunc(sysdate - 30)
           and dp.person_id = bekp.key_value
           and co.date_04 is null
           and co.payee_business_entity_key_id = bekp.business_entity_key_id
         order by co.court_order_id desc)
 where rownum = 1",,Member
232,AP_Complete_Address_Reminder,AP_COMPLETE_ADDR_REMINDER,"select case
                 when a.country = 'US' then
                  TRIM(decode(a.address_3,
                              null,
                              '',
                              upper(a.address_3) || chr(10)) ||
                       decode(a.address_1, null, '', upper(a.address_1)) ||
                       decode(a.address_2,
                              null,
                              '',
                              chr(10) || upper(a.address_2)) || chr(10) ||
                       upper(a.city) || ' ' || upper(a.state) || ' ' ||
                       dbo.pkg_benefit_s.f_build_zipcode(a.zip))
                 else
                  TRIM(decode(a.address_3,
                              null,
                              '',
                              upper(a.address_3) || chr(10)) ||
                       decode(a.address_1, null, '', upper(a.address_1)) ||
                       decode(a.address_2,
                              null,
                              '',
                              chr(10) || upper(a.address_2)) || chr(10) ||
                       upper(a.city) ||
                       (select case
                                 when upper((Select upper(s.state_name)
                                              from dbo.state s, dbo.country c
                                             where s.country_id = c.country_id
                                               and c.country_code = a.country
                                               and s.state_code = a.state)) is not null then
                                  ', ' ||
                                  upper((Select upper(s.state_name)
                                          from dbo.state s, dbo.country c
                                         where s.country_id = c.country_id
                                           and c.country_code = a.country
                                           and s.state_code = a.state))
                                 else
                                  ''
                               end
                          from dual) || (select case
                                                  when a.postal_code is not null then
                                                   ', ' || a.postal_code
                                                  else
                                                   ''
                                                end
                                           from dual) || chr(10) ||
                       upper((Select upper(c.country_name)
                               from dbo.country c
                              where c.country_code = a.country)))
               end as ap_address_reminder
  from dbo.addresses a
 where a.key_value in
       (select key_value
          from (select bekp.key_value as key_value
                  from dbo.court_order         co,
                       dbo.person              p,
                       dbo.business_entity_key bek,
                       dbo.business_entity_key bekp
                 where co.payor_business_entity_key_id = %MEMBER_ID
                   and bek.business_entity_key_id =
                       co.payor_business_entity_key_id
                   and p.person_id = bek.key_value
                   and trunc(co.date_of_order) < trunc(sysdate - 30)
                   and co.date_04 is null
                   and co.payee_business_entity_key_id =
                       bekp.business_entity_key_id
                 order by co.court_order_id desc)
         where rownum = 1)
   and a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                   a.key_value,
                                                   null,
                                                   'C,R')",,Member
233,Last4_SSN,LAST4_SSN,"select substr(lpad(p.ssn,9,0),6) as Last4_SSN from dbo.v_member_q p where p.member_id = %MEMBER_ID ",,Member
234,Meeting_Date,MEETING_DATE,"select to_char(mt.start_date, 'MM/DD/YYYY') as start_date
  from workforce.meeting             mt,
       workforce.meeting_participant mp,
       workforce.conference_days     cd
 where mt.meeting_id = mp.meeting_id
   and mt.meeting_id = %MEETING_ID
   and mt.conference_days_id = cd.conference_days_id
   and mp.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
   and mp.key_value in (select p.person_id
                          from dbo.member m, dbo.person p
                         where m.person_id = p.person_id
                           and m.member_id = %MEMBER_ID)",,Member
235,Meeting_Time,MEETING_TIME,"select to_char(mt.start_date, 'HH:MM AM') as start_time
  from workforce.meeting             mt,
       workforce.meeting_participant mp,
       workforce.conference_days     cd
 where mt.meeting_id = mp.meeting_id
   and mt.meeting_id = %MEETING_ID
   and mt.conference_days_id = cd.conference_days_id
   and mp.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
   and mp.key_value in (select p.person_id
                          from dbo.member m, dbo.person p
                         where m.person_id = p.person_id
                           and m.member_id = %MEMBER_ID)",,Member
236,Refund Date Paid,REFUND_DATE_PAID,"select refund_paid_date
  from (select to_char(d.disbursement_date, 'mm/dd/yyyy') as refund_paid_date
          from dbo.disbursement d, dbo.benefit_account ba, dbo.v_member_q q
         where ba.benefit_type = 'RF'
           and d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = q.person_id
           and ba.benefit_account_id = d.benefit_account_id
           and q.member_id =%MEMBER_ID
         order by d.disbursement_id desc)
 where rownum = 1",,Member
237,Payee_First_Name_Last_Name,PAYEE_FIRST_LAST_NAME,"select payee_first_last_name
  from (select nvl2(p.first_name, upper(p.first_name) || ' ', '') ||
               upper(p.last_name) as payee_first_last_name
          from dbo.person p, dbo.disbursement d, dbo.member m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = p.person_id
           and m.person_id = p.person_id
           and m.member_id = %MEMBER_ID
         order by d.disbursement_id desc)
 where rownum = 1",,Member
239,Outdated_Warrant_Issue_Date2,OUTDATED_WARRENT_ISSUE_DATE2,"select to_char(warrent, 'mm/dd/yyyy') as Outdated_Warrant_Issue_Date2
  from (select lead(d.disbursement_date, 1, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 1, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 1, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
240,Outdated_Warrant_Number2,OUTDATED_WARRENT_NUMBER2,"select check_no as Outdated_Warrant_Number2
  from (select lead(d.disbursement_date, 1, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 1, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 1, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
241,Outdated_Warrant_Amt2,OUTDATED_WARRENT_AMOUNT2,"select trim(to_char(amount, '999,999,990.00')) as Outdated_Warrant_Amt2
  from (select lead(d.disbursement_date, 1, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 1, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 1, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
242,Outdated_Warrant_Issue_Date3,OUTDATED_WARRENT_ISSUE_DATE3,"select to_char(warrent, 'mm/dd/yyyy') as Outdated_Warrant_Issue_Date3
  from (select lead(d.disbursement_date, 2, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 2, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 2, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
243,Outdated_Warrant_Number3,OUTDATED_WARRENT_NUMBER3,"select check_no as Outdated_Warrant_Number3
  from (select lead(d.disbursement_date, 2, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 2, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 2, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
244,Outdated_Warrant_Amt3,OUTDATED_WARRENT_AMOUNT3,"select trim(to_char(amount, '999,999,990.00')) as Outdated_Warrant_Amt3
  from (select lead(d.disbursement_date, 2, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 2, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 2, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
245,Outdated_Warrant_Issue_Date4,OUTDATED_WARRENT_ISSUE_DATE4,"select to_char(warrent, 'mm/dd/yyyy') as Outdated_Warrant_Issue_Date4
  from (select lead(d.disbursement_date, 3, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 3, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 3, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
246,Outdated_Warrant_Number4,OUTDATED_WARRENT_NUMBER4,"select check_no as Outdated_Warrant_Number4
  from (select lead(d.disbursement_date, 3, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 3, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 3, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
247,Outdated_Warrant_Amt4,OUTDATED_WARRENT_AMOUNT4,"select trim(to_char(amount, '999,999,990.00')) as Outdated_Warrant_Amt4
  from (select lead(d.disbursement_date, 3, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 3, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 3, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
248,Outdated_Warrant_Issue_Date5,OUTDATED_WARRENT_ISSUE_DATE5,"select to_char(warrent, 'mm/dd/yyyy') as Outdated_Warrant_Issue_Date5
  from (select lead(d.disbursement_date, 4, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 4, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 4, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
481,Preliminary Letter Dates Info,PENSION_DATES_INFO,"select 
                                                      trim(Initcap(to_char((Select to_date(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FME'),'MM/dd/yyyy') from dual),'Month'))) as FME_DATE,
                                                      (select last_date as Last_Service_date
                                                      from (Select pads.period_to_date as last_date
                                                      from dbo.part_acct_detail_summary pads,
                                                      dbo.part_account             pa,
                                                      dbo.part_acct_dtl_type_cat   padtc
                                                      where pads.part_account_id = pa.part_account_id
                                                      and pads.part_acct_dtl_type_cat_id =
                                                      padtc.part_acct_dtl_type_cat_id
                                                      and padtc.internal_name = 'CT'
                                                      and pa.member_id = %MEMBER_ID
                                                      order by pads.period_to_date desc)
                                                      where rownum = 1) as ENDING_DATE,
                                                      (select to_char(trunc(add_months(vmq.birth_date, 744),'mm'), 'mm/dd/yyyy')
                                                      from dbo.v_member_q vmq
                                                      where vmq.member_id = %MEMBER_ID) as Age62,
                                                     (Select to_char(add_months(to_date(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FME'),'MM/dd/yyyy'),119),'mm/dd/yyyy') from dual) as BEN_EXP_YEAR,
                                                      add_months(to_date(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FME'),'MM/dd/yyyy'),1) as COVERED_ONE_MONTH,
                                                      add_months(to_date(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FME'),'MM/dd/yyyy'),4) as COVERED_FOUR_MONTH,
                                                      (select pp.date_04 from dbo.PENSION_PREAPP pp where pp.pension_application_id = %PENSION_APPLICATION_ID) as RECEIVED_DATE,
                                                      (Select to_date(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FME'),'MM/dd/yyyy') from dual) as MONTH_YEAR,
                                                      (select to_char(trunc(add_months(vmq.birth_date, 744),'mm'), 'mm/dd/yyyy')||'.'
                                                      from dbo.v_member_q vmq
                                                      where vmq.member_id = %MEMBER_ID) as Age62_1,
                                                      (select pp.date_04||'.' from dbo.PENSION_PREAPP pp where pp.pension_application_id = %PENSION_APPLICATION_ID) as RECEIVED_DATE_1
                                                      from dual",,Pension
482,Pension Option Details,PENSION_OPTION_BM,"Select pot.Pension_option_type_code as OPTION_CODE,
                                                      pot.Pension_option_type_desc as OPTION_NAME
                                                      from dbo.pension_option      po,
                                                      dbo.pension_application pa,
                                                      dbo.pension_option_type pot
                                                      where pa.application_id = %PENSION_APPLICATION_ID
                                                      and pa.pension_option_id = po.pension_option_id
                                                      and po.pension_option_type_id = pot.pension_option_type_id",,Pension
483,Primary Beneficiary List,PRIMARY_BEN_LIST,"select UPPER(x.name),'Date of birth: '||to_char(x.birth_date,'mm/dd/yyyy') from dbo.beneficiary_type bt,
(select b.beneficiary_type_id, 
       nvl2(p.first_name, initcap(p.first_name) || ' ', '') ||
       nvl2(p.middle_name, initcap(p.middle_name) || ' ', '') ||
       nvl2(p.last_name, initcap(p.last_name), '') as name,
       p.birth_date
  from dbo.beneficiary       b,
       dbo.member            m,
       dbo.person            p,
       dbo.beneficiary_type  bt
 where m.member_id = %MEMBER_ID
   and m.person_id = b.person_id
   and b.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
   and b.key_value = p.person_id
   and b.beneficiary_type_id = bt.beneficiary_type_id
   and b.stop_date is null
union
select b.beneficiary_type_id, 
       nvl2(p.first_name, initcap(p.first_name) || ' ', '') ||
       nvl2(p.middle_name, initcap(p.middle_name) || ' ', '') ||
       nvl2(p.last_name, initcap(p.last_name), '') as name,
       p.birth_date
  from dbo.beneficiary       b,
       dbo.member            m,
       dbo.person            p,
       dbo.beneficiary_type  bt,
       dbo.oi_person op
 where m.member_id = %MEMBER_ID
   and m.person_id = b.person_id
   and p.person_id = op.person_id
   and b.beneficiary_type_id = bt.beneficiary_type_id
   and b.entity_id = dbo.pkg_benefit_s.f_get_entity_id('OI_PERSON')
   and op.oi_person_id = b.key_value
   and b.stop_date is null
union
select b.beneficiary_type_id, 
       initcap(oo.oi_name) as name,
       null birth_date
  from dbo.beneficiary       b,
       dbo.member            m,
       dbo.beneficiary_type  bt,
       dbo.oi_organization oo
 where m.member_id = %MEMBER_ID
   and m.person_id = b.person_id
   and b.beneficiary_type_id = bt.beneficiary_type_id
   and b.entity_id = dbo.pkg_benefit_s.f_get_entity_id('OI_ORGANIZATION')
   and oo.oi_organization_id = b.key_value
   and b.stop_date is null) x
   where 
   bt.beneficiary_type_id=x.beneficiary_type_id and
   bt.beneficiary_type_code = 'Primary'",,Pension
201,Conference Date,CONFERENCE_DATE,"select decode(trunc(c.start_date), trunc(c.stop_date),
                                     to_char(c.start_date,'MM/dd/yyyy'),
                                     to_char(c.start_date,'MM/dd/yyyy') || ' - ' || to_char(c.stop_date,'MM/dd/yyyy')) as conference_date
                                     from workforce.meeting mt, workforce.meeting_participant mp, workforce.conference_days cd,workforce.conference c
                                     where mt.meeting_id = mp.meeting_id and
                                     mt.meeting_id = %MEETING_ID and
                                     mt.conference_days_id = cd.conference_days_id 
                                     and cd.conference_id = c.conference_id
                                     and mp.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON') and
                                     mp.key_value in (select p.person_id from dbo.member m, dbo.person p
                                     where m.person_id = p.person_id and m.member_id = %MEMBER_ID)",,Member
202,Facility Name,FACILITY_NAME,"select upper(oio.oi_name)  as org_name from 
                                     dbo.oi_organization oio, workforce.conference con, 
                                     workforce.conference_days cd, workforce.meeting mt, workforce.meeting_participant mp
                                     where
                                     oio.organization_id = con.location_id and
                                     con.conference_id = cd.conference_id and
                                     cd.conference_days_id = mt.conference_days_id and
                                     mt.meeting_id = mp.meeting_id and
                                     mt.meeting_id = %MEETING_ID and
                                     mp.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON') and
                                     mp.key_value in (select p.person_id from dbo.member m, dbo.person p
                                     where m.person_id = p.person_id and m.member_id = %MEMBER_ID)",,Member
203,Facility Address,FACILITY_ADDRESS,"select decode(ad.address_1, null, '', ad.address_1) ||
                                     decode(ad.address_2,null,'',chr(10)||ad.address_2) ||
                                     decode(ad.address_3,null,'',chr(10)||ad.address_3)  ||
                                     chr(10) || ad.city ||', '||ad.state ||''||
                                     DECODE(ad.country,'US',
                                      substr(to_char(nvl(ad.zip,0),'000000000'),1,6)||
                                       decode(substr(to_char(nvl(ad.zip,0),'000000000'),7,4),'0000','','-'||
                                        substr(to_char(nvl(ad.zip,0),'000000000'),7,4)),
                                         ad.postal_code -- if not US
                                         )
                                         ||chr(10)||
                                         decode(ad.country,'US','',ad.country) as org_address
                                         from dbo.addresses ad where
                                         ad.start_date <= sysdate and
                                         nvl(ad.stop_date, to_date('01014000','MMddyyyy')) >= sysdate and
                                         ad.entity_id = dbo.pkg_benefit_s.f_get_entity_id('OI_ORGANIZATION')
                                         and ad.key_value in
                                         (select oio.oi_organization_id from 
                                         dbo.oi_organization oio, workforce.conference con, 
                                         workforce.conference_days cd, workforce.meeting mt, workforce.meeting_participant mp
                                         where
                                         oio.organization_id = con.location_id and
                                         con.conference_id = cd.conference_id and
                                         cd.conference_days_id = mt.conference_days_id and
                                         mt.meeting_id = mp.meeting_id and
                                         mt.meeting_id = %MEETING_ID and
                                         mp.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON') and
                                         mp.key_value in (select p.person_id from dbo.member m, dbo.person p
                                         where m.person_id = p.person_id and m.member_id = %MEMBER_ID))",,Member
484,Secondary Beneficiary List,SECONDARY_BEN_LIST,"select UPPER(x.name),'Date of birth: '||to_char(x.birth_date,'mm/dd/yyyy') from dbo.beneficiary_type bt,
(select b.beneficiary_type_id, 
       nvl2(p.first_name, initcap(p.first_name) || ' ', '') ||
       nvl2(p.middle_name, initcap(p.middle_name) || ' ', '') ||
       nvl2(p.last_name, initcap(p.last_name), '') as name,
       p.birth_date
  from dbo.beneficiary       b,
       dbo.member            m,
       dbo.person            p,
       dbo.beneficiary_type  bt
 where m.member_id = %MEMBER_ID
   and m.person_id = b.person_id
   and b.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
   and b.key_value = p.person_id
   and b.beneficiary_type_id = bt.beneficiary_type_id
   and b.stop_date is null
union
select b.beneficiary_type_id, 
       nvl2(p.first_name, initcap(p.first_name) || ' ', '') ||
       nvl2(p.middle_name, initcap(p.middle_name) || ' ', '') ||
       nvl2(p.last_name, initcap(p.last_name), '') as name,
       p.birth_date
  from dbo.beneficiary       b,
       dbo.member            m,
       dbo.person            p,
       dbo.beneficiary_type  bt,
       dbo.oi_person op
 where m.member_id = %MEMBER_ID
   and m.person_id = b.person_id
   and p.person_id = op.person_id
   and b.beneficiary_type_id = bt.beneficiary_type_id
   and b.entity_id = dbo.pkg_benefit_s.f_get_entity_id('OI_PERSON')
   and op.oi_person_id = b.key_value
   and b.stop_date is null
union
select b.beneficiary_type_id, 
       initcap(oo.oi_name) as name,
       null birth_date
  from dbo.beneficiary       b,
       dbo.member            m,
       dbo.beneficiary_type  bt,
       dbo.oi_organization oo
 where m.member_id = %MEMBER_ID
   and m.person_id = b.person_id
   and b.beneficiary_type_id = bt.beneficiary_type_id
   and b.entity_id = dbo.pkg_benefit_s.f_get_entity_id('OI_ORGANIZATION')
   and oo.oi_organization_id = b.key_value
   and b.stop_date is null) x
   where 
   bt.beneficiary_type_id=x.beneficiary_type_id and
   bt.beneficiary_type_code = 'Secondary'",,Pension
485,Static Bookmarks,STATIC_BOOKMARKS,"Select trim('$30,000.00') as EARNING_LIMIT,
                                                      trim('Fifty cents') as REDUCTION_WORDS,
                                                      trim('David Martin') as IPERS_CBO,
                                                      trim('0.50') as REDUCTION_NUMBER
                                                      from dual",,Pension
205,Conference Start Year,CONFERENCE_START_YEAR,"select trim(to_char(c.start_date, 'YYYY')) from workforce.conference c where c.conference_id = %CONFERENCE_ID",123,Employer
206,Conference End Year,CONFERENCE_END_YEAR,"select trim(to_char(c.stop_date, 'YYYY')) from workforce.conference c where c.conference_id = %CONFERENCE_ID",123,Employer
207,Conference Start Month,CONFERENCE_START_MONTH,"select trim(to_char(c.start_date, 'Month')) from workforce.conference c where c.conference_id = %CONFERENCE_ID",123,Employer
208,Conference End Month,CONFERENCE_END_MONTH,"select trim(to_char(c.stop_date, 'Month')) from workforce.conference c where c.conference_id = %CONFERENCE_ID",123,Employer
209,Registration Due Date,DUE_DATE,"select to_char(trunc(%REG_DUE_DATE), 'fmMonth Ddth, yyyy') from dual",123,Employer
210,Employer Contact Email,EMP_CONTACT_EMAIL,"select ad.e_mail from dbo.addresses ad
                                     					 where ad.entity_id = 254 and ad.key_value = %PERSON_ID",123,Employer
211,Employer Training Table,EMP_TRAIN_NOTIFICATION_TABLE,"select to_char(' '), trim(to_char(cd.start_date,'Day')) || ', '
                                     						|| trim(to_char(cd.start_date,'Month')) || ' '		
                                     						 || to_char(cd.start_date,'ddth, yyyy') as Meeting_Date,ad.city as Location_City, 
                                                             to_char(m.start_date,'HH:MI AM')||' to '||to_char(m.stop_date,'HH:MI AM') as Meeting_Time,                                   
                                                             oi.oi_name||chr(10)||decode(ad.address_1,null,null,ad.address_1||chr(10))||decode(ad.address_2,null,null,ad.address_2||chr(10))||decode(ad.address_3,null,null,ad.address_3||chr(10))||ad.city||' '||ad.state||' '||dbo.pkg_benefit_s.f_build_zipcode(ad.zip) as Facility_Name_Address,
                                                             trim(to_char(cd.start_date, 'Day')) ||' '|| trim(to_char(cd.start_date, 'Month ddth, yyyy')) as Meeting_BMark
                                                             from workforce.meeting m,  workforce.conference c, workforce.conference_days cd,dbo.addresses ad, dbo.oi_organization oi
                                                             where m.conference_days_id=cd.conference_days_id
                                                             and cd.conference_id=c.conference_id
                                                             and c.conference_id = %CONFERENCE_ID                                  
                                                             and oi.organization_id = c.location_Id
                                                             and ad.entity_Id = dbo.pkg_Benefit_s.f_get_entity_Id('OI_ORGANIZATION')
                                                             and ad.key_value = oi.oi_organization_id
                                                             and (ad.stop_date is null OR ad.stop_date > sysdate) order by m.start_date",,Employer
212,Legal Mark,Legal_Mark,"SELECT e.employer_code from dbo.employer e
                                                                     WHERE e.employer_id = (SELECT mc.employer_id
                                                                                              FROM dbo.member_contract mc
                                                                                             WHERE mc.member_id = %MEMBER_ID
                                                                                               AND mc.employer_id = %EMPLOYER_ID
                                                                                               AND mc.stop_date IS NULL
                                                                                               AND rownum = 1)",124,Legal
214,Contact Address Details,EMP_CONTACT_DETAILS,"Select case
                                                             when p.prefix is not null then
                                                             dbo.pkg_benefit_s.f_get_value_description('PREFIX',upper(P.PREFIX),'Y','N') || ' ' 
                                                             else ''
                                                             end || case when p.first_name is not null then
                                                             p.first_name || ' ' else ''
                                                             end || case when p.middle_name is not null then
                                                             p.middle_name || ' ' else ''
                                                             end || case when p.last_name is not null then
                                                             p.last_name || ' ' else    ''
                                                             end || case when p.suffix is not null then
                                                             dbo.pkg_benefit_s.f_get_value_description('SUFFIX',upper(P.SUFFIX),'Y','N')
                                                             else ''
                                                             end as ContactName, 
                                                             Initcap(p.first_name) as FirstName,
                                                             ad.Address_1, ad.Address_2, ad.City, ad.State, 
															 dbo.pkg_benefit_s.f_build_zipcode(ad.Zip) as zip	
                                                             from dbo.Person P, dbo.Oi_Person OiP, dbo.Addresses ad
                                                             Where OiP.person_Id = p.person_Id
                                                             and p.Person_Id = %PERSON_ID
                                                             and (ad.stop_date is null or ad.stop_date > sysdate)
                                                             and ad.entity_id = dbo.pkg_benefit_s.f_get_entity_Id('OI_PERSON')
                                                             and ad.key_value = OiP.Oi_Person_Id",123,Employer
215,AP Info Name,AP_INFO_NAME,"select nvl2(dp.first_name, upper(dp.first_name) || ' ', '') ||
       nvl2(dp.middle_name, upper(dp.middle_name) || ' ', '') ||
       upper(dp.last_name) as AP_Info_Name
  from dbo.person p, dbo.member m, dbo.dependent d, dbo.person dp
 where d.person_id = p.person_id
   and p.person_id = m.person_id
   and m.member_id = %MEMBER_ID
   and d.relation = 'AP'
   and dp.person_id = d.dependent_id ",,Member
217,AP Mail Date,AP_MAIL_DATE,"select mail_date
  from (select to_char(co.date_of_order, 'MM/DD/YYYY') as Mail_Date
          from dbo.court_order co, dbo.person p, dbo.business_entity_key bek
         where co.payor_business_entity_key_id = %MEMBER_ID
           and bek.business_entity_key_id = co.payor_business_entity_key_id
           and p.person_id = bek.key_value)
 where rownum = 1",,Member
218,SAP Info Name,SAP_INFO_NAME,"select nvl2(dp.first_name, upper(dp.first_name) || ' ', '') ||
       nvl2(dp.middle_name, upper(dp.middle_name) || ' ', '') ||
       upper(dp.last_name) as SAP_Info_Name
  from dbo.person p, dbo.member m, dbo.dependent d, dbo.person dp
 where d.person_id = p.person_id
   and p.person_id = m.person_id
   and m.member_id = %MEMBER_ID
   and d.relation = 'SA'
   and dp.person_id = d.dependent_id ",,Member
219,SAP Info Address,SAP_INFO_ADDRESS,"select sap_info_address
  from (select decode(a.address_1, null, '', upper(a.address_1)) ||
               decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
               decode(a.address_3, null, '', chr(10) || upper(a.address_3)) as sap_info_address,
               a.address_type
          from dbo.person    p,
               dbo.member    m,
               dbo.addresses a,
               dbo.dependent d,
               dbo.person    dp
         where d.person_id = p.person_id
           and p.person_id = m.person_id
           and m.member_id = %MEMBER_ID
           and d.relation = 'SA'
           and a.key_value = dp.person_id
           and dp.person_id = d.dependent_id
           and a.address_type in ('C', 'R')
           and a.stop_date is null
         order by a.address_type asc)
 where rownum = 1",,Member
220,Date_Appeal_Recieved,DATE_APPEAL_RCVD,"select date_appeal_recieved from 
(select to_date(dv.value, 'mm/dd/yyyy') as date_appeal_recieved
  from dbo.datasheet_value dv
 where dv.datasheet_id =
       dbo.pkg_benefit_ds.f_get_datasheet_id('DS_MEM_APPEALS')
   and dv.owner_id = dbo.pkg_benefit_ds.f_get_owner_id('MEMBER')
   and dv.attribute_id =
       dbo.pkg_benefit_s.f_get_attribute_id('DS_APPEAL_RECEIVED_DATE', 'DA')
   and dv.key_value = to_char(%MEMBER_ID)
   order by dv.instance_id desc) where rownum=1",,Member
221,Date Annual Disability Verification letter,ANNUAL_DISB_LETTER_DATE,"select date_annual_disability_letter
  from (select to_char(bhl.inserted_date, 'MM/DD/YYYY') as date_annual_disability_letter
          from dbo.batch_header_log bhl, dbo.batch_definition bd
         where bd.batch_id = bhl.batch_id
           and bd.description like 'Disability Return to Work Batch'
         order by bhl.process_id desc)
 where rownum = 1",,Member
222,Court Order Number,COURT_ORDER_NUMBER,"select Court_Order_Number
  from (select co.court_order_number
          from dbo.court_order co
         where co.payor_business_entity_key_id = %MEMBER_ID
         order by 1 desc)
 where rownum = 1",,Member
223,Due Date AP,DUE_DATE_AP,"select to_char(sysdate+60,'MM/DD/YYYY') as Due_Date_AP from dual",,Member
224,Due Date SAP,DUE_DATE_SAP,"select to_char(sysdate+60,'MM/DD/YYYY') as Due_Date_SAP from dual",,Member
225,Representative Payee Name,REPRESENTATIVE_PAYEE_NAME,"select nvl2(first_name,upper(first_name)||' ','')||nvl2(mi,upper(mi)||' ','')||upper(last_name)||nvl2(suffix,' '||suffix,'') as Representative_Payee_Name from 
(select max(decode(a.attribute_name, 'DS_MC_FIRST_NAME', dv.value)) as first_name,
       max(decode(a.attribute_name, 'DS_MC_MI', dv.value)) as mi,
       max(decode(a.attribute_name, 'DS_MC_LAST_NAME', dv.value)) as last_name,
       max(decode(a.attribute_name, 'DS_MC_SUFFIX', dv.value)) as suffix
  from dbo.datasheet_value dv
 inner join dbo.attribute a on dv.attribute_id = a.attribute_id
 where dv.datasheet_id =
       dbo.pkg_benefit_ds.f_get_datasheet_id('DS_MEMBER_CONTACTS')
   and dv.owner_id = dbo.pkg_benefit_ds.f_get_owner_id('MEMBER')
   and dv.key_value = to_char(%MEMBER_ID)
   and dv.seq_no =
       (select max(dv.seq_no)
          from dbo.datasheet_value dv
         where dv.key_value = to_char(%MEMBER_ID)
           and dv.datasheet_id =
               dbo.pkg_benefit_ds.f_get_datasheet_id('DS_MEMBER_CONTACTS')
           and dv.owner_id = dbo.pkg_benefit_ds.f_get_owner_id('MEMBER') and dv.value='PR'))",,Member
226,Authorized Agent,AUTHORIZED_AGENT,"select decode(%PID_STOP_DATE,

              null,

              (select nvl2(first_name, upper(first_name) || ' ', '') ||

                      nvl2(mi, upper(mi) || ' ', '') || upper(last_name) ||

                      nvl2(suffix, ' ' || suffix, '') as Authorized_Agent

                 from (select max(decode(a.attribute_name,

                                         'DS_MC_FIRST_NAME',

                                         dv.value)) as first_name,

                              max(decode(a.attribute_name,

                                         'DS_MC_MI',

                                         dv.value)) as mi,

                              max(decode(a.attribute_name,

                                         'DS_MC_LAST_NAME',

                                         dv.value)) as last_name,

                              max(decode(a.attribute_name,

                                         'DS_MC_SUFFIX',

                                         dv.value)) as suffix

                         from dbo.datasheet_value dv

                        inner join dbo.attribute a

                           on dv.attribute_id = a.attribute_id

                        where dv.datasheet_id =

                              dbo.pkg_benefit_ds.f_get_datasheet_id('DS_MEMBER_CONTACTS')

                          and dv.owner_id =

                              dbo.pkg_benefit_ds.f_get_owner_id('MEMBER')

                          and dv.key_value = %MEMBER_ID

                          and dv.seq_no =

                              (select max(dv.seq_no)

                                 from dbo.datasheet_value dv

                                where dv.key_value = %MEMBER_ID

                                  and dv.datasheet_id =

                                      dbo.pkg_benefit_ds.f_get_datasheet_id('DS_MEMBER_CONTACTS')

                                  and dv.owner_id =

                                      dbo.pkg_benefit_ds.f_get_owner_id('MEMBER')

                                  and dv.value = 'Y'))),

              (select Authorized_Agent

                 from (select nvl2(dq.ds_mc_first_name,

                                   upper(dq.ds_mc_first_name) || ' ',

                                   '') ||

                              nvl2(dq.ds_mc_mi, upper(dq.ds_mc_mi) || ' ', '') ||

                              upper(dq.ds_mc_last_name) ||

                              nvl2(dq.ds_mc_suffix, ' ' || dq.ds_mc_suffix, '') as Authorized_Agent

                         from dbo.V_DS_MEMBER_DSMEMBERCON_073_Q dq

                        where dq.key_value = %MEMBER_ID

                          and dq.ds_mc_stop_date =

                              %PID_STOP_DATE

                        order by dq.seq_no desc)

                where rownum = 1))

  from dual",,Member
249,Outdated_Warrant_Number5,OUTDATED_WARRENT_NUMBER5,"select check_no as Outdated_Warrant_Number5
  from (select lead(d.disbursement_date, 4, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 4, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 4, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
250,Outdated_Warrant_Amt5,OUTDATED_WARRENT_AMOUNT5,"select trim(to_char(amount, '999,999,990.00')) as Outdated_Warrant_Amt5
  from (select lead(d.disbursement_date, 4, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 4, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 4, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
251,Outdated_Warrant_Issue_Date6,OUTDATED_WARRENT_ISSUE_DATE6,"select to_char(warrent, 'mm/dd/yyyy') as Outdated_Warrant_Issue_Date6
  from (select lead(d.disbursement_date, 5, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 5, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 5, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
252,Outdated_Warrant_Number6,OUTDATED_WARRENT_NUMBER6,"select check_no as Outdated_Warrant_Number6
  from (select lead(d.disbursement_date, 5, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 5, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 5, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
253,Outdated_Warrant_Amt6,OUTDATED_WARRENT_AMOUNT6,"select trim(to_char(amount, '999,999,990.00')) as Outdated_Warrant_Amt6
  from (select lead(d.disbursement_date, 5, null) over(order by d.disbursement_id desc) as warrent,
               lead(d.check_eft_no, 5, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 5, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
254,Member Pension EFT Bank Name,MEMBER_PENSION_EFT_BANK_NAME,"select bank_name
  from (select ea.bank_name
          from dbo.eft_authorization        ea,
               dbo.v_member_q               q,
               dbo.eft_authorization_header eah
         where ea.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and ea.recipient_key_value = q.person_id
           and q.member_id = %MEMBER_ID
           and ea.eft_authorization_header_id =
               eah.eft_authorization_header_id
         order by eah.start_date desc)
 where rownum = 1",,Member
255,Type of Payment,TYPE_OF_PAYMENT,"select type_of_payment
  from (select ba.description as type_of_payment
          from dbo.disbursement d, dbo.benefit_account ba, dbo.v_member_q q
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = q.person_id
           and ba.benefit_account_id = d.benefit_account_id
           and q.member_id =%MEMBER_ID
         order by d.disbursement_id desc)
 where rownum = 1",,Member
486,Service Credits Table,SERVICE_CREDITS_TABLE,"select * from 
                                                     (select 'Regular Service' as SERV_DESC,
                                                     client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                     'PN_REG_SVC_CREDS_12') as SERVICE
                                                     from dual
                                                     union all
                                                     select 'Sheriff & Deputy Sheriff Service' as SERV_DESC,
                                                     client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                     'PN_SHR_SVC_CREDS_12') as SERVICE
                                                     from dual
                                                     union all
                                                     select 'Protection Occupation Service' as SERV_DESC,
                                                     client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                     'PN_PROT_SVC_CREDS_12') as SERVICE
                                                     from dual) c where to_number(c.service) > 0",,Pension
487,Disbursement EFT Details,DISBURSE_EFT_DETAILS,"select dr.eft_bank_name as BANK_NAME,
                                                     dr.eft_routing_no as ROUTING_NO,
                                                     decode(nvl(dr.Eft_Account_Type,'C'),'C','Checking','S','Savings') as ACCT_TYPE,
                                                     dr.disbursement_type as DISB_TYPE
                                                     from dbo.disburse_schedule ds, dbo.disbursement_request dr
                                                     where ds.disbursement_schedule_id = dr.disbursement_schedule_id
                                                     and ds.source_entity = dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                                                     and ds.source_key = %PENSION_APPLICATION_ID",,Pension
488,Contingent Annuitant,CONTINGENT_ANNUITANT,"Select nvl2(p.first_name, upper(p.first_name) || ' ', '') ||nvl2(p.last_name, upper(p.last_name), '') as BEN_NAME, 
                                     'Date of birth:' || to_char(p.Birth_date,'MM/dd/yyyy') as BEN_DOB
                                     from dbo.beneficiary      b,
                                     dbo.v_member_q       vmq,
                                     dbo.person           p,
                                     dbo.beneficiary_type bt
                                     where vmq.member_id = %MEMBER_ID
                                     and vmq.person_id = b.person_id
                                     and p.person_id = b.beneficiary_id
                                     and b.beneficiary_type_id = bt.beneficiary_type_id
                                     and bt.beneficiary_type_code = 'Primary' and (b.stop_date is NULL OR b.stop_date>sysdate) and rownum = 1",,Pension
489,Last Occupation Code,LAST_OCC_CODE,"select a.job_category jc
                                                     from (Select pad.job_category
                                                          from dbo.part_account_detail pad,
                                                          dbo.part_account        pat,
                                                          dbo.pension_application pa
                                                          where pa.part_account_id = pat.part_account_id
                                                          and pat.part_account_id = pad.part_account_id
                                                          and pa.application_id = %PENSION_APPLICATION_ID
                                                          order by pad.period_from_date desc) a
                                                      where rownum = 1",,Pension
490,Benefit Summary Block,BEN_SUMMARY_BLOCK,"select Display_name as Descrip,
                                                      Amount_01 as Current_Month,
                                                      Amount_02 as Next_Month
                                                      from table(CLIENT.f_get_ben_summary_block(%PENSION_APPLICATION_ID))",,Pension
491,Option 2 Present Age,Option2_Present_Age,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.99')),
                                                 '9999999.99'))
                                                 from dbo.pension_formula_value pfv, dbo.pension_application pa
                                                 where pfv.application_id =pa.application_id
                                                  and pa.application_id =%PENSION_APPLICATION_ID
                                                  and pa.pension_option_id = pfv.pension_option_id
                                                  and pfv.business_rule_id in
                                                   (select br.business_rule_id
                                                   from dbo.business_rule br
                                                   where br.internal_name in
                                                   ('PN_OPT_2_REG_12', 'PN_OPT2_SHR_12', 'PN_OPT_2_OCC_12'))",,Pension
492,Service Credits Table1,SERVICE_CREDITS_TABLE_1,"select SERV_DESC , TO_NUMBER (SERVICE/ 12 ) SERVCE from 
                                                     (select 'Regular Service' as SERV_DESC,
                                                     client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                     'PN_REG_TTSC_DISPLAY') as SERVICE
                                                     from dual
                                                     union all
                                                     select 'Sheriff & Deputy Sheriff Service' as SERV_DESC,
                                                     client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                     'PN_SHR_TTSC_DISPLAY') as SERVICE
                                                     from dual
                                                     union all
                                                     select 'Protection Occupation Service' as SERV_DESC,
                                                     client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                     'PN_PRT_TTSC_DISPLAY') as SERVICE
                                                     from dual) c where to_number(c.service) > 0",,Pension
495,Disability_Date_RRet,DISABILTIY_DATE_RRET,"Select pfv.value as disability_date_rt
  from dbo.pension_formula_value pfv,
       dbo.pension_application   pa,
       dbo.pension_option        po,
       dbo.pension_type          pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPERSRET'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in ('PN_DISABILITY_DATE'))",,Member
496,Mem_Inv_RRet,MEM_INV_RRET,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.99')),
                    '9,999,999.99')) as mem_investment,
 '$'||trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.99')),
                    '9,999,999.99'))||',' as mem_investment_1
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
 --  and pt.pension_type_code = 'IPERSRET'--sv1 if app id is passing no need to pass pension type
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_TOTAL_MEM_INV'))",,Member
497,EFT AMDB,EFT_AMDB,"Select BANK_NAME, ROUTING_NO, ACCOUNT_TYPE, APPROVAL_STATUS, ACCOUNT_NO from (select ea.bank_name Bank_Name,
       lpad(ea.routing_no, 9, '0') Routing_No,
       decode(ea.recipient_account_type, 'C', 'checking', 'S', 'savings') as Account_Type,
       ea.eft_approval_status Approval_Status,
       eah.start_date,
       trim(ea.recipient_account_no) as ACCOUNT_NO
  from dbo.eft_authorization        ea,
       dbo.eft_authorization_header eah,

       dbo.benefit_account          ba
 where ea.eft_authorization_header_id = eah.eft_authorization_header_id

   and eah.source_entity_id =
       dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
   and eah.source_key_value = %PENSION_APPLICATION_ID
   and ea.eft_approval_status = 'A'
   and (eah.end_date is null or to_char(eah.end_date, 'mm/dd/yyyy') >
       to_char(sysdate, 'mm/dd/yyyy'))
   and ea.benefit_account_id = ba.benefit_account_id
   and ba.benefit_type in ('MD')
 order by eah.start_date desc) where rownum=1",,Member
500,Member Pension Current Month,MEMBER_PENSION_CURRENT_MONTH,"SELECT to_char((to_date(substr(ds.explanation, 1, 10),'mm/dd/yyyy')),'Month') 
      AS cur_mon_gross
      FROM ((SELECT *
              FROM dbo.disburse_schedule ds
             WHERE ds.source_entity =
                   dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
               AND ds.source_key = %PENSION_APPLICATION_ID
               AND SYSDATE BETWEEN
                   to_date(substr(ds.explanation, 1, 10),'mm/dd/yyyy') AND
                   to_date(substr(ds.explanation, 14, 10),'mm/dd/yyyy')
               AND ds.explanation IS NOT NULL
               AND length(ds.explanation) = 23) ds )",,Pension
501,Beneficiary Summary Months Secondary App,BEN_SS_SUMMARY_MONTHS_SECOND_APP,"Select Amount_01 as Last_Month,
       Amount_02 as Current_Month,
       Amount_03 as Next_Month 
       from table(client.f_get_ss_ben_summary_months((select pa.parent_application_id
                                                  from dbo.pension_application pa
                                                 where pa.application_id =%PENSION_APPLICATION_ID)))",,Member
493,Current Month For Recalc,CUR_MON_FOR_RECALC,"select trim(to_char(sysdate, 'Month')) from dual",,Member
494,BFR Non Covered Month,BFR_NON_COVERED_MONTH,"select trim(to_char(add_months(to_date(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FME'),'mm/dd/yyyy'),1),'Month')) from dual",,Member
502,Beneficiary SS Summary Months,BEN_SS_SUMMARY_MONTHS,"Select Amount_01 as Last_Month,
       Amount_02 as Current_Month,
       Amount_03 as Next_Month 
       from table(client.f_get_ss_ben_summary_months(%PENSION_APPLICATION_ID))",,Pension
503,Pension Dates Info,PENSION_DATES_INFORMATION,select pp.date_05 from dbo.pension_preapp pp where pp.member_id = %MEMBER_ID,,Member
504,Preliminary Letter Benefit Info 1,PENSION_BENEFIT_INFO_1,"select to_number(trim(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                             'PN_OPT_6_CA_PERCENT'))) * 100 as OPT6_CA_PERCENT_PCT
                                                      from dual",,Pension
505,Outdated_Warrant_Issue_Date1,OUTDATED_WARRANT_ISSUE_DATE1,"select to_char(warrant, 'mm/dd/yyyy') as Outdated_Warrant_Issue_Date1
  from (select lead(d.disbursement_date, 0, null) over(order by d.disbursement_id desc) as warrant,
               lead(d.check_eft_no, 0, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 0, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
506,Outdated_Warrant_Number1,OUTDATED_WARRANT_NUMBER1,"select check_no as Outdated_Warrant_Number1
  from (select lead(d.disbursement_date, 0, null) over(order by d.disbursement_id desc) as warrant,
               lead(d.check_eft_no, 0, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 0, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
461,Option 1 SS,OPT1_SS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.00')),
                    '999,999,999.00')) as opt1_pres_age
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OPT_1_PA_ACT_DTH_BENE'))",,Member
462,Option 1 Death Benefit SS,OPT1_DEATH_BEN_SS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.00')),
                    '999,999,999.00')) as opt1_death_ben
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OP1_DEATH_BENE'))",,Member
463,Option 3 SS,OPT3_SS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.00')),
                    '999,999,999.00')) as opt3_pres_age
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OPT_3_PA_BENE'))",,Member
464,Option 4 SS,OPT4_SS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.00')),
                    '999,999,999.00')) as opt4_pres_age
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OPT_4_PA_BENE'))",,Member
465,Option 5 SS,OPT5_SS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.00')),
                    '999,999,999.00')) as opt5_pres_age
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OPT_5_PA_BENE'))",,Member
466,Option 6 SS,OPT6_SS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.00')),
                    '999,999,999.00')) as opt6_pres_age, '$'||trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.00')),
                    '999,999,999.00')) as opt6_pres_age_1
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OPT_6_PRES_AGE'))",,Member
467,SS Benefit SS,SS_BENE_SS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.99')),
                    '9999999.99')) as ss_bene_ss
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_SS_BENE'))",,Member
468,Age 62 Date,AGE_62_DATE,"select add_months(p.birth_date, 744)
                                                         as age_62_date
                                                         from dbo.person p, dbo.member m
                                                         where p.person_id = m.person_id and
                                                         m.member_id = %MEMBER_ID",,Member
469,Post 62 Option 7 SS,POST_62_OPT7_SS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.99')),
                    '9999999.99')) as post_62_opt7_ss
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OPT_7_POST_62_BENE'))",,Member
470,Pre 62 Option 7 SS,PRE_62_OPT7_SS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.99')),
                    '9999999.99')) as pre_62_opt7_ss
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OPT_7_PRE_62_BENE'))",,Member
471,Post 62 C/A Option 7_SS,POST_62_CA_OPT7_SS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.99')),
                    '9999999.99')) as post_62_ca_opt7_ss
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OPT_7_POST_62_CA'))",,Member
472,Investment SS,INVESTMENT_SS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.99')),
                    '9999999.99')) as mem_investment
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_TOTAL_MEM_INV'))",,Member
473,Option 2 SS,OPT2_SS,"select case
         when nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_MP_ELIGIBLE'), 'N') = 'N' then
          nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OPT_2_PRES_AGE'),
              '0.00')
         else
          nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2_MP'), '0.00')
       end as opt2_ss
  from dual",,Member
474,Winning Average Salary SS,WIN_AVG_SAL,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999999.99')),
                    '999,999,999.00')) as win_avg_sal
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_FAS'))",,Member
475,Regular Years,REG_YEARS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.99')),
                    '9999999.99')) as reg_years
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_REG_TTSC_DISPLAY'))",,Member
476,Sheriff Years,SHERIFF_YEARS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.99')),
                    '9999999.99')) as sheriff_years
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id   
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_SHR_TTSC_DISPLAY'))",,Member
477,Protection Years,PROTECTION_YEARS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.99')),
                    '9999999.99')) as Protection_years
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_PRT_TTSC_DISPLAY'))",,Member
478,Disability Date SS,DISABILITY_DATE_SS,"Select trim(to_char(sum(to_number(nvl(pfv.value, 0), '999999.99')),
                    '9999999.99')) as disability_date_ss
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_DISABILITY_DATE'))",,Member
479,Benefit Summary Block SS,BEN_SUMMARY_BLOCK_SS,"select Display_name as Descrip,
       Amount_01 as Last_Month,
       Amount_02 as Current_Month,
       Amount_03 as Next_Month 
       from table(CLIENT.f_get_ss_ben_summary_block(%PENSION_APPLICATION_ID, %PERSON_ID))",,Member
256,AP Info City,AP_INFO_CITY,"select ap_info_City
  from (select upper(a.city) as ap_info_city,
               a.address_type
          from dbo.person    p,
               dbo.member    m,
               dbo.addresses a,
               dbo.dependent d,
               dbo.person    dp
         where d.person_id = p.person_id
           and p.person_id = m.person_id
           and m.member_id = %MEMBER_ID
           and d.relation = 'AP'
           and a.key_value = dp.person_id
           and dp.person_id = d.dependent_id
           and a.address_type in ('C', 'R')
           and a.stop_date is null
         order by a.address_type asc)
 where rownum = 1",,Member
257,AP Info State,AP_INFO_STATE,"select ap_info_state
  from (select upper(a.state) as ap_info_state,
               a.address_type
          from dbo.person    p,
               dbo.member    m,
               dbo.addresses a,
               dbo.dependent d,
               dbo.person    dp
         where d.person_id = p.person_id
           and p.person_id = m.person_id
           and m.member_id = %MEMBER_ID
           and d.relation = 'AP'
           and a.key_value = dp.person_id
           and dp.person_id = d.dependent_id
           and a.address_type in ('C', 'R')
           and a.stop_date is null
         order by a.address_type asc)
 where rownum = 1",,Member
258,AP Info Zip,AP_INFO_ZIP,"select ap_info_zip
  from (select dbo.pkg_benefit_s.f_build_zipcode(a.zip) as ap_info_zip,
               a.address_type
          from dbo.person    p,
               dbo.member    m,
               dbo.addresses a,
               dbo.dependent d,
               dbo.person    dp
         where d.person_id = p.person_id
           and p.person_id = m.person_id
           and m.member_id = %MEMBER_ID
           and d.relation = 'AP'
           and a.key_value = dp.person_id
           and dp.person_id = d.dependent_id
           and a.address_type in ('C', 'R')
           and a.stop_date is null
         order by a.address_type asc)
 where rownum = 1",,Member
259,SAP Info City,SAP_INFO_CITY,"select sap_info_city
  from (select upper(a.city) as sap_info_city,
               a.address_type
          from dbo.person    p,
               dbo.member    m,
               dbo.addresses a,
               dbo.dependent d,
               dbo.person    dp
         where d.person_id = p.person_id
           and p.person_id = m.person_id
           and m.member_id = %MEMBER_ID
           and d.relation = 'SA'
           and a.key_value = dp.person_id
           and dp.person_id = d.dependent_id
           and a.address_type in ('C', 'R')
           and a.stop_date is null
         order by a.address_type asc)
 where rownum = 1",,Member
260,SAP Info State,SAP_INFO_STATE,"select sap_info_state
  from (select upper(a.state) as sap_info_state,
               a.address_type
          from dbo.person    p,
               dbo.member    m,
               dbo.addresses a,
               dbo.dependent d,
               dbo.person    dp
         where d.person_id = p.person_id
           and p.person_id = m.person_id
           and m.member_id = %MEMBER_ID
           and d.relation = 'SA'
           and a.key_value = dp.person_id
           and dp.person_id = d.dependent_id
           and a.address_type in ('C', 'R')
           and a.stop_date is null
         order by a.address_type asc)
 where rownum = 1",,Member
261,SAP Info Zip,SAP_INFO_ZIP,"select sap_info_zip
  from (select dbo.pkg_benefit_s.f_build_zipcode(a.zip) as sap_info_zip,
               a.address_type
          from dbo.person    p,
               dbo.member    m,
               dbo.addresses a,
               dbo.dependent d,
               dbo.person    dp
         where d.person_id = p.person_id
           and p.person_id = m.person_id
           and m.member_id = %MEMBER_ID
           and d.relation = 'SA'
           and a.key_value = dp.person_id
           and dp.person_id = d.dependent_id
           and a.address_type in ('C', 'R')
           and a.stop_date is null
         order by a.address_type asc)
 where rownum = 1",,Member
262,EFT Bank Name,EFT_BANK_NAME,"select bank_name
  from (select ea.bank_name, eah.start_date
          from dbo.eft_authorization        ea,
               dbo.eft_authorization_header eah,
               dbo.member                   m
         where ea.eft_authorization_header_id =
               eah.eft_authorization_header_id
           and m.member_id = %MEMBER_ID
           and ea.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and ea.recipient_key_value = m.person_id
           and eah.end_date is null
         order by eah.start_date desc) x
 where rownum = 1",,Member
263,Discont or New Monthly Disb Reduction Amount,DISCONT_OR_NEW_MONTHLY_DISB_REDUCTION_AMOUNT,"select case
         when amount is null or amount <= 0 then
          'Discontinued'
         else
          trim(to_char(amount, '$999,999,990.00'))
       end
  from (select nvl((select a.gross_amount
                     from (select ds.gross_amount,
                                  ds.disbursement_schedule_id
                             from dbo.disburse_schedule ds,
                                  dbo.member            m,
                                  dbo.benefit_account   ba
                            where ds.payee_entity =
                                  dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                              and ds.payee_key = m.person_id
                              and ds.benefit_account_id =
                                  ba.benefit_account_id
                              and m.member_id = %MEMBER_ID
                              and ds.stop_date is null
                              and ba.benefit_type = 'MP'
                            order by ds.disbursement_schedule_id desc) a
                    where rownum = 1),
                   0) -
               nvl((select dtd.deduction_amt
                     from dbo.deduction_template_detail dtd,
                          dbo.deduction_template        dt,
                          dbo.disburse_schedule         ds,
                          dbo.deduction_type            dtt,
                          dbo.member                    m,
                          dbo.benefit_account           ba
                    where ds.payee_entity = dt.payee_entity_id
                      and ds.payee_key = dt.payee_key_value
                      and ds.source_entity =
                          nvl(dt.source_entity_id, ds.source_entity)
                      and ds.source_key =
                          nvl(dt.source_key_value, ds.source_key)
                      and dtd.deduction_template_id =
                          dt.deduction_template_id
                      and ds.payee_entity =
                          dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                      and ds.payee_key = m.person_id
                      and m.member_id = %MEMBER_ID
                      and dtt.deduction_type = 'DO'
                      and dtt.deduction_type = dtd.deduction_type
                      and ba.benefit_type = 'MP'
                      and ba.benefit_account_id = dt.benefit_account_id
                      and dt.benefit_account_id = ds.benefit_account_id
                      and ds.start_date = dtd.start_date
                      and ds.stop_date is null
                      and dtd.stop_date is null),
                   0) as amount
          from dual) x
                                     ",,Member
264,Employer Meeting Details,EMP_MEETING_DETAILS,"Select m.subject as Meeting_Name, TO_CHAR(cd.start_date, 'mm/dd/yyyy') as Meeting_Date, 
                                                             trim(to_char(cd.start_date,'Day')) as Meeting_WeekDay,
                                                             to_char(m.start_date,'HH:MI AM') as Meeting_Start_time, 
                                                             to_char(m.stop_date,'HH:MI AM') as Meeting_Stop_time,
                                                             oio.Oi_name as Facility_Name
                                                             from workforce.meeting m, 
                                                             workforce.conference_days cd, workforce.conference c, dbo.oi_organization oio
                                                             where m.conference_days_id = cd.conference_days_id
                                                             and cd.conference_id = c.conference_id
                                                             and c.Location_Id = oio.organization_id
                                                             and m.meeting_id = %MEETING_ID",,Employer
265,CURRENT TIME hh mm ss,CURRENT_TIME_HH_MM_SS,"select to_char(sysdate,'hh:mi:ss') as CurrentTime from dual",,Pension
53,Current Date,CURRENT_DATE,"select  TO_CHAR(sysdate,'MM/DD/YYYY') as currentDate, 
                                   TO_CHAR(ADD_MONTHS(SYSDATE,-12),'MM/DD/YYYY') as yearMinusOne,
                                   TO_CHAR(SYSDATE + 14,'MM/DD/YYYY') as dayPlus14,
                                   TO_CHAR(SYSDATE + 15,'MM/DD/YYYY') as dayPlus15,
                                   TO_CHAR(SYSDATE + 30,'MM/DD/YYYY') as dayPlus30,
                                   TO_CHAR(SYSDATE + 60,'MM/DD/YYYY') as dayPlus60 from dual",,Member
555,Pension Option Type Percent,PEN_OPT_TYPE_PER,"select case
         when pot.pension_option_type_code = 'JSA100' then
          100
         when pot.pension_option_type_code = 'JSA75' then
          75
         when pot.pension_option_type_code = 'JSA50' then
          50
         when pot.pension_option_type_code = 'JSA25' then
          25
         when pot.pension_option_type_code = 'JSAP100' then
          100
         when pot.pension_option_type_code = 'JSAP75' then
          75
         when pot.pension_option_type_code = 'JSAP50' then
          50
         when pot.pension_option_type_code = 'JSAP25' then
          25
         when pot.pension_option_type_code = 'LPJSA100' then
          100
         when pot.pension_option_type_code = 'LPJSA75' then
          75
         when pot.pension_option_type_code = 'LPJSA50' then
          50
         when pot.pension_option_type_code = 'LPJSA25' then
          25
         else
          0
       end percentage
  from dbo.pension_application pa,
       dbo.pension_option      po,
       dbo.pension_option_type pot
 where pa.pension_option_id = po.pension_option_id
   and po.pension_option_type_id = pot.pension_option_type_id
   and pa.application_id = %PENSION_APPLICATION_ID",,Member
272,Retired ReEmployment Years,RETIRED_REEMP_YEARS,"select client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_RE_YRS_CS') from dual",,Pension
273,Current Payroll Date,CURRENT_PAYROLL_DATE,"SELECT to_char(max(ds.next_pay_date), 'fmMonth yyyy')
                                                    FROM dbo.disburse_schedule ds
                                                    WHERE ds.source_entity =
                                                    dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                                                    AND ds.source_key = %PENSION_APPLICATION_ID
                                                    AND SYSDATE BETWEEN
                                                    to_date(substr(ds.explanation, 1, 10), 'mm/dd/yyyy') AND
                                                    to_date(substr(ds.explanation, 14, 10), 'mm/dd/yyyy')
                                                    AND ds.explanation is NOt NULL
                                                    AND LENGTH(ds.explanation) = 23",,Pension
437,Address With Pension Application ID,ADDRESS_WITH_PENSION_APP_ID,"select trim(a.address_1) as address_1,
                                                  trim(a.address_2) as address_2,
                                                  trim(a.address_3) as address_3,
                                                  a.city||' '||a.state||' '||dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_zip,
case --NG2
when a.country = 'US' then
 TRIM(decode(a.address_3,
             null,
             '',
             upper(a.address_3) || chr(10)) ||
      decode(a.address_1, null, '', upper(a.address_1)) ||
      decode(a.address_2,
             null,
             '',
             chr(10) || upper(a.address_2)) || chr(10) ||
      upper(a.city) || ' ' || upper(a.state) || ' ' ||
      dbo.pkg_benefit_s.f_build_zipcode(a.zip))
else
 TRIM(decode(a.address_3,
          null,
          '',
          upper(a.address_3) || chr(10)) ||
   decode(a.address_1, null, '', upper(a.address_1)) ||
   decode(a.address_2,
          null,
          '',
          chr(10) || upper(a.address_2)) || chr(10) ||
   upper(a.city) ||
   (select case
             when upper((Select upper(s.state_name)
                          from dbo.state s, dbo.country c
                         where s.country_id = c.country_id
                           and c.country_code = a.country
                           and s.state_code = a.state)) is not null then
              ', ' ||
              upper((Select upper(s.state_name)
                      from dbo.state s, dbo.country c
                     where s.country_id = c.country_id
                       and c.country_code = a.country
                       and s.state_code = a.state))
             else
              ''
           end
      from dual) ||
      (select case
             when a.postal_code  is not null then
              ', ' ||
              a.postal_code
             else
              ''
           end
      from dual)|| chr(10) ||
   upper((Select upper(c.country_name)
           from dbo.country c
          where c.country_code = a.country)))
end as member_address,
                                                     initcap(a.city) as city                                                                 
                                            from dbo.addresses a, dbo.person p
                                            where p.person_id = (select bek.key_value
                                            from dbo.business_entity_key bek
                                           where bek.business_entity_key_id =
                                                 (select pa.owner_business_entity_key_id
                                                    from dbo.pension_application pa
                                                   where pa.application_id = %PENSION_APPLICATION_ID))
                                            and  a.address_id =  dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'), p.person_id, 'R')",,Pension
480,Preliminary Letter Benefit Info,PENSION_BENEFIT_INFO,"select client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FME') as FME,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_YRS_CS_DISPLAY') as YOS,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_1_PA_ACT_DTH_BENE') as OPTION1,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OP1_DEATH_BENE') as OPTION1_DB,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_3_PA_BENE') as OPTION_3,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_4_PA_BENE') as OPTION_4,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_5_PA_BENE') as OPTION_5,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_6_PRES_AGE') as OPTION_6,
trim(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_SS_BENE')) as SS_BENEFIT,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_7_PRE_62_BENE') as PRE62_OPTION7,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_7_POST_62_BENE') as POST62_OPTION7,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_7_POST_62_CA') as POST62_CA_OPTION7,
trim(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_INV_SECTION_TOTAL_MEM_INV')) as MEM_INVEST,
to_number(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_4_CA_PERCENT')) as CA_PERCENT,                                                                    
nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2_REGULAR'),0) as OPTION_2,              
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FAS') as WIN_AVG_SAL,              
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_REG_TTSC_DISPLAY')/12 as ANN_REG_SERVICE,              
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_SHR_TTSC_DISPLAY')/12 as ANN_SHRF_SERVICE,              
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_PRT_TTSC_DISPLAY')/12 as ANN_PRO_SERVICE,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_DISABILITY_DATE') as DISABILITY_DATE,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_LAST_PAID_DATE') as LAST_PAID_DATE,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_EFM_MET') as EFM_MET,
 to_number(trim(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_6_CA_PERCENT'))) as OPT6_CA_PERCENT,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_DISABILITY') as DISABILITY_FLAG,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2') as OPTION_2_AMT,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_MP_ELIGIBLE') as OPTION_2_MPF,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2_MP') as OPT2_MPF_AMT,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_MONTHLY_ANNUITY_AMT') as MONTHLY_ANNUITY_AMT
from dual",,Pension
498,FME_UPD,FME_UPD,"select 'The first month you will receive a benefit increased by this period of reemployment is '||trim(to_char(to_date(vpfv.value, ' MM / DD / YYYY '), 'Month')) || ' ' || trim(to_char(to_date(vpfv.value, ' MM / DD / YYYY '), ' YYYY '))||', which means:' as FME
  from dbo.v_pension_formula_value vpfv
 where vpfv.business_rule_internal_name = 'PN_FME'
   and vpfv.application_id = %PENSION_APPLICATION_ID
   and rownum = 1",,Member
499,DISBURSE_EFT_CHECK_REEMP,DISBURSE_EFT_CHECK_REEMP,"select ea.bank_name
      ,lpad(ea.routing_no, 9, '0') --ea.routing_no
      ,ea.recipient_account_no
      ,decode(nvl(ea.recipient_account_type, 'C'), 'C', 'checking', 'S', 'savings') as acct_type
      ,lpad(ea.routing_no, 9, '0')||',' AS routing_no_1 --sv1
      ,ea.recipient_account_no||',' AS recipient_account_no_1
  from dbo.disburse_schedule        ds
      ,dbo.eft_authorization_header eah
      ,dbo.eft_authorization        ea
 where ds.source_entity =
       dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
   and ds.source_key in (Select pa.parent_application_id from dbo.pension_application pa
   where pa.application_id=%PENSION_APPLICATION_ID)
   and ds.sched_status = 'A'
   and ds.payee_entity = ea.recipient_entity_id
   and ds.payee_key = ea.recipient_key_value
   and ds.benefit_account_id = ea.benefit_account_id
   and ea.eft_authorization_header_id = eah.eft_authorization_header_id
   and eah.source_entity_id =
       dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
   and eah.source_key_value in (Select pa.parent_application_id from dbo.pension_application pa
   where pa.application_id=%PENSION_APPLICATION_ID)
   and ea.eft_approval_status = 'A'
   and (ds.stop_date is null or ds.stop_date > sysdate)
   and ds.next_pay_date between eah.start_date 
   and nvl(eah.end_date, ds.next_pay_date)",,Member
333,BFR_Covered_Month,BFR_COVERED_MONTH,"select trim(to_char(add_months(Fme,Violation_Month),'Month')) BFR_Covered_Month
													                         from 
													                         (select f.rate_value_01 Violation_Month
                                                   from dbo.factor_definition fd, dbo.factor f
                                                   where f.factor_id = fd.factor_id
                                                   and fd.factor_name = 'Bonafide Violation Months'
                                                   and f.lookup_value_03 in
                                                   (select max(pad.job_category) over(partition by pad.period_from_date order by pad.period_from_date)
                                                   from dbo.part_account_detail pad
                                                   where pad.part_account_id =
                                                   (select pa.part_account_id
                                                   from dbo.pension_application pa
                                                   where pa.application_id = %PENSION_APPLICATION_ID)
                                                   and pad.job_category is not null)),
													                         (select to_date(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FME'),'MM/dd/yyyy') Fme from dual)",,Pension
336,Benefit Estimate Request,BENEFIT_ESTIMATE_REQUEST,"select %BERQ1, %BERQ2, %BERQ3, %BERQ4, %BERQ5, %BERQ6, %BERQ6A, %BERQ7, %BERQ8, %BERQ9, %BERQ10, %BERQ11, %BERQ12,
 %BERQ13, %BERQ14, %BERQ15, %BERQ16, %BERQ17, %BERQ18, %BERQ19 from dual",139,Pension
337,Next Month Federal,NEXT_MONTH_FEDERAL,"select '$' || trim(to_char(nvl(x.deduction_amt, 0), '999,999,990.00'))
  from (select sum(dtd.deduction_amt) as deduction_amt
          from dbo.deduction_template_detail dtd,
               dbo.deduction_template        dt,
               dbo.disburse_schedule         ds,
               dbo.deduction_type            dtt,
               dbo.member                    m
         where ds.payee_entity = dt.payee_entity_id
           and ds.payee_key = dt.payee_key_value
           and ds.source_entity = nvl(dt.source_entity_id, ds.source_entity)
           and ds.source_key = nvl(dt.source_key_value, ds.source_key)
           and dtd.deduction_template_id = dt.deduction_template_id
           and ds.payee_entity = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and ds.payee_key = m.person_id
           and m.member_id = %MEMBER_ID
           and dtt.deduction_type = 'F'
           and dtt.deduction_type = dtd.deduction_type
           and ds.start_date = dtd.start_date
           and ds.stop_date is null
           and dtd.stop_date is null
           and to_char(ds.start_date, 'mm') =
               to_char(add_months(sysdate, 1), 'mm')) x",,Member
338,Next Month State,NEXT_MONTH_STATE,"select '$' || trim(to_char(nvl(x.deduction_amt, 0), '999,999,990.00'))
  from (select sum(dtd.deduction_amt) as deduction_amt
          from dbo.deduction_template_detail dtd,
               dbo.deduction_template        dt,
               dbo.disburse_schedule         ds,
               dbo.deduction_type            dtt,
               dbo.member                    m
         where ds.payee_entity = dt.payee_entity_id
           and ds.payee_key = dt.payee_key_value
           and ds.source_entity = nvl(dt.source_entity_id, ds.source_entity)
           and ds.source_key = nvl(dt.source_key_value, ds.source_key)
           and dtd.deduction_template_id = dt.deduction_template_id
           and ds.payee_entity = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and ds.payee_key = m.person_id
           and m.member_id = %MEMBER_ID
           and dtt.deduction_type = 'ST'
           and dtt.deduction_type = dtd.deduction_type
           and ds.start_date = dtd.start_date
           and ds.stop_date is null
           and dtd.stop_date is null           
           and to_char(ds.start_date, 'mm') =
               to_char(add_months(sysdate, 1), 'mm')) x   ",,Member
339,WH Change Month,WH_CHANGE_MONTH,"select to_char(start_date, 'Month')
  from (select ds.start_date, ds.disbursement_schedule_id
          from dbo.disburse_schedule ds, dbo.member m
         where ds.payee_entity = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and ds.payee_key = m.person_id
           and m.member_id = %MEMBER_ID
           and ds.stop_date is null
         order by ds.disbursement_schedule_id desc) a
 where rownum = 1",,Member
340,Previous Federal Filing Status,PREV_FED_FILING_STATUS,"select v.description
  from dbo.audit_trail_history ath, dbo.v_attribute_value v
 where ath.attribute_id =
       dbo.pkg_benefit_s.f_get_attribute_id('FILING_STATUS')
   and ath.entity_id =
       dbo.pkg_benefit_s.f_get_entity_id('DEDUCTION_TEMPLATE_DETAIL')
   and ath.key_value_1 in
       (select deduction_template_detail_id
          from (select dtd.deduction_template_detail_id
                  from dbo.deduction_template_detail dtd,
                       dbo.deduction_template        dt,
                       dbo.disburse_schedule         ds,
                       dbo.deduction_type            dtt,
                       dbo.member                    m
                 where ds.payee_entity = dt.payee_entity_id
                   and ds.payee_key = dt.payee_key_value
                   and ds.source_entity =
                       nvl(dt.source_entity_id, ds.source_entity)
                   and ds.source_key =
                       nvl(dt.source_key_value, ds.source_key)
                   and dtd.deduction_template_id = dt.deduction_template_id
                   and ds.payee_entity =
                       dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                   and ds.payee_key = m.person_id
                   and dtt.deduction_type = 'F'
                   and m.member_id = %MEMBER_ID
                   and dtt.deduction_type = dtd.deduction_type
                   and ds.start_date = dtd.start_date
          		   and ds.stop_date is null
                   and dtd.stop_date is null                   
                 order by 1 desc)
         where rownum = 1)
   and v.attribute_name = 'FILING_STATUS'
   and ath.old_value = v.internal_value",,Member
341,Next Federal Filing Status,NEXT_FED_FILING_STATUS,"select description
  from (select dtd.deduction_template_detail_id,
               dtd.filing_status,
               v.description
          from dbo.deduction_template_detail dtd,
               dbo.deduction_template        dt,
               dbo.disburse_schedule         ds,
               dbo.deduction_type            dtt,
               dbo.member                    m,
               dbo.v_attribute_value         v
         where ds.payee_entity = dt.payee_entity_id
           and ds.payee_key = dt.payee_key_value
           and ds.source_entity = nvl(dt.source_entity_id, ds.source_entity)
           and ds.source_key = nvl(dt.source_key_value, ds.source_key)
           and dtd.deduction_template_id = dt.deduction_template_id
           and ds.payee_entity = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and ds.payee_key = m.person_id
           and dtt.deduction_type = 'F'
           and m.member_id = %MEMBER_ID
           and dtt.deduction_type = dtd.deduction_type
           and ds.start_date = dtd.start_date
           and ds.stop_date is null
           and dtd.stop_date is null                     
           and dtd.filing_status = v.internal_value
           and v.attribute_name = 'FILING_STATUS'
           order by 1 desc)
 where rownum = 1",,Member
342,Previous State Filing Status,PREV_STATE_FILING_STATUS,"select v.description
  from dbo.audit_trail_history ath, dbo.v_attribute_value v
 where ath.attribute_id =
       dbo.pkg_benefit_s.f_get_attribute_id('FILING_STATUS')
   and ath.entity_id =
       dbo.pkg_benefit_s.f_get_entity_id('DEDUCTION_TEMPLATE_DETAIL')
   and ath.key_value_1 in
       (select deduction_template_detail_id
          from (select dtd.deduction_template_detail_id
                  from dbo.deduction_template_detail dtd,
                       dbo.deduction_template        dt,
                       dbo.disburse_schedule         ds,
                       dbo.deduction_type            dtt,
                       dbo.member                    m
                 where ds.payee_entity = dt.payee_entity_id
                   and ds.payee_key = dt.payee_key_value
                   and ds.source_entity =
                       nvl(dt.source_entity_id, ds.source_entity)
                   and ds.source_key =
                       nvl(dt.source_key_value, ds.source_key)
                   and dtd.deduction_template_id = dt.deduction_template_id
                   and ds.payee_entity =
                       dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                   and ds.payee_key = m.person_id
                   and dtt.deduction_type = 'ST'
                   and m.member_id = %MEMBER_ID
                   and dtt.deduction_type = dtd.deduction_type
                   and ds.start_date = dtd.start_date
          		   and ds.stop_date is null
                   and dtd.stop_date is null                             
                 order by 1 desc)
         where rownum = 1)
   and v.attribute_name = 'FILING_STATUS'
   and ath.old_value = v.internal_value",,Member
343,Next State Filing Status,NEXT_STATE_FILING_STATUS,"select description
  from (select dtd.deduction_template_detail_id,
               dtd.filing_status,
               v.description
          from dbo.deduction_template_detail dtd,
               dbo.deduction_template        dt,
               dbo.disburse_schedule         ds,
               dbo.deduction_type            dtt,
               dbo.member                    m,
               dbo.v_attribute_value         v
         where ds.payee_entity = dt.payee_entity_id
           and ds.payee_key = dt.payee_key_value
           and ds.source_entity = nvl(dt.source_entity_id, ds.source_entity)
           and ds.source_key = nvl(dt.source_key_value, ds.source_key)
           and dtd.deduction_template_id = dt.deduction_template_id
           and ds.payee_entity = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and ds.payee_key = m.person_id
           and dtt.deduction_type = 'ST'
           and m.member_id = %MEMBER_ID
           and dtt.deduction_type = dtd.deduction_type
           and ds.start_date = dtd.start_date
           and ds.stop_date is null
           and dtd.stop_date is null                     
           and dtd.filing_status = v.internal_value
           and v.attribute_name = 'FILING_STATUS'
           order by 1 desc)
 where rownum = 1     ",,Member
344,Previous Federal,PREVIOUS_FEDERAL,"select trim(to_char(nvl(sum(ath.old_value),0),'$999,999,990.00')) as prev_federal
  from dbo.audit_trail_history ath
 where ath.attribute_id =
       dbo.pkg_benefit_s.f_get_attribute_id('DEDUCTION_AMT')
   and ath.entity_id =
       dbo.pkg_benefit_s.f_get_entity_id('DEDUCTION_TEMPLATE_DETAIL')
   and ath.key_value_1 in
       (select dtd.deduction_template_detail_id
                  from dbo.deduction_template_detail dtd,
                       dbo.deduction_template        dt,
                       dbo.disburse_schedule         ds,
                       dbo.deduction_type            dtt,
                       dbo.member                    m
                 where ds.payee_entity = dt.payee_entity_id
                   and ds.payee_key = dt.payee_key_value
                   and ds.source_entity =
                       nvl(dt.source_entity_id, ds.source_entity)
                   and ds.source_key =
                       nvl(dt.source_key_value, ds.source_key)
                   and dtd.deduction_template_id = dt.deduction_template_id
                   and ds.payee_entity =
                       dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                   and ds.payee_key = m.person_id
                   and dtt.deduction_type = 'F'
                   and m.member_id = %MEMBER_ID
                   and dtt.deduction_type = dtd.deduction_type
          		   and ds.stop_date is null
                   and dtd.stop_date is null                             
                   and ds.start_date = dtd.start_date)",,Member
345,Previous State,PREVIOUS_STATE,"select trim(to_char(nvl(sum(ath.old_value),0),'$999,999,990.00')) as prev_state
  from dbo.audit_trail_history ath
 where ath.attribute_id =
       dbo.pkg_benefit_s.f_get_attribute_id('DEDUCTION_AMT')
   and ath.entity_id =
       dbo.pkg_benefit_s.f_get_entity_id('DEDUCTION_TEMPLATE_DETAIL')
   and ath.key_value_1 in
       (select dtd.deduction_template_detail_id
                  from dbo.deduction_template_detail dtd,
                       dbo.deduction_template        dt,
                       dbo.disburse_schedule         ds,
                       dbo.deduction_type            dtt,
                       dbo.member                    m
                 where ds.payee_entity = dt.payee_entity_id
                   and ds.payee_key = dt.payee_key_value
                   and ds.source_entity =
                       nvl(dt.source_entity_id, ds.source_entity)
                   and ds.source_key =
                       nvl(dt.source_key_value, ds.source_key)
                   and dtd.deduction_template_id = dt.deduction_template_id
                   and ds.payee_entity =
                       dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                   and ds.payee_key = m.person_id
                   and dtt.deduction_type = 'ST'
                   and m.member_id = %MEMBER_ID
                   and dtt.deduction_type = dtd.deduction_type
          		   and ds.stop_date is null
                   and dtd.stop_date is null                             
                   and ds.start_date = dtd.start_date)",,Member
346,Previous Net,PREVIOUS_NET,"select trim(to_char(y.prev_net, '$999,999,990.00')) as previous_net
  from (select nvl(x.gross_amt, 0) - nvl(x.federal, 0) as prev_net
          from (select (select ath.old_value as gross_amt
                          from dbo.audit_trail_history ath
                         where ath.attribute_id =
                               dbo.pkg_benefit_s.f_get_attribute_id('GROSS_AMOUNT')
                           and ath.entity_id =
                               dbo.pkg_benefit_s.f_get_entity_id('DISBURSE_SCHEDULE')
                           and ath.key_value_1 in
                               (select disbursement_schedule_id
                                  from (select ds.disbursement_schedule_id
                                          from dbo.disburse_schedule ds,
                                               dbo.member            m
                                         where ds.payee_entity =
                                               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                                           and ds.payee_key = m.person_id
                                           and m.member_id = %MEMBER_ID
                                           and ds.stop_date is null
                                         order by ds.disbursement_schedule_id asc)
                                 where rownum = 1)) as gross_amt,
                       
                       (select sum(ath.old_value) as ded1
                          from dbo.audit_trail_history ath
                         where ath.attribute_id =
                               dbo.pkg_benefit_s.f_get_attribute_id('DEDUCTION_AMT')
                           and ath.entity_id =
                               dbo.pkg_benefit_s.f_get_entity_id('DEDUCTION_TEMPLATE_DETAIL')
                           and ath.key_value_1 in
                               (select dtd.deduction_template_detail_id
                                  from dbo.deduction_template_detail dtd,
                                       dbo.deduction_template        dt,
                                       dbo.disburse_schedule         ds,
                                       dbo.deduction_type            dtt,
                                       dbo.member                    m
                                 where ds.payee_entity = dt.payee_entity_id
                                   and ds.payee_key = dt.payee_key_value
                                   and ds.source_entity =
                                       nvl(dt.source_entity_id,
                                           ds.source_entity)
                                   and ds.source_key =
                                       nvl(dt.source_key_value, ds.source_key)
                                   and dtd.deduction_template_id =
                                       dt.deduction_template_id
                                   and ds.payee_entity =
                                       dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                                   and ds.payee_key = m.person_id
                                   and dtt.deduction_type in ('F','ST')
                                   and m.member_id = %MEMBER_ID
                                   and dtt.deduction_type = dtd.deduction_type
                           and ds.stop_date is null
                             and dtd.stop_date is null                                             
                                   and ds.start_date = dtd.start_date)) as federal
                  from dual) x) y",,Member
508,CAInfo,CAInfo,"select pb.application_id,
       trim(case b.entity_id
              when dbo.pkg_benefit_s.f_get_entity_id('PERSON') then
               (select p.prefix ||' ' ||
                       decode(p.first_name,
                              Null,
                              '',
                              ' ' || p.first_name) ||

                       decode(p.middle_name,
                              Null,
                              '',
                              ' ' || p.middle_name) ||
                       decode(p.last_name,
                              Null,
                              '',
                              ' ' || p.last_name )

                             || decode(p.suffix,
                              Null,
                              '',
                              ' ' || p.suffix )
                  from dbo.person p
                 where p.person_id = b.key_value)
              when dbo.pkg_benefit_s.f_get_entity_id('EMPLOYER') then
               (select e.sort_name
                  from dbo.employer e
                 where e.employer_id = b.key_value)
              when dbo.pkg_benefit_s.f_get_entity_id('OI_ORGANIZATION') then
               (select oi_name
                  from dbo.oi_organization oo
                 where oo.oi_organization_id = b.key_value)
              else
               null
            end) name
  from dbo.beneficiary         b,
       dbo.person              p,
       dbo.member              m,
       dbo.beneficiary_type    bt,
       dbo.pension_beneficiary pb
 where m.person_id = p.person_id
   and p.person_id = b.person_id
   and b.percent = 100
   and b.beneficiary_type_id = bt.beneficiary_type_id
   and bt.beneficiary_type_code = 'Primary'
   and pb.alt_beneficiary_id = b.alt_beneficiary_id
   and pb.application_id = %PENSION_APPLICATION_ID",116,Member
598,Member Address City State Zip,MEMBER_ADDRESS_CITY_ST_ZIP,"SELECT TRIM(UPPER(a.city) || ' ' || UPPER(a.state) || ' ' ||
            dbo.pkg_benefit_s.f_build_zipcode(a.zip)) AS city_state_line
  FROM dbo.addresses a, dbo.member m
 WHERE m.member_id = %MEMBER_ID
   AND a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                   m.person_id,
                                                   NULL,
                                                   'C,R')",,Member
599,Member Salutation,PAYEE_SALUTATION,"SELECT TRIM(payee_first_last_name || ':')
  FROM (SELECT NVL2(p.first_name, UPPER(p.first_name) || ' ', '') ||
               UPPER(p.last_name) AS payee_first_last_name
          FROM dbo.person p, dbo.member m
         WHERE m.person_id = p.person_id
           AND m.member_id = %MEMBER_ID)",,Member
512,MemberPensionOpt6Amt,MemberPensionOpt6Amt,"SELECT TRIM(to_char(NVL(client.pkg_client_functions.f_get_pension_formuale_value(pa.application_id,
                                                                                  'PN_MEM_TAXABLE_GROSS',
                                                                                  pa.pension_option_id),
                         0),
                     '$999,999,990.99PR')) AS Option6Amt
   FROM dbo.pension_application pa
  WHERE pa.application_id = %PENSION_APPLICATION_ID
",116,Member
513,MemberPensionOpt2Amt,MemberPensionOpt2Amt,"SELECT TRIM(to_char(NVL(client.pkg_client_functions.f_get_pension_formuale_value(pa.application_id,
                                                                            'PN_WIN_OP_2_REGULAR',
                                                                            pa.pension_option_id),
                   0),
               '$999,999,990.99PR')) AS Option2Amt
  FROM dbo.pension_application pa
 WHERE pa.application_id = %PENSION_APPLICATION_ID",116,Member
514,Deathdate,Deathdate,"select

 case b.entity_id
   when 254 then
    (select p.death_date as Death_date
       from dbo.person p
      where p.person_id = b.key_value)
   else
    null
 end Deathdate
  from dbo.beneficiary         b,
       dbo.person              p,
       dbo.member              m,
       dbo.beneficiary_type    bt,
       dbo.pension_beneficiary pb
 where m.person_id = p.person_id
   and p.person_id = b.person_id
   and b.percent = 100
   and b.beneficiary_type_id = bt.beneficiary_type_id
   and bt.beneficiary_type_code = 'Primary'
   and pb.alt_beneficiary_id = b.alt_beneficiary_id
   and pb.application_id = %PENSION_APPLICATION_ID",116,Member
410,Disability Check,DISABILITY_CHECK,"select nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_DISABILITY'),'N') from dual",,Member
507,Outdated_Warrant_Amt1,OUTDATED_WARRANT_AMOUNT1,"select trim(to_char(amount, '999,999,990.00')) as Outdated_Warrant_Amt1
  from (select lead(d.disbursement_date, 0, null) over(order by d.disbursement_id desc) as warrant,
               lead(d.check_eft_no, 0, null) over(order by d.disbursement_id desc) as check_no,
               lead(d.disbursement_amt, 0, 0) over(order by d.disbursement_id desc) as amount,
               d.disbursement_id
          from dbo.disbursement d, dbo.v_member_q m
         where d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = m.person_id
           and m.member_id = %MEMBER_ID
           and d.disbursement_status = 'ST'
           and d.disbursement_type = 'C'
         order by d.disbursement_id desc)
 where rownum = 1",,Member
517,IPERS logo Full Image,IPERS_LOGO_OLD,"select fpd.page_image,
            13 as x_scale,
            6                   as y_scale
 from imaging.form_page_definition fpd
 inner join imaging.form_definition fd on fpd.form_definition_id = fd.form_definition_id
 where fd.internal_name = 'IPERS_LOGO'",,Pension
518,CA Percentage,CA_PERCENTAGE,"select trunc(replace(TRIM(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_4_CA_PERCENT_PCT')),'%','')) from dual",,Member
317,FEDERAL_WITHHOLDING,FEDERAL_WITHHOLDING,"select ((select nvl(pfv.value, 0)
          from dbo.pension_formula_value pfv, dbo.pension_application pa
         where pfv.application_id = %PENSION_APPLICATION_ID 
           and pfv.business_rule_id =
               (select br.business_rule_id
                  from dbo.business_rule br
                 where br.internal_name = 'PN_MEM_TAXABLE_GROSS')
           and pfv.pension_option_id = pa.pension_option_id
           and pfv.application_id = pa.application_id) -
       (select nvl(pfv.value, 0)
          from dbo.pension_formula_value pfv
              ,dbo.pension_application pa
         where pfv.application_id = %PENSION_APPLICATION_ID
           and pfv.business_rule_id =
               (select br.business_rule_id
                  from dbo.business_rule br
                 where br.internal_name = 'PN_FED_NON_TAXABLE')
           and pfv.pension_option_id = pa.pension_option_id
           and pfv.application_id = pa.application_id)) * 0.2 as result
  from dual",,Pension
318,STATE_WITHHOLDING,STATE_WITHHOLDING,"select ((select nvl(pfv.value, 0)
          from dbo.pension_formula_value pfv, dbo.pension_application pa
         where pfv.application_id = %PENSION_APPLICATION_ID 
           and pfv.business_rule_id =
               (select br.business_rule_id
                  from dbo.business_rule br
                 where br.internal_name = 'PN_MEM_TAXABLE_GROSS')
           and pfv.pension_option_id = pa.pension_option_id
           and pfv.application_id = pa.application_id) -
       (select nvl(pfv.value, 0)
          from dbo.pension_formula_value pfv
              ,dbo.pension_application pa
         where pfv.application_id = %PENSION_APPLICATION_ID 
           and pfv.business_rule_id =
               (select br.business_rule_id
                  from dbo.business_rule br
                 where br.internal_name = 'PN_STATE_NON_TAXABLE')
           and pfv.pension_option_id = pa.pension_option_id
           and pfv.application_id = pa.application_id)) * 0.05 as result
  from dual",,Pension
319,LUMPSUM_REFUND_AMOUNT,LUMPSUM_REFUND_AMOUNT,"select (select nvl(pfv.value, 0)
          from dbo.pension_formula_value pfv, dbo.pension_application pa
         where pfv.application_id = %PENSION_APPLICATION_ID 
           and pfv.business_rule_id =
               (select br.business_rule_id
                  from dbo.business_rule br
                 where br.internal_name = 'PN_MEM_TAXABLE_GROSS')
           and pfv.pension_option_id = pa.pension_option_id
           and pfv.application_id = pa.application_id) as result from dual",,Pension
320,TAXABLE_ROLLOVER_AMT,TAXABLE_ROLLOVER_AMT,"select (select nvl(pfv.value, 0)
          from dbo.pension_formula_value pfv, dbo.pension_application pa
         where pfv.application_id = %PENSION_APPLICATION_ID 
           and pfv.business_rule_id =
               (select br.business_rule_id
                  from dbo.business_rule br
                 where br.internal_name = 'PN_STATE_TAXABLE_NON_RMD')
           and pfv.pension_option_id = pa.pension_option_id
           and pfv.application_id = pa.application_id) +
       (select nvl(pfv.value, 0)
          from dbo.pension_formula_value pfv
              ,dbo.pension_application pa
         where pfv.application_id = %PENSION_APPLICATION_ID 
           and pfv.business_rule_id =
               (select br.business_rule_id
                  from dbo.business_rule br
                 where br.internal_name = 'PN_FEDERAL_TAXABLE_NON_RMD')
           and pfv.pension_option_id = pa.pension_option_id
           and pfv.application_id = pa.application_id) as result
  from dual",,Pension
321,NON_TAXABLE_ROLLOVER_AMT,NON_TAXABLE_ROLLOVER_AMT,"select (select nvl(pfv.value, 0)
          from dbo.pension_formula_value pfv, dbo.pension_application pa
         where pfv.application_id = %PENSION_APPLICATION_ID 
           and pfv.business_rule_id =
               (select br.business_rule_id
                  from dbo.business_rule br
                 where br.internal_name = 'PN_STATE_NON_TAXABLE_NON_RMD')
           and pfv.pension_option_id = pa.pension_option_id
           and pfv.application_id = pa.application_id) +
       (select nvl(pfv.value, 0)
          from dbo.pension_formula_value pfv
              ,dbo.pension_application pa
         where pfv.application_id = %PENSION_APPLICATION_ID
           and pfv.business_rule_id =
               (select br.business_rule_id
                  from dbo.business_rule br
                 where br.internal_name = 'PN_FEDERAL_NON_TAXABLE_NON_RMD')
           and pfv.pension_option_id = pa.pension_option_id
           and pfv.application_id = pa.application_id) as result
  from dual",,Pension
519,Beneficiary Summary Months,BEN_SUMMARY_MONTHS,"Select Amount_01 as Current_Month,
       Amount_02 as Next_Month
       from table(client.f_get_ben_summary_months(%PENSION_APPLICATION_ID))",,Pension
520,FME Year,FME_YEAR,"select to_date(client.pkg_client_functions.f_get_pension_formuale_value(%PENSION_APPLICATION_ID,'PN_FME'),'mm/dd/yyyy') from dual",,Pension
322,RMD_AMOUNT,RMD_AMOUNT,"select (select nvl(pfv.value, 0)
          from dbo.pension_formula_value pfv, dbo.pension_application pa
         where pfv.application_id = %PENSION_APPLICATION_ID 
           and pfv.business_rule_id =
               (select br.business_rule_id
                  from dbo.business_rule br
                 where br.internal_name = 'PN_RMD_ACTIVE')
           and pfv.pension_option_id = pa.pension_option_id
           and pfv.application_id = pa.application_id) as result from dual",,Pension
323,MONTLY_ANNUITY_INCREASE,MONTLY_ANNUITY_INCREASE,"select (select nvl(pfv.value, 0)
          from dbo.pension_formula_value pfv, dbo.pension_application pa
         where pfv.application_id = %PENSION_APPLICATION_ID 
           and pfv.business_rule_id =
               (select br.business_rule_id
                  from dbo.business_rule br
                 where br.internal_name = 'PN_MONTHLY_GROSS')
           and pfv.pension_option_id = pa.pension_option_id
           and pfv.application_id = pa.application_id) as result from dual",,Pension
395,Total Quartely Service Credit,TOT_QUAR_SER_CREDIT,"select client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_QTR_REG')
                                                            + client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_QTR_OCC')
                                                            + client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_QTR_SC')from dual",,Member
389,Service Purchase Amount,SERVICE_PURCHASE_AMOUNT,"select balance_due
  from (select '$' || trim(to_char(nvl(t.balance_due, 0), '999,999,990.00')) as balance_due
          from dbo.transaction t
         where t.ref_entity_1 =
               dbo.pkg_benefit_s.f_get_entity_id('SERVICE_CREDIT_PURCHASE')
           and t.ref_key_1 =
               (select service_credit_purchase_id
                  from (select scp.service_credit_purchase_id
                          from dbo.service_credit_purchase scp,
                               dbo.part_account            pa
                         where scp.scp_type_status_id in
                               (select sts.scp_type_status_id
                                  from dbo.scp_type_status sts,
                                       dbo.scp_status      ss
                                 where sts.scp_status_id = ss.scp_status_id
                                   and ss.internal_name <> 'REFUNDED')
                           and scp.part_account_id = pa.part_account_id
                           and pa.member_id = %MEMBER_ID
                         order by 1 desc)
                 where rownum = 1)
           and t.trans_type = 'SI'
         order by t.inserted_date desc)
 where rownum = 1",,Member
390,Child Support Agency Name,CHILD_SUPPORT_AGENCY_NAME,"select case
         when bek.key_role_indicator like 'Other%' then
          bek.key_name
         else
          nvl2(p.first_name, upper(p.first_name) || ' ', '') ||
          nvl2(p.middle_name, upper(p.middle_name) || ' ', '') ||
          upper(p.last_name)
       end as name
  from dbo.court_order         co,
       dbo.court_order_type    cot,
       dbo.business_entity_key bek,
       dbo.person              p
 where cot.court_order_type_id = co.court_order_type_id
   and cot.internal_name in ('CHILD_SUPPORT')
   and co.payor_business_entity_key_id = %MEMBER_ID
   and bek.business_entity_key_id = co.payee_business_entity_key_id
   and p.person_id(+) = bek.key_value",,Member
397,EFT SSD,EFT_SS,"Select BANK_NAME, ROUTING_NO, ACCOUNT_TYPE, APPROVAL_STATUS, ACCOUNT_NO from (select ea.bank_name Bank_Name,
       lpad(ea.routing_no,9,'0') Routing_No,
       decode(ea.recipient_account_type, 'C', 'checking', 'S', 'savings') as Account_Type,
       ea.eft_approval_status Approval_Status,
       eah.start_date,
       ea.recipient_account_no ACCOUNT_NO
  from dbo.eft_authorization        ea,
       dbo.eft_authorization_header eah,
       dbo.benefit_account          ba
 where ea.eft_authorization_header_id = eah.eft_authorization_header_id
   and eah.source_entity_id = dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
   and eah.source_key_value = %PENSION_APPLICATION_ID
   and ea.eft_approval_status = 'A'
   and (eah.end_date is null or to_char(eah.end_date, 'mm/dd/yyyy') >
       to_char(sysdate, 'mm/dd/yyyy'))
   and ea.benefit_account_id = ba.benefit_account_id
   and ba.benefit_type in ('SI', 'SD','RG')
 order by eah.start_date desc) where rownum=1",,Member
558,Outdated_Warrant_1,OUTDATED_WARRENT_1,"select check_no as Outdated_Warrant_Number1,
       to_char(warrant, 'mm/dd/yyyy') as Outdated_Warrant_Issue_Date1,
       trim(to_char(amount, '999,999,990.00')) as Outdated_Warrant_Amt1
  from (select lead(disb.disbursement_date, 0, null) over(order by disb.disbursement_id desc) as warrant,
               lead(disb.check_eft_no, 0, null) over(order by disb.disbursement_id desc) as check_no,
               lead(disb.disbursement_amt, 0, 0) over(order by disb.disbursement_id desc) as amount
          from dbo.disbursement         disb,
               dbo.disbursement_request dr
         where dr.member_id = %MEMBER_ID
           and dr.disbursement_id = disb.disbursement_id
           and disb.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and disb.recipient_key_value = NVL(%PERSON_ID,disb.recipient_key_value)
           and disb.disbursement_status = 'ST'
           and disb.disbursement_type = 'C')
 where rownum = 1",,Member
559,Outdated_Warrant_2,OUTDATED_WARRENT_2,"select check_no as Outdated_Warrant_Number2,
       to_char(warrant, 'mm/dd/yyyy') as Outdated_Warrant_Issue_Date2,
       trim(to_char(amount, '999,999,990.00')) as Outdated_Warrant_Amt2
  from (select lead(disb.disbursement_date, 1, null) over(order by disb.disbursement_id desc) as warrant,
               lead(disb.check_eft_no, 1, null) over(order by disb.disbursement_id desc) as check_no,
               lead(disb.disbursement_amt, 1, 0) over(order by disb.disbursement_id desc) as amount
          from dbo.disbursement         disb,
               dbo.disbursement_request dr
         where dr.member_id = %MEMBER_ID
           and dr.disbursement_id = disb.disbursement_id
           and disb.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and disb.recipient_key_value = NVL(%PERSON_ID,disb.recipient_key_value)
           and disb.disbursement_status = 'ST'
           and disb.disbursement_type = 'C')
 where rownum = 1",,Member
560,Outdated_Warrant_3,OUTDATED_WARRENT_3,"select check_no as Outdated_Warrant_Number3,
       to_char(warrant, 'mm/dd/yyyy') as Outdated_Warrant_Issue_Date3,
       trim(to_char(amount, '999,999,990.00')) as Outdated_Warrant_Amt3
  from (select lead(disb.disbursement_date, 2, null) over(order by disb.disbursement_id desc) as warrant,
               lead(disb.check_eft_no, 2, null) over(order by disb.disbursement_id desc) as check_no,
               lead(disb.disbursement_amt, 2, 0) over(order by disb.disbursement_id desc) as amount
          from dbo.disbursement         disb,
               dbo.disbursement_request dr
         where dr.member_id = %MEMBER_ID
           and dr.disbursement_id = disb.disbursement_id
           and disb.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and disb.recipient_key_value = NVL(%PERSON_ID,disb.recipient_key_value)
           and disb.disbursement_status = 'ST'
           and disb.disbursement_type = 'C')
 where rownum = 1",,Member
329,Disability FME,DISABILITY_FME,"select trim(to_char(to_date(vpfv.value,'MM/DD/YYYY'),'MM/YYYY')) as Dis_FME
  from dbo.v_pension_formula_value vpfv
 where vpfv.business_rule_internal_name = 'PN_FME'
   and vpfv.application_id = %PENSION_APPLICATION_ID and rownum=1",,Pension
331,CURRENT BENEFIT AMOUNT,CURRENT_BENEFIT_AMOUNT,"select '$' || trim(to_char(nvl(vpfv.value, 0), '999,999,990.00')) as current_benefit_amount
  from dbo.v_pension_formula_value vpfv
 where vpfv.business_rule_internal_name = 'PN_MEM_TAXABLE_GROSS'
   and vpfv.application_id = %PENSION_APPLICATION_ID",,Pension
332,NEW BENEFIT AMOUNT,NEW_BENEFIT_AMOUNT,"select '$' || trim(to_char(nvl(vpfv.value, 0), '999,999,990.00')) as new_benefit_amount
  from dbo.v_pension_formula_value vpfv
 where vpfv.business_rule_internal_name = 'PN_MEM_TAXABLE_GROSS'
   and vpfv.application_id =
       (select max(q.application_id)
          from dbo.v_pension_application_q q , dbo.pension_type pt
         where q.member_id = %MEMBER_ID
           and q.pension_type_id = pt.pension_type_id
           and pt.pension_type_code = 'IPREGDIS')",,Pension
394,Total Overpayment Amount For Cond,TOTAL_OVERPAYMENT_AMOUNT_FOR_COND,"select nvl((select trim(sum(o.total_overpayment_amount))
         											from dbo.overpayment o, dbo.overpayment_detail od
         											where o.overpayment_id = od.overpayment_id
         											and od.source_key_value = %PENSION_APPLICATION_ID),0)from dual",,Member
157,User Information (IPERS),USER_INFO_IPERS,"select dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                 p.prefix,
                                                 'Y',
                                                 'N') Prefix,
       dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                 p.Suffix,
                                                 'Y',
                                                 'N') Suffix,
       CASE
         WHEN trim(p.first_name) = 'EXEBATCH' THEN
          'IPERS Benefits Staff.'
         ELSE
          TRIM(p.first_name)
       END first_name,
       trim(p.middle_name) as middle_name,
       CASE
         WHEN trim(p.last_name) = 'EXEBATCH' THEN
          ''
         ELSE
          TRIM(p.last_name)
       END as last_name,
       trim(su.user_name) as user_name,
       client.f_get_security_role(%SECURITY_USERS_ID) Title,
       a.char_phone_2 work_phone,
       A.e_Mail,
       a.phone_ext_2
  from dbo.security_users su
  left outer join dbo.person p
    on (p.person_id = su.person_id)
  left outer join dbo.addresses a
    on (a.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON') and
       a.key_value = p.person_id and a.address_type = 'R' and
       (sysdate between a.start_date and nvl(a.stop_date, sysdate)))
 where su.security_users_id = %SECURITY_USERS_ID",,Employer
347,Next Net,NEXT_NET,"select trim(to_char(amount, '$999,999,990.00'))
  from (select nvl((select a.gross_amount
                     from (select ds.gross_amount,
                                  ds.disbursement_schedule_id
                             from dbo.disburse_schedule ds, dbo.member m
                            where ds.payee_entity =
                                  dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                              and ds.payee_key = m.person_id
                              and m.member_id = %MEMBER_ID
                              and ds.stop_date is null
                            order by ds.disbursement_schedule_id desc) a
                    where rownum = 1),
                   0) - nvl((select sum(dtd.deduction_amt)
                              from dbo.deduction_template_detail dtd,
                                   dbo.deduction_template        dt,
                                   dbo.disburse_schedule         ds,
                                   dbo.member                    m
                             where ds.payee_entity = dt.payee_entity_id
                               and ds.payee_key = dt.payee_key_value
                               and ds.source_entity =
                                   nvl(dt.source_entity_id, ds.source_entity)
                               and ds.source_key =
                                   nvl(dt.source_key_value, ds.source_key)
                               and dtd.deduction_template_id =
                                   dt.deduction_template_id
                               and ds.payee_entity =
                                   dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                               and ds.payee_key = m.person_id
                               and m.member_id = %MEMBER_ID
                               and ds.start_date = dtd.start_date
                               and ds.stop_date is null
                               and dtd.stop_date is null),
                            0) as amount
          from dual) x

                                     ",,Member
348,Next Federal,NEXT_FEDERAL,"select 
                                     TRIM(TO_CHAR(client.pkg_ipers_disb.f_get_deduction_est_value(ds.disbursement_schedule_id,
                                                       'F'),'$999,999,990.00'))
                                                         from dbo.disburse_schedule ds
                                                          where ds.source_key = %PENSION_APPLICATION_ID
                                                          and trunc(sysdate) between ds.start_date and
                                                                 nvl(ds.stop_date, trunc(sysdate))",,Member
349,Next State,NEXT_STATE,"select 
                                     TRIM(TO_CHAR(client.pkg_ipers_disb.f_get_deduction_est_value(ds.disbursement_schedule_id,
                                                       'ST'),'$999,999,990.00'))
                                                         from dbo.disburse_schedule ds
                                                          where ds.source_key = %PENSION_APPLICATION_ID
                                                          and trunc(sysdate) between ds.start_date and
                                                                 nvl(ds.stop_date, trunc(sysdate))",,Member
350,Outdated_Warrant_Grid,OUTDATED_WARRANT_GRID,"select to_char(d.check_eft_no) warrant_number, '09-0791-553-4410-4612' state_accounting_number
, to_char(d.disbursement_date,'mm/dd/yyyy') issue_date, '$'||trim(to_char(d.disbursement_amt, '999,990.00')) warrant_amount
  from dbo.v_member_q m join dbo.disbursement d on d.recipient_key_value = m.person_id
  where m.member_id = %MEMBER_ID and d.recipient_entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
  and d.disbursement_status = 'ST' and d.disbursement_type = 'C' order by d.disbursement_date",,Member
351,Contact Complete Info,CONTACT_COMPLETE_INFO,"select ltrim(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                 P.PREFIX,
                                                 'Y',
                                                 'N') || ' ' ||
       (P.FIRST_NAME) || ' ' || (p.middle_name) || ' ' || (p.last_name) || ' ' ||
       dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                 P.SUFFIX,
                                                 'Y',
                                                 'N')) as contact_name, 
        p.last_name  as contact_last_name,
        p.first_name as contact_first_name,
        upper(a.address_1),
        upper(a.address_2),
        upper(a.address_3),
        upper(a.city),
        upper(a.state),
        dbo.pkg_benefit_s.f_build_zipcode(zip) as zip,
        a.e_mail as email,
        e.employer_code as emp_id,
        e.employer_name as employer_name
  from dbo.business_entity_relation ber,
       dbo.business_entity_key bek,
       dbo.oi_person oip,
       dbo.person p,
       dbo.addresses a,
       dbo.employer e
 where ber.entity_id = dbo.pkg_benefit_s.f_get_entity_id('EMPLOYER')
   and ber.key_value = e.employer_id
   and ber.business_entity_key_id = bek.business_entity_key_id
   and bek.key_value = oip.oi_person_id 
   and oip.person_id = p.person_id
   and p.person_id = %PERSON_ID
   and a.entity_id(+) =  dbo.pkg_benefit_s.f_get_entity_id('OI_PERSON') 
   and a.key_value(+) = oip.oi_person_id
   and a.start_date(+) <= trunc(sysdate) 
   and nvl(a.stop_date, trunc(sysdate)) >= trunc(sysdate) 
   and a.address_period(+) = 'P'",,Employer
330,PENSION OPTION,PEN_OPTION,"select q.pension_option_description as pen_option
  from dbo.v_pension_application_q q
 where q.application_id = %PENSION_APPLICATION_ID",,Pension
60,Person Information,PERSON_INFO,"select rtrim(dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') ||' '|| (P.FIRST_NAME) ||' '||  
                                   NVL2(P.MIDDLE_NAME, p.middle_name ||' ', p.middle_name) || (p.last_name) || ' ' || 
                                   dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N')) as memberName,
                                   dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') as prefix, 
                                   (p.first_name) as firstName, (p.middle_name) as middleName, (p.last_name) as lastName, 
                                   dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N') as suffix, 
                                   TO_CHAR(p.birth_date ,'MM/DD/YYYY') as birthDate, p.sex as sex, p.alt_identifier as altId, 
                                   p.status as status, REPLACE(TO_CHAR(p.ssn,'000,99,9999'),',','-') as ssn, 
                                   dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') ||' '|| (P.FIRST_NAME) ||' '||  NVL2(P.MIDDLE_NAME, p.middle_name ||' ', p.middle_name) || (p.last_name) || 
                                   NVL2(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N'),  dbo.pkg_benefit_s.f_get_value_description('SUFFIX',' '||P.SUFFIX,'Y','N'), 
                                   rtrim(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N'))) || ',' as MEMBER_NAME_COMMA, 
                                   dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N') ||' '|| (P.FIRST_NAME) ||' '||  NVL2(P.MIDDLE_NAME, p.middle_name ||' ', p.middle_name) || (p.last_name) || 
                                   NVL2(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N'),  dbo.pkg_benefit_s.f_get_value_description('SUFFIX',' '||P.SUFFIX,'Y','N'), 
                                   rtrim(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N'))) || ' as MEMBER_NAME_APS f
                                   from dbo.person p where p.person_id = NVL(%DEPENDENT_ID,%PERSON_ID)",,Member
377,OverPayment Reduction Amount,OVERPMT_REDUCTION_AMT,"select trim(to_number(max(f.rate_value_01)) * 100)
  from dbo.factor_definition fd, dbo.factor f
 where f.lookup_value_02 is null
   and f.factor_id = fd.factor_id
   and fd.factor_name like 'RE_EMPLOYED_EARNINGS_LIMIT_REDUCTION_TABLE'",,Member
391,Child Support Agency Address,CHILD_SUPPORT_AGENCY_ADDRESS,"select address
  from (select decode(a.address_1, null, '', upper(a.address_1)) ||
               decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
               decode(a.address_3, null, '', chr(10) || upper(a.address_3)) ||
               chr(10) || upper(a.city) || ' ' || upper(a.state) || ' ' ||
               dbo.pkg_benefit_s.f_build_zipcode(a.zip) as address
          from dbo.court_order         co,
               dbo.court_order_type    cot,
               dbo.business_entity_key bek,
               dbo.addresses           a
         where cot.court_order_type_id = co.court_order_type_id
           and cot.internal_name in ('CHILD_SUPPORT')
           and co.payor_business_entity_key_id = %MEMBER_ID
           and bek.business_entity_key_id = co.payee_business_entity_key_id
           and a.key_value = bek.key_value
           and a.address_type in ('C', 'R')
           and a.stop_date is null
         order by a.address_type asc)
 where rownum = 1",,Member
392,IRS Agency Name,IRS_AGENCY_NAME,"select case
         when bek.key_role_indicator like 'Other%' then
          bek.key_name
         else
          nvl2(p.first_name, upper(p.first_name) || ' ', '') ||
          nvl2(p.middle_name, upper(p.middle_name) || ' ', '') ||
          upper(p.last_name)
       end as name
  from dbo.court_order         co,
       dbo.court_order_type    cot,
       dbo.business_entity_key bek,
       dbo.person              p
 where cot.court_order_type_id = co.court_order_type_id
   and cot.internal_name in ('IRS_LEVY')
   and co.payor_business_entity_key_id = %MEMBER_ID
   and bek.business_entity_key_id = co.payee_business_entity_key_id
   and p.person_id(+) = bek.key_value",,Member
393,IRS Agency Address,IRS_AGENCY_ADDRESS,"select address
  from (select decode(a.address_1, null, '', upper(a.address_1)) ||
               decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
               decode(a.address_3, null, '', chr(10) || upper(a.address_3)) ||
               chr(10) || upper(a.city) || ' ' || upper(a.state) || ' ' ||
               dbo.pkg_benefit_s.f_build_zipcode(a.zip) as address
          from dbo.court_order         co,
               dbo.court_order_type    cot,
               dbo.business_entity_key bek,
               dbo.addresses           a
         where cot.court_order_type_id = co.court_order_type_id
           and cot.internal_name in ('IRS_LEVY')
           and co.payor_business_entity_key_id = %MEMBER_ID
           and bek.business_entity_key_id = co.payee_business_entity_key_id
           and a.key_value = bek.key_value
           and a.address_type in ('C', 'R')
           and a.stop_date is null
         order by a.address_type asc)
 where rownum = 1",,Member
398,EFT IPERSRET,EFT_IPERSRET,"Select BANK_NAME, ROUTING_NO, ACCOUNT_TYPE, APPROVAL_STATUS, ACCOUNT_NO from (select ea.bank_name Bank_Name,
       lpad(ea.routing_no,9,'0') Routing_No,
       decode(ea.recipient_account_type, 'C', 'checking', 'S', 'savings') as Account_Type,
       ea.eft_approval_status Approval_Status,
       eah.start_date,
       ea.recipient_account_no as ACCOUNT_NO
  from dbo.eft_authorization        ea,
       dbo.eft_authorization_header eah,
       dbo.benefit_account          ba
 where ea.eft_authorization_header_id = eah.eft_authorization_header_id
   and eah.source_entity_id = dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
   and eah.source_key_value = %PENSION_APPLICATION_ID
   and ea.eft_approval_status = 'A'
   and (eah.end_date is null or to_char(eah.end_date, 'mm/dd/yyyy') >
       to_char(sysdate, 'mm/dd/yyyy'))
   and ea.benefit_account_id = ba.benefit_account_id
  -- and ba.benefit_type in ('SS', 'MP','RG') --sv1
 order by eah.start_date desc) where rownum=1",,Member
382,Benefits_Expiry_RRet,BENEFITS_EXPIRY_RRET,"SELECT ADD_MONTHS(A.DATE1, nvl(B.NUM,0))
  FROM (select trunc(to_date(max(substr(ds.explanation, 1, 10)),
                             'mm/dd/yyyy')) DATE1,
               DS.INSURED_ID
          from dbo.disburse_schedule ds, dbo.benefit_account ba
         where ds.source_entity =
               dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
           and ds.source_key = %PENSION_APPLICATION_ID
           and ds.benefit_account_id = ba.benefit_account_id
           and ba.benefit_type in ('SS', 'MP')
         GROUP BY DS.INSURED_ID) A,
       
       (Select max(dv.value) NUM, DV.NUM_KEY_VALUE
          from dbo.datasheet_value dv
         where dv.datasheet_id =
               dbo.pkg_benefit_ds.f_get_datasheet_id('OPTION_5_PAYMENTS')
           and dv.attribute_id =
               dbo.pkg_benefit_s.f_get_attribute_id('DS_PAYMENTS_REMAINING')
           and dv.key_value = to_char(%MEMBER_ID)
           group by DV.NUM_KEY_VALUE) B
 WHERE A.INSURED_ID = B.NUM_KEY_VALUE(+)",,Member
399,Winning Option 2 Amt,WIN_OPTION_2,"select trim(decode(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_MP_ELIGIBLE'),
                                                  'Y',
                                                  client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2_MP'),
                                                  client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2')))
                                                  from dual",,Member
400,FME,FME," select trim(to_char(to_date(vpfv.value,'MM/DD/YYYY'),'Month'))||' '||trim(to_char(to_date(vpfv.value,'MM/DD/YYYY'),'YYYY')) as FME
  													from dbo.v_pension_formula_value vpfv
 													where vpfv.business_rule_internal_name = 'PN_FME'
   													and vpfv.application_id = %PENSION_APPLICATION_ID and rownum=1",,Member
401,Opt1 DB Block Cond,OPT1_DB_BLOCK,"select case
                                               when replace(RetDBen, ',', '') > nvl(RegDBen, 0) then
                                               'Y'
                                               else
                                               'N'
                                               end as OPTION1_DB,
       case
         when to_number(RetDBen, '999990.00') > 0 then
          'Y'
         else
          'N'
       end as OPTION1_DB_NEW
                                               from (select client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_OP1_DEATH_BENE') as RetDBen,
                                               client.f_get_pfv_value((select pa.parent_application_id
                                        from dbo.pension_application pa
                                       where pa.application_id = %PENSION_APPLICATION_ID),
                                      'PN_OP1_DEATH_BENE') as RegDBen
                                      from dual)",,Member
402,EFT_INFORMATION,EFT_INFORMATION,"select lpad(efta.routing_no, 9, '0') as routing_no ,
                              decode(nvl(efta.recipient_account_type,'C'),'C','checking','S','savings') as account_type,
                              TRIM(efta.recipient_account_no),
                              efta.eft_approval_status as Approval_Status
                               from dbo.eft_authorization efta, dbo.eft_authorization_header efth 
                              where efta.eft_authorization_header_id = efth.eft_authorization_header_id
                              and efth.source_entity_id = dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                              and efth.source_key_value = %PENSION_APPLICATION_ID
                              and efta.eft_approval_status ='A'",,Member
403,Institution Name Power Expired,INSTITUTION_NAME_PE,"select INSTITUTION, ROLE, SEQ_NO
  from (select max(decode(a.attribute_name,
                          'DS_MC_INSTITUTION_NAME',
                          dv.value,
                          null)) as INSTITUTION,
               max(decode(a.attribute_name,
                          'DS_MC_CONTACT_ROLE',
                          dv.value,
                          null)) as ROLE,
               max(decode(a.attribute_name,
                          'DS_MC_STOP_DATE',
                          (dv.value),
                          null)) as STOP_DATE,
               dv.key_value,
               dv.instance_id,
               dvi.description,
               dv.seq_no
          from dbo.datasheet_value          dv,
               dbo.attribute                a,
               dbo.datasheet_attribute      da,
               dbo.datasheet_value_instance dvi
         where dv.attribute_id = a.attribute_id
           and da.datasheet_id =
               dbo.pkg_benefit_ds.f_get_datasheet_id('DS_MEMBER_CONTACTS')
           and da.attribute_id = dv.attribute_id
           and dv.instance_id = dvi.instance_id(+)
           and dv.key_value = to_char(%MEMBER_ID)
         group by dv.key_value, dv.instance_id, dvi.description, dv.seq_no) x
 where to_char(to_date(x.stop_date, 'MMddyyyy'), 'MM/dd/yyyy') =
       to_char(sysdate, 'MM/dd/yyyy') and x.institution is not null",,Member
404,Institution Name,INSTITUTION_NAME,"select INSTITUTION, ROLE, SEQ_NO
  from (select max(decode(a.attribute_name,
                          'DS_MC_INSTITUTION_NAME',
                          dv.value,
                          null)) as INSTITUTION,
               max(decode(a.attribute_name,
                          'DS_MC_CONTACT_ROLE',
                          dv.value,
                          null)) as ROLE,
               dv.key_value,
               dv.instance_id,
               dvi.description,
               dv.seq_no
          from dbo.datasheet_value          dv,
               dbo.attribute                a,
               dbo.datasheet_attribute      da,
               dbo.datasheet_value_instance dvi
         where dv.attribute_id = a.attribute_id
           and da.datasheet_id =
               dbo.pkg_benefit_ds.f_get_datasheet_id('DS_MEMBER_CONTACTS')
           and da.attribute_id = dv.attribute_id
           and dv.instance_id = dvi.instance_id(+)
           and dv.key_value = to_char(%MEMBER_ID)
         group by dv.key_value, dv.instance_id, dvi.description, dv.seq_no) x
          where x.institution is not null",,Member
405,Last Month,LAST_MONTH,"select trim(to_char(add_months(sysdate,-1), 'Month')) from dual",,Member
406,Member Pension New Option,MEMBER_PENSION_NEW_OPTION,"select trim(substr(pot.pension_option_type_desc,0,8))
  from dbo.pension_option_type pot,
       dbo.pension_option po,
       (select *
          from (select aa.old_value, aa.new_value
                  from dbo.audit_trail_history aa
                 where aa.entity_id =
                       dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                   and aa.attribute_id =
                       dbo.pkg_benefit_s.f_get_attribute_id('PENSION_OPTION_ID')
                   and aa.key_value_1 = %PENSION_APPLICATION_ID
                 order by aa.inserted_date desc)
         where rownum = 1) x
 where po.pension_option_type_id = pot.pension_option_type_id
   and po.pension_option_id = x.new_value",,Member
407,Member Pension Old Option,MEMBER_PENSION_OLD_OPTION,"select trim(substr(pot.pension_option_type_desc,0,8))
  from dbo.pension_option_type pot,
       dbo.pension_option po,
       (select *
          from (select aa.old_value, aa.new_value
                  from dbo.audit_trail_history aa
                 where aa.entity_id =
                       dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                   and aa.attribute_id =
                       dbo.pkg_benefit_s.f_get_attribute_id('PENSION_OPTION_ID')
                   and aa.key_value_1 = %PENSION_APPLICATION_ID
                 order by aa.inserted_date desc)
         where rownum = 1) x
 where po.pension_option_type_id = pot.pension_option_type_id
   and po.pension_option_id = x.old_value",,Member
408,Option 2,OPT2,"SELECT CASE
         WHEN nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_MP_ELIGIBLE'), 'N') = 'N' THEN
          nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2'), 0)
         ELSE
          nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2_MP'), 0)
       END option_2_Value,
       CASE
         WHEN nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_MP_ELIGIBLE'), 'N') = 'N' THEN         
          '$' || trim(to_char(NVL(client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,'PN_WIN_OP_2'),
                                  0) + NVL(client.f_get_pfv_value_number((Select pa.parent_application_id
                                                                           from dbo.pension_application pa
                                                                          where pa.application_id =
                                                                                %PENSION_APPLICATION_ID),
                                                                         'PN_WIN_OP_2_REGULAR'),0),'999,999,990.00'))
         ELSE
         '$' || trim(to_char(NVL(client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,'PN_WIN_OP_2_MP'),
                                  0) + NVL(client.f_get_pfv_value_number((Select pa.parent_application_id
                                                                           from dbo.pension_application pa
                                                                          where pa.application_id =
                                                                                %PENSION_APPLICATION_ID),
                                                                         'PN_WIN_OP_2_REGULAR'),0),'999,999,990.00'))
       
       END option_2_Value_1
  FROM dual",,Member
409,Winning Opt2 Amount SSD,SSD_WIN_OPT_2_AMT,"select trim(decode(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_MP_ELIGIBLE'),
                                                  'Y',
                                                  client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2_MP'),
                                                  client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2_REGULAR')))
                                                  from dual ",,Member
411,Option 6 CA Percent,OPT6_CA_PCT,"select TRIM(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_6_CA_PERCENT_PCT')) from dual",,Member
412,CA Block,CA_BLOCK,"select case
         when vo.pension_option_type_code in
              ('JSA100',
               'JSA75',
               'JSA50',
               'JSA25',
               'JSAP100',
               'JSAP75',
               'JSAP50',
               'JSAP25',                                             
               'LPJSA100',               
               'LPJSA75',
               'LPJSA50',
               'LPJSA25') then
          'Y'
         else
          'N'
       end
  from dbo.pension_application pa, dbo.v_pension_option vo
 where pa.pension_option_id = vo.pension_option_id
   and pa.application_id = %PENSION_APPLICATION_ID",,Member
413,Ben Block,BEN_BLOCK,"select case
         when vo.pension_option_type_code in
              ('ANFLS',
               'ANDLS',
               'AN120',
               'LPANFLS',
               'LPANDLS',
               'LPAN120') then
          'Y'
         else
          'N'
       end
  from dbo.pension_application pa, dbo.v_pension_option vo
 where pa.pension_option_id = vo.pension_option_id
   and pa.application_id = %PENSION_APPLICATION_ID",,Member
414,Benefit Summary Block SS New,BEN_SUMMARY_BLOCK_SS_NEW,"select Display_name as Descrip,
       Amount_01 as Last_Month,
       Amount_02 as Current_Month,
       Amount_03 as Next_Month
       from table(CLIENT.f_get_ss_ben_summary_block_new(%PENSION_APPLICATION_ID, %PERSON_ID))",,Member
416,Disburse Eft Check,DISBURSE_EFT_CHECK,"SELECT ea.bank_name,
                                                             ea.routing_no,
                                                              ea.recipient_account_no,
                                                               decode(nvl(ea.recipient_account_type,'C'),'C','Checkings','S','Savings') as ACCT_TYPE
                                                               FROM dbo.disburse_schedule ds,
                                                               dbo.eft_authorization_header eah,
                                                               dbo.eft_authorization ea
                                                               WHERE ds.source_entity = dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                                                               AND ds.source_key = %PENSION_APPLICATION_ID
                                                               AND ds.sched_status = 'A'
                                                               AND ds.payee_entity = ea.recipient_entity_id
                                                               AND ds.payee_key = ea.recipient_key_value
                                                               AND ds.benefit_account_id = ea.benefit_account_id
                                                               AND ea.eft_authorization_header_id = eah.eft_authorization_header_id
                                                               AND eah.source_entity_id = dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                                                               AND eah.source_key_value = %PENSION_APPLICATION_ID
                                                               AND ea.eft_approval_status = 'A'
                                                               AND ds.next_pay_date BETWEEN eah.start_date AND
                                                               nvl(eah.end_date, ds.next_pay_date)",,Member
352,Pension Application Member Address,PENSION_MEMBER_ADDRESS,"select a.address_1 as address_line_1,
       trim(nvl(a.address_2, '')) as address_line_2,
       trim(nvl(a.address_3, '')) as address_line_3,
       a.city || ' ' || a.state || ' ' ||
       dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_line,
       a.city as city,
       a.state as state,
       a.county as county,
       dbo.pkg_benefit_s.f_build_zipcode(a.zip) as zip_code,
       nvl(a.phone_1, '') as phone1,
       nvl(a.phone_2, '') as phone2,
       nvl(a.phone_3, '') as phone3,
       nvl(a.phone_4, '') as phone4,
       nvl(substr(a.char_phone_1, 1, 5) || ' ' ||
           substr(a.char_phone_1, 6, 13),
           '') as phone5,
       nvl(substr(a.char_phone_2, 1, 5) || ' ' ||
           substr(a.char_phone_2, 6, 13),
           '') as phone6
  from dbo.addresses a, dbo.member m, dbo.pension_application pa
 where pa.member_id = m.member_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                   m.person_id,
                                                   null,
                                                   'C,R')",,Pension
353,Member Adr,MEMBER_ADR,"select trim(a.address_1) as address_1,
        trim(a.address_2) as address_2,
        trim(a.address_3) as address_3,
        a.city || ' ' || a.state || ', ' ||
        dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_zip,
        decode(trim(a.address_3), null, null, trim(a.address_3) || chr(10)) ||
        trim(a.address_1) || chr(10) ||
        decode(trim(a.address_2), null, null, trim(a.address_2) || chr(10)) ||
        a.city || ' ' || a.state || ' ' ||
        dbo.pkg_benefit_s.f_build_zipcode(a.zip) as member_address,
        a.city as city,
        a.state as state,
        a.zip as zip
   from dbo.addresses a, dbo.v_member_q m
  where m.member_id = %MEMBER_ID
    and a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                    m.person_id,
                                                    'R')",85,Member
356,ADB Information,ADB_GENERIC_INFO,"select  
														%RELATIONSHIP RELATIONSHIP, 
														%MEMBER_ID MEMBER_ID, %BENEFICIARY_ID BENEFICIARY_ID, 
														%SECURITY_USER_NAME SECURITY_USER_NAME, %SECURITY_USER_TITLE SECURITY_USER_TITLE,
														%BENEFICIARY_NAME BENEFICIARY_NAME, %BENEFICIARY_SSN BENEFICIARY_SSN,
														%BENEFICIARY_DOB BENEFICIARY_DOB, %BENEFICIARY_ADD1 BENEFICIARY_ADD1,
														%BENEFICIARY_ADD2 BENEFICIARY_ADD2, %BENEFICIARY_ADD3 BENEFICIARY_ADD3,
														%BENEFICIARY_CITYSTATEZIP BENEFICIARY_CITYSTATEZIP
														from dual",,Pension
357,ADB Information - Block 1,ADB_BLOCK1_INFO,"select 
                                   						%SINGLE_BEN_PAGE1_BLOCK SINGLE_BEN_PAGE1_BLOCK, 
														%MUL_BEN_TRUST_NS_PAGE1_BLOCK MUL_BEN_TRUST_NS_PAGE1_BLOCK, 
														%MUL_BEN_PAGE1_BLOCK MUL_BEN_PAGE1_BLOCK, 
														%TRUST_PAGE1_BLOCK TRUST_PAGE1_BLOCK, 
														%NS_PAGE1_BLOCK NS_PAGE1_BLOCK
														from dual",,Pension
358,ADB Information - Block 2,ADB_BLOCK2_INFO,"select 
                                   						%SNS_TRUST_PAGE2_BLOCK SNS_TRUST_PAGE2_BLOCK, 
														%SINGLE_BEN_PAGE2_BLOCK SINGLE_BEN_PAGE2_BLOCK,
														%NS_PAGE1_BLOCK NS_PAGE1_BLOCK
														from dual",,Pension
359,ADB Information - Block 3,ADB_BLOCK3_INFO,"select 
                                   						%MUL_BEN_TRUST_NS_PAGE3_BLOCK MUL_BEN_TRUST_NS_PAGE3_BLOCK, 
														%MUL_BEN_TRUST_PAGE3_BLOCK MUL_BEN_TRUST_PAGE3_BLOCK,
														%SINGLE_SPOUSE_PAGE3_BLOCK SINGLE_SPOUSE_PAGE3_BLOCK,														
														%SINGLE_NON_SPOUSE_PAGE3_BLOCK SINGLE_NON_SPOUSE_PAGE3_BLOCK,
														%SNS_TRUST_PAGE3_BLOCK SNS_TRUST_PAGE3_BLOCK,
														%NON_STANDARD_PAGE3_BLOCK NON_STANDARD_PAGE3_BLOCK														
														from dual",,Pension
360,ADB Information - Block 3_2,ADB_BLOCK32_INFO,"select 
                                   						%SINGLE_NONSPOUSE_PAGE3_2_BLOCK SINGLE_NONSPOUSE_PAGE3_2_BLOCK													
														from dual",,Pension
361,ADB Information - Block 4,ADB_BLOCK4_INFO,"select 
                                   						%SPOUSE_NONSPOUSE_PAGE4_BLOCK SPOUSE_NONSPOUSE_PAGE4_BLOCK,	
                                   						%TRUST_PAGE4_BLOCK TRUST_PAGE4_BLOCK,	
                                   						%NON_STANDARD_PAGE4_BLOCK NON_STANDARD_PAGE4_BLOCK													
														from dual",,Pension
362,ADB Information - Block 5,ADB_BLOCK5_INFO,"select 
                                   						%SNS_TRUST_PAGE5_BLOCK SNS_TRUST_PAGE5_BLOCK,	
                                   						%NON_STANDARD_PAGE5_BLOCK NON_STANDARD_PAGE5_BLOCK,	
                                   						%NS_TRUST_NS_PAGE5_BLOCK NS_TRUST_NS_PAGE5_BLOCK											
														from dual",,Pension
363,ADB Information - Block 6,ADB_BLOCK6_INFO,"select 
                                   						%SNS_TRUST_PAGE6_BLOCK SNS_TRUST_PAGE6_BLOCK,	
                                   						%SPOUSE_PAGE6_BLOCK SPOUSE_PAGE6_BLOCK,	
                                   						%NONSPOUSE_TRUST_PAGE6_BLOCK NONSPOUSE_TRUST_PAGE6_BLOCK												
														from dual",,Pension
364,ADB Information - Block 6_2,ADB_BLOCK62_INFO,"select 
                                   						%SPOUSE_PAGE6_2_BLOCK SPOUSE_PAGE6_2_BLOCK,													
                                   						%NONSPOUSE_TRUST_PAGE6_2_BLOCK NONSPOUSE_TRUST_PAGE6_2_BLOCK
														from dual",,Pension
365,ADB Information - others,ADB_BLOCK_OTHER_INFO,"select 
                                   						%SINGLE_BEN_MONTHLY_ANNUITY_BLOCK SINGLE_BEN_MONTHLY_ANNUITY,													
                                   						%EMP_VERIFICATION_TERMINATION EMP_VERIFICATION_TERMINATION,													
                                   						%TRUST_AFFIDAVIT_BLOCK TRUST_AFFIDAVIT_BLOCK
														from dual",,Pension
543,Pension Secondary Beneficiary Count,PENSION_SEC_BEN_COUNT,"select count(pb.pension_beneficiary_id) 
  from dbo.pension_beneficiary pb,
       dbo.beneficiary         b,
       dbo.beneficiary_type    bt,
       dbo.pension_application pa
 where bt.beneficiary_type_code = 'Secondary'
   and bt.beneficiary_type_id = b.beneficiary_type_id
   and pb.alt_beneficiary_id = b.alt_beneficiary_id
   and pa.application_id = pb.application_id
   and pa.application_id = %PENSION_APPLICATION_ID",,Member
544,Option 1 SS New,OPT1_SS_NEW,"Select '$'||trim(nvl(to_char(sum(to_number(nvl(pfv.value, 0), 

'999990.00')),
                    '999,999,990.00'),'0.00')) as opt1_pres_age
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OPT_1_PA_ACT_DTH_BENE'))",,Member
545,Investment SS New,INVESTMENT_SS_NEW,"Select '$'||trim(nvl(to_char(sum(to_number(nvl(pfv.value, 0), 

'999990.00')),
                    '999,999,990.00'),'0.00'))as mem_investment,
'$'||trim(nvl(to_char(sum(to_number(nvl(pfv.value, 0), '999990.00')),
                    '999,999,990.00'),'0.00'))||',' as mem_investment_1
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_TOTAL_MEM_INV'))",,Member
378,Conference Date Con,CONFERENCE_DATE_CON,"select decode(trunc(c.start_date), trunc(c.stop_date),
                                     to_char(c.start_date,'MM/dd/yyyy'),
                                     to_char(c.start_date,'MM/dd/yyyy') || ' - ' || to_char(c.stop_date,'MM/dd/yyyy')) as conference_date
                                     from workforce.conference c
                                     where c.conference_id = %CONFERENCE_ID",,Member
546,Option 3 SS New,OPT3_SS_NEW,"Select '$'||trim(nvl(to_char(sum(to_number(nvl(pfv.value, 0), 

'999990.00')),
                    '999,999,990.00'),'0.00'))as opt3_pres_age
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OPT_3_PA_BENE'))",,Member
547,Option 4 SS New,OPT4_SS_NEW,"Select '$'||trim(nvl(to_char(sum(to_number(nvl(pfv.value, 0), 

'999990.00')),
                    '999,999,990.00'),'0.00')) as opt4_pres_age
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OPT_4_PA_BENE'))",,Member
548,Option 5 SS New,OPT5_SS_NEW,"Select '$'||trim(to_char(sum(to_number(nvl(pfv.value, 0), 

'999990.00')),
                    '999,999,990.00')) as opt5_pres_age
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OPT_5_PA_BENE'))",,Member
549,Winning Average Salary SS New,WIN_AVG_SAL_NEW,"Select '$'||trim(nvl(to_char(sum(nvl(pfv.value, 

0)),'999,999,990.00'),'0.00')) as win_avg_sal
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_FAS'))",,Member
379,Facility Name Con,FACILITY_NAME_CON,"select upper(oio.oi_name)  as org_name from 
                                     dbo.oi_organization oio, workforce.conference con
                                     where
                                     oio.organization_id = con.location_id and
                                     con.conference_id = %CONFERENCE_ID",,Member
417,Termination Date,TERMINATION_DATE,"select to_char(max(mc.stop_date), 'mm/dd/yyyy')
                                                             from dbo.member_contract mc
                                                             where mc.member_id = %MEMBER_ID
                                                             and mc.employer_id = (select emp.emp_id from 
                                                             (select pad.employer_id as emp_id
                                                             from dbo.part_account_detail      pad,
                                                             dbo.part_account_detail_type padt,
                                                             dbo.part_account             pa,
                                                             dbo.part_acct_detail_value   padv
                                                             where pad.part_account_id = pa.part_account_id
                                                             and pad.part_account_detail_type_id =
                                                             padt.part_account_detail_type_id
                                                             and pa.member_id = %MEMBER_ID
                                                             and padt.internal_name = 'CB'
                                                             and pad.part_account_detail_id = padv.part_account_detail_id
                                                             and (padv.code_03 is null or padv.code_03 = 'N')
                                                             and pad.employer_id is not null
                                                             order by pad.period_from_date desc) emp
                                                             where rownum = 1)",,Member
550,Winning Opt2 Amount SSD New,SSD_WIN_OPT_2_AMT_NEW,"select 

trim(decode(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_MP_ELIGIBLE'),
                                                  'Y',
                                                  '$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 

'PN_WIN_OP_2_MP'),'0.00'),
                                                  

'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2_REGULAR'),'0.00'))) AS OPT6,
                                                  trim(decode(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 

'PN_MP_ELIGIBLE'),
                                                  'Y',
                                                  '$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 

'PN_WIN_OP_2_MP'),'0.00')||'.',
                                                  

'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2_REGULAR'),'0.00')))||'.' AS OPT6_1
                                                  from dual",,Member
551,Option 2 SS New,OPT2_SS_NEW,"select case
         when nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_MP_ELIGIBLE'), 'N') = 'N' then
          '$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OPT_2_PRES_AGE'),
              '0.00')
         else
          '$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2_MP'), '0.00')
       end as opt2_ss
  from dual",,Member
380,Facility Address Con,FACILITY_ADDRESS_CON,"select decode(ad.address_1, null, '', ad.address_1) ||
                                     decode(ad.address_2,null,'',chr(10)||ad.address_2) ||
                                     decode(ad.address_3,null,'',chr(10)||ad.address_3)  ||
                                     chr(10) || ad.city ||', '||ad.state ||''||
                                     DECODE(ad.country,'US',
                                      substr(to_char(nvl(ad.zip,0),'000000000'),1,6)||
                                       decode(substr(to_char(nvl(ad.zip,0),'000000000'),7,4),'0000','','-'||
                                        substr(to_char(nvl(ad.zip,0),'000000000'),7,4)),
                                         ad.postal_code -- if not US
                                         )
                                         ||chr(10)||
                                         decode(ad.country,'US','',ad.country) as org_address
                                         from dbo.addresses ad where
                                         ad.start_date <= sysdate and
                                         nvl(ad.stop_date, to_date('01014000','MMddyyyy')) >= sysdate and
                                         ad.entity_id = dbo.pkg_benefit_s.f_get_entity_id('OI_ORGANIZATION')
                                         and ad.key_value in
                                         (select oio.oi_organization_id from 
                                         dbo.oi_organization oio, workforce.conference con
                                         where
                                         oio.organization_id = con.location_id and
                                         con.conference_id = %CONFERENCE_ID)",,Member
381,Emp Name,EMP_NAME,"select e.employer_name,e.employer_code from dbo.employer e where e.employer_id =%EMPLOYER_ID",,Employer
383,Ret ReEmpl Original Option,ORIGINAL_OPTION,"select trim(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_REG_OP')) Original_Option from dual",,Member
384,Retired ReEmp Option1 DB Total,RER_OPTION_1_DB_TOTAL,"select trim(to_char(Opt_1_DB + Orig_Opt1_DB,'999,999,999.99')) as RetReEmp_Option_1_DB_Tot, '$'||trim(to_char(Opt_1_DB + Orig_Opt1_DB,'999,999,999.99'))||'.' as RetReEmp from (select 
                                   (select replace(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OP1_DEATH_BENE'),',') from dual) as Opt_1_DB,
                                   nvl((select replace(client.f_get_pfv_value((select application_id from(select pa.application_id
                                     from dbo.pension_application pa,
                                          dbo.pension_option      po,
                                          dbo.pension_type        pt
                                    where pa.member_id = %MEMBER_ID
                                      and pa.pension_option_id =
                                          po.pension_option_id
                                      and po.pension_type_id =
                                          pt.pension_type_id
                                      and pt.pension_type_code = 'IPERSRET' order by pa.inserted_date desc) where rownum = 1),
                                   'PN_OP1_DEATH_BENE'),',')
                                   from dual),0)as Orig_Opt1_DB from dual)",,Member
385,Service Purchase Payment,SERVICE_PURCHASE_PAYMENT,"select '$' || trim(to_char(nvl(principal_amount, 0), '999,999,990.00'))
  from (select scp.principal_amount
          from dbo.service_credit_purchase scp, dbo.part_account pa
         where pa.part_account_id = scp.part_account_id
           and pa.member_id = %MEMBER_ID
         order by scp.service_credit_purchase_id desc)
 where rownum = 1",,Member
386,#_SCs_Processed,SCs_PROCESSED,"select total_service_credits
  from (select scp.total_service_credits
          from dbo.service_credit_purchase scp, dbo.part_account pa
         where pa.part_account_id = scp.part_account_id
           and pa.member_id = %MEMBER_ID
         order by scp.service_credit_purchase_id desc)
 where rownum = 1",,Member
387,#_SCs_Remaining,SCs_REMAINING,"select count(pads.part_acct_detail_summary_id)
from dbo.part_acct_detail_summary pads
   , dbo.part_account pa
   , dbo.part_acct_dtl_type_cat padtc
where
   pa.member_id = %MEMBER_ID
   and pads.part_account_id = pa.part_account_id
   and pads.part_acct_dtl_type_cat_id = padtc.part_acct_dtl_type_cat_id
   and padtc.internal_name = 'PURCHASE'
   and pads.identifier not in ('FMLA Free Credit','Leave of Absence/Worker''s Comp Free Credit','Veteran''s Free Credit')",,Member
388,Service Purchase Date,SERVICE_PURCHASE_DATE,"select processed_date
  from (select trim(to_char(t.inserted_date, 'mm/dd/yyyy')) as processed_date
          from dbo.transaction t
         where t.ref_entity_1 =
               dbo.pkg_benefit_s.f_get_entity_id('SERVICE_CREDIT_PURCHASE')
           and t.ref_key_1 =
               (select service_credit_purchase_id
                  from (select scp.service_credit_purchase_id
                          from dbo.service_credit_purchase scp,
                               dbo.part_account            pa
                         where scp.scp_type_status_id in
                               (select sts.scp_type_status_id
                                  from dbo.scp_type_status sts,
                                       dbo.scp_status      ss
                                 where sts.scp_status_id = ss.scp_status_id
                                   and ss.internal_name <> 'REFUNDED')
                           and scp.part_account_id = pa.part_account_id
                           and pa.member_id = %MEMBER_ID
                         order by 1 desc)
                 where rownum = 1)
         order by t.inserted_date desc)
 where rownum = 1",,Member
418,Date of Last Paycheck,DATE_OF_LAST_PAYCHECK,"select to_char(max(mc.final_report_date), 'mm/dd/yyyy')
                                                             from dbo.member_contract mc
                                                             where mc.member_contract_id in
                                                             (select mc1.member_contract_id
                                                             from dbo.member_contract mc1
                                                             where mc1.stop_date in
                                                             (select max(mc.stop_date)
                                                             from dbo.member_contract mc
                                                             where mc.member_id = %MEMBER_ID)
                                                             and mc1.member_id = %MEMBER_ID
                                                             and mc1.employer_id = mc.employer_id)
                                                             and mc.start_date is not null
                                                             and mc.stop_date is not null
                                                             and mc.employer_id = (select emp.emp_id from 
                                                             (select pad.employer_id as emp_id
                                                             from dbo.part_account_detail      pad,
                                                             dbo.part_account_detail_type padt,
                                                             dbo.part_account             pa,
                                                             dbo.part_acct_detail_value   padv
                                                             where pad.part_account_id = pa.part_account_id
                                                             and pad.part_account_detail_type_id =
                                                             padt.part_account_detail_type_id
                                                             and pa.member_id = %MEMBER_ID
                                                             and padt.internal_name = 'CB'
                                                             and pad.part_account_detail_id = padv.part_account_detail_id
                                                             and (padv.code_03 is null or padv.code_03 = 'N')
                                                             and pad.employer_id is not null
                                                             order by pad.period_from_date desc) emp
                                                             where rownum = 1)",,Member
419,Reporting Official Info for RRW Letter,REP_OFF_INFO_RRW,"select  Initcap(p.first_name) as firstName_init,
                                                             upper(p.first_name) as firstName,
                                                             upper(p.last_name) as lastName,
                                                             Initcap(p.first_name)||''||Initcap(p.last_name)||':' as fullName --NG
                                                             from dbo.person p
                                                             where p.person_id in
                                                             (select oi.person_id
                                                             from dbo.oi_person oi
                                                             where oi.oi_person_id in
                                                             (select bek.key_value
                                                             from dbo.business_entity_key bek
                                                             where bek.business_entity_key_id in
                                                             (select ber.business_entity_key_id
                                                             from dbo.business_entity_relation ber
                                                             where ber.key_value = (select emp.emp_id
                                                             from (select pad.employer_id as emp_id
                                                             from dbo.part_account_detail      pad,
                                                             dbo.part_account_detail_type padt,
                                                             dbo.part_account             pa,
                                                             dbo.part_acct_detail_value   padv
                                                             where pad.part_account_id = pa.part_account_id
                                                             and pad.part_account_detail_type_id =
                                                             padt.part_account_detail_type_id
                                                             and pa.member_id = %MEMBER_ID
                                                             and padt.internal_name = 'CB'
                                                             and pad.part_account_detail_id = padv.part_account_detail_id
                                                             and (padv.code_03 is null or padv.code_03 = 'N')
                                                             and pad.employer_id is not null
                                                             order by pad.period_from_date desc) emp
                                                             where rownum = 1)
                                                             and ber.relation_role = 'RO')))",,Member
458,Pension Primary Beneficiary,PENSION_PRIMARY_BENEFICIARY,"select UPPER(x.name) as P_ben_name, 'Date of birth: ' ||  to_char(x.birth_date, 'mm/dd/yyyy') as p_ben_bd, rownum
       as p_ben_num
      from dbo.beneficiary_type bt,
           (select b.beneficiary_type_id,
                   nvl2(p.first_name, initcap(p.first_name) || ' ', '') ||                   
                   nvl2(p.last_name, initcap(p.last_name), '') as name,
                   p.birth_date
              from dbo.pension_beneficiary pb,
                   dbo.beneficiary         b,
                   dbo.pension_application pa,
                   dbo.member              m,
                   dbo.person              p,
                   dbo.beneficiary_type    bt
             where pb.application_id = pa.application_id
               and pa.application_id = %PENSION_APPLICATION_ID
               and pb.alt_beneficiary_id = b.alt_beneficiary_id
               and b.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
               and b.key_value = p.person_id
               and b.beneficiary_type_id = bt.beneficiary_type_id
               and b.stop_date is null
            union
            select b.beneficiary_type_id,
                   nvl2(p.first_name, initcap(p.first_name) || ' ', '') ||
                   nvl2(p.middle_name, initcap(p.middle_name) || ' ', '') ||
                   nvl2(p.last_name, initcap(p.last_name), '') as name,
                   p.birth_date
              from dbo.pension_beneficiary pb,
                   dbo.beneficiary         b,
                   dbo.pension_application pa,
                   dbo.member              m,
                   dbo.person              p,
                   dbo.beneficiary_type    bt,
                   dbo.oi_person           op
             where pb.application_id = pa.application_id
               and pa.application_id = %PENSION_APPLICATION_ID
               and pb.alt_beneficiary_id = b.alt_beneficiary_id
               and p.person_id = op.person_id
               and b.beneficiary_type_id = bt.beneficiary_type_id
               and b.entity_id =
                   dbo.pkg_benefit_s.f_get_entity_id('OI_PERSON')
               and op.oi_person_id = b.key_value
               and b.stop_date is null
            union
            select b.beneficiary_type_id,
                   initcap(oo.oi_name) as name,
                   null birth_date
              from dbo.pension_beneficiary pb,
                   dbo.beneficiary         b,
                   dbo.pension_application pa,
                   dbo.member              m,
                   dbo.beneficiary_type    bt,
                   dbo.oi_organization     oo
             where pb.application_id = pa.application_id
               and pa.application_id = %PENSION_APPLICATION_ID
               and pb.alt_beneficiary_id = b.alt_beneficiary_id
               and b.beneficiary_type_id = bt.beneficiary_type_id
               and b.entity_id =
                   dbo.pkg_benefit_s.f_get_entity_id('OI_ORGANIZATION')
               and oo.oi_organization_id = b.key_value
               and b.stop_date is null) x
     where bt.beneficiary_type_id = x.beneficiary_type_id
       and bt.beneficiary_type_code = 'Primary'",,Member
459,Pension Secondary Beneficiary,PENSION_SECONDARY_BENEFICIARY,"select UPPER(x.name) as P_ben_name, 'Date of birth: ' || to_char(x.birth_date, 'mm/dd/yyyy') as p_ben_bd, rownum
       as p_ben_num
      from dbo.beneficiary_type bt,
           (select b.beneficiary_type_id,
                   nvl2(p.first_name, initcap(p.first_name) || ' ', '') ||                   
                   nvl2(p.last_name, initcap(p.last_name), '') as name,
                   p.birth_date
              from dbo.pension_beneficiary pb,
                   dbo.beneficiary         b,
                   dbo.pension_application pa,
                   dbo.member              m,
                   dbo.person              p,
                   dbo.beneficiary_type    bt
             where pb.application_id = pa.application_id
               and pa.application_id = %PENSION_APPLICATION_ID
               and pb.alt_beneficiary_id = b.alt_beneficiary_id
               and b.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
               and b.key_value = p.person_id
               and b.beneficiary_type_id = bt.beneficiary_type_id
               and b.stop_date is null
            union
            select b.beneficiary_type_id,
                   nvl2(p.first_name, initcap(p.first_name) || ' ', '') ||
                   nvl2(p.middle_name, initcap(p.middle_name) || ' ', '') ||
                   nvl2(p.last_name, initcap(p.last_name), '') as name,
                   p.birth_date
              from dbo.pension_beneficiary pb,
                   dbo.beneficiary         b,
                   dbo.pension_application pa,
                   dbo.member              m,
                   dbo.person              p,
                   dbo.beneficiary_type    bt,
                   dbo.oi_person           op
             where pb.application_id = pa.application_id
               and pa.application_id = %PENSION_APPLICATION_ID
               and pb.alt_beneficiary_id = b.alt_beneficiary_id
               and p.person_id = op.person_id
               and b.beneficiary_type_id = bt.beneficiary_type_id
               and b.entity_id =
                   dbo.pkg_benefit_s.f_get_entity_id('OI_PERSON')
               and op.oi_person_id = b.key_value
               and b.stop_date is null
            union
            select b.beneficiary_type_id,
                   initcap(oo.oi_name) as name,
                   null birth_date
              from dbo.pension_beneficiary pb,
                   dbo.beneficiary         b,
                   dbo.pension_application pa,
                   dbo.member              m,
                   dbo.beneficiary_type    bt,
                   dbo.oi_organization     oo
             where pb.application_id = pa.application_id
               and pa.application_id = %PENSION_APPLICATION_ID
               and pb.alt_beneficiary_id = b.alt_beneficiary_id
               and b.beneficiary_type_id = bt.beneficiary_type_id
               and b.entity_id =
                   dbo.pkg_benefit_s.f_get_entity_id('OI_ORGANIZATION')
               and oo.oi_organization_id = b.key_value
               and b.stop_date is null) x
     where bt.beneficiary_type_id = x.beneficiary_type_id
       and bt.beneficiary_type_code = 'Secondary'",,Member
460,Benefits Expiry SS,BENEFITS_EXPIREY_SS,"select trunc(to_date(max(substr(ds.explanation, 1, 10)), 'mm/dd/yyyy')) as benefit_exp_ss
  from dbo.disburse_schedule ds, dbo.benefit_account ba
 where ds.source_entity =
       dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
      and ds.source_key = %PENSION_APPLICATION_ID
   and ds.benefit_account_id = ba.benefit_account_id
   and ba.benefit_type in ('SI', 'SD')",,Member
428,AE Lump Sum Taxable(Estimate),AE_LUMPSUM_TAXABLE_AMT,"SELECT '$' || TRIM(TO_CHAR(client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,
                                                         'PN_TOTAL_INV') -
                           client.f_get_federal_tax_amt(%MEMBER_ID, 'F'),
                           '999,999,990.99')) AS AE_LUMPSUM,
       '$' || TRIM(TO_CHAR(client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,
                                                         'PN_TOTAL_INV') -
                           client.f_get_federal_tax_amt(%MEMBER_ID, 'FP'),
                           '999,999,990.99')) AS AE_LUMPSUM1 FROM DUAL",,Member
429,AE Lump Sum Amount(Total Inv),AE_LUMPSUM_AMT_TOT_INV,"select client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_TOTAL_INV') as FME from dual",,Member
430,AE Lump Sum_Non-Taxable(Fed Tax Contrib),AE_LUMPSUM_NON_TAX_AMT,"SELECT '$' || TRIM(TO_CHAR(client.f_get_federal_tax_amt(%MEMBER_ID, 'FP'),
                           '999,999,990.99'))
  FROM dual",,Member
432,Page Name,PAGE_NAME,select %PAGE_NAME from dual,,Member
433,FME from Pension App,FME_PENSION_APP,"select trim(to_char(pa.custom_date_05, 'MM/dd/yyyy')) as FME,
                                     trim(to_char(pa.custom_date_05, 'Monthyyyy')) as FME_NEW
                                                           from dbo.pension_application pa
                                                            where pa.application_id = %PENSION_APPLICATION_ID",,Pension
434,ADB EFT Information,ADB_EFT_INFO,"Select BANK_NAME, ROUTING_NO, ACCOUNT_TYPE, APPROVAL_STATUS from (select ea.bank_name Bank_Name,
                                                             ea.routing_no Routing_No,
                                                              decode(ea.recipient_account_type, 'C', 'checkings', 'S', 'savings') as Account_Type,
                                                               ea.eft_approval_status Approval_Status,
                                                               eah.start_date 
                                                               from dbo.eft_authorization        ea,
                                                               dbo.eft_authorization_header eah,
                                                               dbo.member                   m,
                                                               dbo.benefit_account          ba
                                                                where ea.eft_authorization_header_id = eah.eft_authorization_header_id
                                                                 and m.member_id = (select pa.member_id from dbo.pension_application pa where pa.application_id = %PENSION_APPLICATION_ID)
                                                                  and ea.recipient_entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')   
                                                                   and ea.eft_approval_status = 'A'
                                                                    and (eah.end_date is null or to_char(eah.end_date, 'mm/dd/yyyy') >
                                                                    to_char(sysdate, 'mm/dd/yyyy'))
                                                                     and ea.benefit_account_id = ba.benefit_account_id   
                                                                      order by eah.start_date desc) where rownum=1",,Pension
435,Member User or Lob User,MEMBER_LOB_USER,select client.f_get_module(%SECURITY_USERS_ID) from dual,,Member
438,Benefit Summary Block SS for Secondary App,BEN_SUMMARY_BLOCK_SS_SECOND_APP,"select Display_name as Descrip,
       Amount_01 as Last_Month,
       Amount_02 as Current_Month,
       Amount_03 as Next_Month 
       from table(CLIENT.f_get_ss_ben_summary_block((select pa.parent_application_id
                                                  from dbo.pension_application pa
                                                 where pa.application_id =%PENSION_APPLICATION_ID), %PERSON_ID))",,Member
552,Option 1 Death Benefit SS New,OPT1_DEATH_BEN_SS_NEW,"Select '$'||trim(nvl(to_char(sum(to_number(nvl(pfv.value, 0), 

'999990.00')),
                    '999,999,990.00'),'0.00'))as opt1_death_ben
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_OP1_DEATH_BENE'))",,Member
554,Money Purchase Eligible block,MPNE_BLOCK," select case
         when nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_MP_ELIGIBLE'),'N') = 'N' then
          '$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2_REGULAR'),
              '0.00')
         else
          '$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2_MP'), '0.00')
       end OPTION_2,
       case
         when nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_MP_ELIGIBLE'),'N') = 'N' then
          '$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2_SS'),
              '0.00')
         else
          '$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2_MP'), '0.00')
       end AE_OPTION2
       
  from dual",,Member
439,Current Payroll,CURRENT_PAYROLL,"select cur_pay_date
  from (select to_char(ds.start_date, 'MM/yyyy') as cur_pay_date
          FROM dbo.disburse_schedule ds
         WHERE ds.source_entity =
               dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
           AND ds.source_key = %PENSION_APPLICATION_ID
           AND ds.stop_date is null
         order by ds.start_date desc)
 where rownum = 1",,Member
440,Disb Eft Info,DISB_EFT_INFO,"select routing_num, rec_acc_type, rec_acc_num, bank_name
  from (select lpad(ea.routing_no, 9, '0') as routing_num,-- ea.routing_no as routing_num,
               decode(nvl(ea.recipient_account_type, 'C'),
                      'C',
                      'checking',
                      'S',
                      'savings') as rec_acc_type,
               trim(ea.recipient_account_no) as rec_acc_num,
               ea.bank_name as bank_name
          from dbo.eft_authorization        ea,
               dbo.eft_authorization_header eah,
               dbo.member                   m
         where ea.eft_authorization_header_id =
               eah.eft_authorization_header_id
           and m.member_id = %MEMBER_ID
           and ea.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and ea.recipient_key_value = m.person_id
           and (eah.end_date is null or eah.end_date > sysdate)
         order by eah.start_date desc) x
 where rownum = 1",,Member
441,Last Month and Year of Service,LAST_MONTH_YEAR,"select trim(to_char(max(wh.start_date), 'Month')) as end_month,
             to_char(max(wh.start_date), 'yyyy') as end_year
        from dbo.work_history_1 wh
       where wh.member_id = %MEMBER_ID
         and wh.work_01 is not null
       order by wh.start_date desc",,Member
442,FME Month SS,FME_MONTH_SS,"select trim(to_char(add_months(sysdate,-1), 'Month')) as cur_pay_month from dual",,Member
443,Last Benefit,LAST_BENEFIT,"SELECT gross_amount
      AS pre_month_gross
      FROM (SELECT ds.gross_amount,
                   rank() over(ORDER BY to_date(substr(ds.explanation, 1, 10), 'mm/dd/yyyy') DESC, ds.gross_amount DESC) rank
              FROM dbo.disburse_schedule ds
             WHERE ds.source_entity =
                   dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
               AND ds.source_key = %PENSION_APPLICATION_ID
               AND add_months(SYSDATE, -1) BETWEEN
                   to_date(substr(ds.explanation, 1, 10), 'mm/dd/yyyy') AND
                   to_date(substr(ds.explanation, 14, 10), 'mm/dd/yyyy')
               AND ds.explanation IS NOT NULL
               AND length(ds.explanation) = 23)
     WHERE rank = 1",,Member
444,Last Adjustment,LAST_ADJUSTMENT,"select ((SELECT max(ds.gross_amount)
                 FROM dbo.disburse_schedule ds
                WHERE ds.source_entity =
                      dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                  AND ds.source_key = %PENSION_APPLICATION_ID
                  AND add_months(SYSDATE, -1) BETWEEN
                      to_date(substr(ds.explanation, 1, 10), 'mm/dd/yyyy') AND
                      to_date(substr(ds.explanation, 14, 10), 'mm/dd/yyyy')
                  AND ds.explanation is Not NULL
                  AND LENGTH(ds.explanation) = 23) -
             (SELECT min(ds.gross_amount)
                 FROM dbo.disburse_schedule ds
                WHERE ds.source_entity =
                      dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                  AND ds.source_key = %PENSION_APPLICATION_ID
                  AND add_months(SYSDATE, -2) BETWEEN
                      to_date(substr(ds.explanation, 1, 10), 'mm/dd/yyyy') AND
                      to_date(substr(ds.explanation, 14, 10), 'mm/dd/yyyy')
                  AND ds.explanation is Not NULL
                  AND LENGTH(ds.explanation) = 23))
        AS last_MONTH_adj
        from dual",,Member
445,Last Disability Offset,LAST_DISABILITY_OFFSET,"select dtd.deduction_amt
        AS disb_bene_do
        from dbo.deduction_template_detail dtd, dbo.deduction_template dt
       where dtd.deduction_template_id = dt.deduction_template_id
         and dt.source_entity_id =
             dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
         and dt.source_key_value = %PENSION_APPLICATION_ID
         and dtd.deduction_type = 'DO'
         and dtd.start_date between
             (SELECT add_months(to_date(substr(max(ds.explanation), 1, 10),
                                        'mm/dd/yyyy'),
                                -1)
                FROM dbo.disburse_schedule ds
               WHERE ds.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds.source_key = %PENSION_APPLICATION_ID
                 AND ds.explanation is Not NULL
                 AND LENGTH(ds.explanation) = 23)
         AND (SELECT add_months(to_date(substr(max(ds1.explanation), 14, 10),
                                        'mm/dd/yyyy'),
                                -1)
                FROM dbo.disburse_schedule ds1
               WHERE ds1.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds1.source_key = %PENSION_APPLICATION_ID
                 AND ds1.explanation is Not NULL
                 AND LENGTH(ds1.explanation) = 23)",,Member
446,Last Federal,LAST_FEDERAL,"select dtd.deduction_amt
        AS disb_bene_ft
        from dbo.deduction_template_detail dtd, dbo.deduction_template dt
       where dtd.deduction_template_id = dt.deduction_template_id
         and dt.source_entity_id =
             dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
         and dt.source_key_value = %PENSION_APPLICATION_ID
         and dtd.deduction_type = 'F'
         and dtd.start_date between
             (SELECT add_months(to_date(substr(max(ds.explanation), 1, 10),
                                        'mm/dd/yyyy'),
                                -1)
                FROM dbo.disburse_schedule ds
               WHERE ds.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds.source_key = %PENSION_APPLICATION_ID
                 AND ds.explanation is Not NULL
                 AND LENGTH(ds.explanation) = 23)
         AND (SELECT add_months(to_date(substr(max(ds1.explanation), 14, 10),
                                        'mm/dd/yyyy'),
                                -1)
                FROM dbo.disburse_schedule ds1
               WHERE ds1.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds1.source_key = %PENSION_APPLICATION_ID
                 AND ds1.explanation is Not NULL
                 AND LENGTH(ds1.explanation) = 23)",,Member
422,Member Death Date,MEMBER_DEATH_DATE,select p.death_date from dbo.v_member_q p where p.member_id=%MEMBER_ID,,Member
423,Member Self Service User Name,MSS_USER_NAME,"select su.user_name as UserName from dbo.person p, dbo.security_users su where su.person_id = p.person_id
and  p.person_id = %PERSON_ID",,Member
424,Member Self Service System Date,MSS_SYS_DATE,select sysdate as System_Date from dual,,Member
425,Member Self Service Member Name,MSS_MEMBER_NAME,"select p.sort_name as SortName, p.first_name as FirstName from dbo.person p where p.person_id = %PERSON_ID",,Member
426,MSS Forgot User Name,MSS_FORGOT_USER_NAME,"select su.user_name
  from dbo.security_users su
 where su.person_id = %PERSON_ID
   and rownum = 1",,Member
427,W4 Withholding info,W4_WITHHOLDING_INFO,,,Member
436,ADB Monthly Annutiy Amount,ADB_MONTHLY_ANNUITY_AMT,"select trim(to_char(nvl(client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,'PN_MEM_TAXABLE_GROSS'),0),'99,999,999.99')) OLD_VALUE,
                                     '$'||nvl(trim(to_char(nvl(client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,'PN_MEM_TAXABLE_GROSS'),0),'99,999,999.99')),'0.00') NEW_VALUE  from dual",,Pension
447,Last State,LAST_STATE,"select dtd.deduction_amt
        AS disb_bene_st
        from dbo.deduction_template_detail dtd, dbo.deduction_template dt
       where dtd.deduction_template_id = dt.deduction_template_id
         and dt.source_entity_id =
             dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
         and dt.source_key_value = %PENSION_APPLICATION_ID
         and dtd.deduction_type = 'ST'
         and dtd.start_date between
             (SELECT add_months(to_date(substr(max(ds.explanation), 1, 10),
                                        'mm/dd/yyyy'),
                                -1)
                FROM dbo.disburse_schedule ds
               WHERE ds.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds.source_key = %PENSION_APPLICATION_ID
                 AND ds.explanation is Not NULL
                 AND LENGTH(ds.explanation) = 23)
         AND (SELECT add_months(to_date(substr(max(ds1.explanation), 14, 10),
                                        'mm/dd/yyyy'),
                                -1)
                FROM dbo.disburse_schedule ds1
               WHERE ds1.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds1.source_key = %PENSION_APPLICATION_ID
                 AND ds1.explanation is Not NULL
                 AND LENGTH(ds1.explanation) = 23)",,Member
448,Last Check Fee,LAST_CHECK_FEE,"select dtd.deduction_amt
        AS disb_bene_wf
        from dbo.deduction_template_detail dtd, dbo.deduction_template dt
       where dtd.deduction_template_id = dt.deduction_template_id
         and dt.source_entity_id =
             dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
         and dt.source_key_value = %PENSION_APPLICATION_ID
         and dtd.deduction_type = 'WF'
         and dtd.start_date between
             (SELECT add_months(to_date(substr(max(ds.explanation), 1, 10),
                                        'mm/dd/yyyy'),
                                -1)
                FROM dbo.disburse_schedule ds
               WHERE ds.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds.source_key = %PENSION_APPLICATION_ID
                 AND ds.explanation is Not NULL
                 AND LENGTH(ds.explanation) = 23)
         AND (SELECT add_months(to_date(substr(max(ds1.explanation), 14, 10),
                                        'mm/dd/yyyy'),
                                -1)
                FROM dbo.disburse_schedule ds1
               WHERE ds1.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds1.source_key = %PENSION_APPLICATION_ID
                 AND ds1.explanation is Not NULL
                 AND LENGTH(ds1.explanation) = 23)",,Member
449,Last Net Benefit,LAST_NET_BENEFIT,"select d.disbursement_amt
      AS net_amt_lm
      from dbo.disbursement d
     where d.recipient_entity_id =
           dbo.pkg_benefit_s.f_get_entity_id('PERSON')
       and d.recipient_key_value = %PERSON_ID
       and d.disbursement_date between
           (SELECT add_months(to_date(substr(max(ds.explanation), 1, 10),
                                      'mm/dd/yyyy'),
                              -1)
              FROM dbo.disburse_schedule ds
             WHERE ds.source_entity =
                   dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
               AND ds.source_key = %PENSION_APPLICATION_ID
               AND ds.explanation is Not NULL
               AND LENGTH(ds.explanation) = 23)
       AND (SELECT add_months(to_date(substr(max(ds1.explanation), 14, 10),
                                      'mm/dd/yyyy'),
                              -1)
              FROM dbo.disburse_schedule ds1
             WHERE ds1.source_entity =
                   dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
               AND ds1.source_key = %PENSION_APPLICATION_ID
               AND ds1.explanation is Not NULL
               AND LENGTH(ds1.explanation) = 23)",,Member
450,Current Month,CURRENT_MONTH,"select trim(to_char(sysdate, 'Month')) as cur_pay_month from dual",,Member
451,Current Benefit,CURRENT_BENEFIT,"SELECT gross_amount
      AS cur_mon_gross
      FROM (SELECT ds.gross_amount,
                   rank() over(ORDER BY to_date(substr(ds.explanation, 1, 10), 'mm/dd/yyyy') DESC, ds.gross_amount DESC) rank
              FROM dbo.disburse_schedule ds
             WHERE ds.source_entity =
                   dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
               AND ds.source_key = %PENSION_APPLICATION_ID
               AND SYSDATE BETWEEN
                   to_date(substr(ds.explanation, 1, 10), 'mm/dd/yyyy') AND
                   to_date(substr(ds.explanation, 14, 10), 'mm/dd/yyyy')
               AND ds.explanation IS NOT NULL
               AND length(ds.explanation) = 23)
     WHERE rank = 1",,Member
452,Current Adjustment,CURRENT_ADJUSTMENT,"select ((SELECT max(ds.gross_amount)
                 FROM dbo.disburse_schedule ds
                WHERE ds.source_entity =
                      dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                  AND ds.source_key = %PENSION_APPLICATION_ID
                  AND SYSDATE BETWEEN
                      to_date(substr(ds.explanation, 1, 10), 'mm/dd/yyyy') AND
                      to_date(substr(ds.explanation, 14, 10), 'mm/dd/yyyy')
                  AND ds.explanation is Not NULL
                  AND LENGTH(ds.explanation) = 23) -
             (SELECT min(ds.gross_amount)
                 FROM dbo.disburse_schedule ds
                WHERE ds.source_entity =
                      dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                  AND ds.source_key = %PENSION_APPLICATION_ID
                  AND add_months(SYSDATE, -1) BETWEEN
                      to_date(substr(ds.explanation, 1, 10), 'mm/dd/yyyy') AND
                      to_date(substr(ds.explanation, 14, 10), 'mm/dd/yyyy')
                  AND ds.explanation is Not NULL
                  AND LENGTH(ds.explanation) = 23))
        AS curr_adj
        from dual",,Member
453,Current Disability Offset,CURRENT_DISABLITY_OFFSET,"select dtd.deduction_amt
        AS disb_bene_do_cur
        from dbo.deduction_template_detail dtd, dbo.deduction_template dt
       where dtd.deduction_template_id = dt.deduction_template_id
         and dt.source_entity_id =
             dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
         and dt.source_key_value = %PENSION_APPLICATION_ID
         and dtd.deduction_type = 'DO'
         and dtd.start_date between
             (SELECT to_date(substr(max(ds.explanation), 1, 10),
                             'mm/dd/yyyy')
                FROM dbo.disburse_schedule ds
               WHERE ds.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds.source_key = %PENSION_APPLICATION_ID
                 AND ds.explanation is Not NULL
                 AND LENGTH(ds.explanation) = 23)
         AND (SELECT to_date(substr(max(ds1.explanation), 14, 10),
                             'mm/dd/yyyy')
                FROM dbo.disburse_schedule ds1
               WHERE ds1.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds1.source_key = %PENSION_APPLICATION_ID
                 AND ds1.explanation is Not NULL
                 AND LENGTH(ds1.explanation) = 23)",,Member
454,Current Federal,CURRENT_FEDERAL,"select dtd.deduction_amt
        AS disb_bene_ft_cur
        from dbo.deduction_template_detail dtd, dbo.deduction_template dt
       where dtd.deduction_template_id = dt.deduction_template_id
         and dt.source_entity_id =
             dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
         and dt.source_key_value = %PENSION_APPLICATION_ID
         and dtd.deduction_type = 'F'
         and dtd.start_date between
             (SELECT to_date(substr(max(ds.explanation), 1, 10),
                             'mm/dd/yyyy')
                FROM dbo.disburse_schedule ds
               WHERE ds.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds.source_key = %PENSION_APPLICATION_ID
                 AND ds.explanation is Not NULL
                 AND LENGTH(ds.explanation) = 23)
         AND (SELECT to_date(substr(max(ds1.explanation), 14, 10),
                             'mm/dd/yyyy')
                FROM dbo.disburse_schedule ds1
               WHERE ds1.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds1.source_key = %PENSION_APPLICATION_ID
                 AND ds1.explanation is Not NULL
                 AND LENGTH(ds1.explanation) = 23)",,Member
455,Current State,CURRENT_STATE,"select dtd.deduction_amt
        AS disb_bene_st_cur
        from dbo.deduction_template_detail dtd, dbo.deduction_template dt
       where dtd.deduction_template_id = dt.deduction_template_id
         and dt.source_entity_id =
             dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
         and dt.source_key_value = %PENSION_APPLICATION_ID
         and dtd.deduction_type = 'ST'
         and dtd.start_date between
             (SELECT to_date(substr(max(ds.explanation), 1, 10),
                             'mm/dd/yyyy')
                FROM dbo.disburse_schedule ds
               WHERE ds.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds.source_key = %PENSION_APPLICATION_ID
                 AND ds.explanation is Not NULL
                 AND LENGTH(ds.explanation) = 23)
         AND (SELECT to_date(substr(max(ds1.explanation), 14, 10),
                             'mm/dd/yyyy')
                FROM dbo.disburse_schedule ds1
               WHERE ds1.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds1.source_key = %PENSION_APPLICATION_ID
                 AND ds1.explanation is Not NULL
                 AND LENGTH(ds1.explanation) = 23)",,Member
456,Current Check Fee,CURRENT_CHECK_FEE,"select dtd.deduction_amt
        AS disb_bene_wf_cur
        from dbo.deduction_template_detail dtd, dbo.deduction_template dt
       where dtd.deduction_template_id = dt.deduction_template_id
         and dt.source_entity_id =
             dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
         and dt.source_key_value = %PENSION_APPLICATION_ID
         and dtd.deduction_type = 'WF'
         and dtd.start_date between
             (SELECT to_date(substr(max(ds.explanation), 1, 10),
                             'mm/dd/yyyy')
                FROM dbo.disburse_schedule ds
               WHERE ds.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds.source_key = %PENSION_APPLICATION_ID
                 AND ds.explanation is Not NULL
                 AND LENGTH(ds.explanation) = 23)
         AND (SELECT to_date(substr(max(ds1.explanation), 14, 10),
                             'mm/dd/yyyy')
                FROM dbo.disburse_schedule ds1
               WHERE ds1.source_entity =
                     dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                 AND ds1.source_key = %PENSION_APPLICATION_ID
                 AND ds1.explanation is Not NULL
                 AND LENGTH(ds1.explanation) = 23)",,Member
420,Reporting Official Address Info for RRW Letter,REP_OFF_ADDR_INFO_RRW,"select upper(address_1) as address_1, 
                                                             upper(nvl(address_2,'')) as address_2, 
                                                             upper(nvl(address_3,'')) as address_3,
                                                             upper(city) ||', '||upper(state) ||' '||
                                                             DECODE(country,'US',
                                                             substr(to_char(nvl(zip,0),'000000000'),1,6)||
                                                             decode(substr(to_char(nvl(zip,0),'000000000'),7,4),'0000','','-'||
                                                             substr(to_char(nvl(zip,0),'000000000'),7,4)),
                                                             postal_code)
                                                             ||chr(10)||
                                                             decode(country,'US','',country)
                                                             as City_State
                                                             from dbo.addresses
                                                             where entity_id = dbo.pkg_benefit_s.f_get_entity_id('OI_PERSON')
                                                             and (stop_date is null or stop_date > sysdate)
                                                             and key_value in
                                                             (SELECT bek.key_value
                                                             FROM dbo.business_entity_key bek
                                                             WHERE 1 = 1
                                                             and bek.business_entity_key_id IN
                                                            (SELECT max(ber.business_entity_key_id)
                                                             FROM dbo.business_entity_relation ber
                                                             WHERE ber.key_value = (select emp.emp_id
                                                             from (select pad.employer_id as emp_id
                                                             from dbo.part_account_detail      pad,
                                                             dbo.part_account_detail_type padt,
                                                             dbo.part_account             pa,
                                                             dbo.part_acct_detail_value   padv
                                                             where pad.part_account_id = pa.part_account_id
                                                             and pad.part_account_detail_type_id =
                                                             padt.part_account_detail_type_id
                                                             and pa.member_id = %MEMBER_ID
                                                             and padt.internal_name = 'CB'
                                                             and pad.part_account_detail_id = padv.part_account_detail_id
                                                             and (padv.code_03 is null or padv.code_03 = 'N')
                                                             and pad.employer_id is not null
                                                             order by pad.period_from_date desc) emp
                                                             where rownum = 1)
                                                             AND ber.entity_id =dbo.pkg_benefit_s.f_get_entity_id('EMPLOYER')
                                                             and ber.relation_role = 'RO'))",,Member
421,Employer Name for RRW Letter,EMP_NAME_RRW,"select em.employer_name
                                                             from (select pad.employer_id as emp_id
                                                             from dbo.part_account_detail      pad,
                                                             dbo.part_account_detail_type padt,
                                                             dbo.part_account             pa,
                                                             dbo.part_acct_detail_value   padv
                                                             where pad.part_account_id = pa.part_account_id
                                                             and pad.part_account_detail_type_id =
                                                             padt.part_account_detail_type_id
                                                             and pa.member_id = %MEMBER_ID
                                                             and padt.internal_name = 'CB'
                                                             and pad.part_account_detail_id = padv.part_account_detail_id
                                                             and (padv.code_03 is null or padv.code_03 = 'N')
                                                             and pad.employer_id is not null
                                                             order by pad.period_from_date desc) emp, dbo.employer em
                                                             where em.employer_id = emp.emp_id and         
                                                             rownum = 1",,Member
457,Current Net Benefit,CURRENT_NET_BENEFIT,"select d.disbursement_amt
      AS net_amt_cm
      from dbo.disbursement d
     where d.recipient_entity_id =
           dbo.pkg_benefit_s.f_get_entity_id('PERSON')
       and d.recipient_key_value = %PERSON_ID
       and d.disbursement_date between
           (SELECT to_date(substr(max(ds.explanation), 1, 10), 'mm/dd/yyyy')
              FROM dbo.disburse_schedule ds
             WHERE ds.source_entity =
                   dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
               AND ds.source_key = %PENSION_APPLICATION_ID
               AND ds.explanation is Not NULL
               AND LENGTH(ds.explanation) = 23)
       AND (SELECT to_date(substr(max(ds1.explanation), 14, 10),
                           'mm/dd/yyyy')
              FROM dbo.disburse_schedule ds1
             WHERE ds1.source_entity =
                   dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
               AND ds1.source_key = %PENSION_APPLICATION_ID
               AND ds1.explanation is Not NULL
               AND LENGTH(ds1.explanation) = 23)",,Member
561,Outdated_Warrant_4,OUTDATED_WARRENT_4,"select check_no as Outdated_Warrant_Number4,
       to_char(warrant, 'mm/dd/yyyy') as Outdated_Warrant_Issue_Date4,
       trim(to_char(amount, '999,999,990.00')) as Outdated_Warrant_Amt4
  from (select lead(disb.disbursement_date, 3, null) over(order by disb.disbursement_id desc) as warrant,
               lead(disb.check_eft_no, 3, null) over(order by disb.disbursement_id desc) as check_no,
               lead(disb.disbursement_amt, 3, 0) over(order by disb.disbursement_id desc) as amount
          from dbo.disbursement         disb,
               dbo.disbursement_request dr
         where dr.member_id = %MEMBER_ID
           and dr.disbursement_id = disb.disbursement_id
           and disb.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and disb.recipient_key_value = NVL(%PERSON_ID,disb.recipient_key_value)
           and disb.disbursement_status = 'ST'
           and disb.disbursement_type = 'C')
 where rownum = 1",,Member
562,Outdated_Warrant_5,OUTDATED_WARRENT_5,"select check_no as Outdated_Warrant_Number5,
       to_char(warrant, 'mm/dd/yyyy') as Outdated_Warrant_Issue_Date5,
       trim(to_char(amount, '999,999,990.00')) as Outdated_Warrant_Amt5
  from (select lead(disb.disbursement_date, 4, null) over(order by disb.disbursement_id desc) as warrant,
               lead(disb.check_eft_no, 4, null) over(order by disb.disbursement_id desc) as check_no,
               lead(disb.disbursement_amt, 4, 0) over(order by disb.disbursement_id desc) as amount
          from dbo.disbursement         disb,
               dbo.disbursement_request dr
         where dr.member_id = %MEMBER_ID
           and dr.disbursement_id = disb.disbursement_id
           and disb.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and disb.recipient_key_value = NVL(%PERSON_ID,disb.recipient_key_value)
           and disb.disbursement_status = 'ST'
           and disb.disbursement_type = 'C')
 where rownum = 1",,Member
563,Outdated_Warrant_6,OUTDATED_WARRENT_6,"select check_no as Outdated_Warrant_Number6,
       to_char(warrant, 'mm/dd/yyyy') as Outdated_Warrant_Issue_Date6,
       trim(to_char(amount, '999,999,990.00')) as Outdated_Warrant_Amt6
  from (select lead(disb.disbursement_date, 5, null) over(order by disb.disbursement_id desc) as warrant,
               lead(disb.check_eft_no, 5, null) over(order by disb.disbursement_id desc) as check_no,
               lead(disb.disbursement_amt, 5, 0) over(order by disb.disbursement_id desc) as amount
          from dbo.disbursement         disb,
               dbo.disbursement_request dr
         where dr.member_id = %MEMBER_ID
           and dr.disbursement_id = disb.disbursement_id
           and disb.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and disb.recipient_key_value = NVL(%PERSON_ID,disb.recipient_key_value)
           and disb.disbursement_status = 'ST'
           and disb.disbursement_type = 'C')
 where rownum = 1",,Member
564,Outdated_Warrant_GRID_NEW,OUTDATED_WARRENT_GRID_NEW,"select to_char(disb.check_eft_no) warrant_number,
       '09-0791-553-4410-4612' state_accounting_number,
       to_char(disb.disbursement_date, 'mm/dd/yyyy') issue_date,
       '$'||trim(to_char(disb.disbursement_amt, '999,990.00')) warrant_amount
  from dbo.disbursement         disb,
               dbo.disbursement_request dr
         where dr.member_id = %MEMBER_ID
           and dr.disbursement_id = disb.disbursement_id
           and disb.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and disb.recipient_key_value = NVL(%PERSON_ID,disb.recipient_key_value)
   and disb.disbursement_status = 'ST'
   and disb.disbursement_type = 'C'",,Member
565,Ben Summ Notice of Recalc - Ret Re-emp,BEN_SUM_NOTI_RECALC_RR,"select Display_name as Descrip,
       Amount_01 as Last_Month,
       Amount_02 as Current_Month,
       Amount_03 as Next_Month 
       from table(CLIENT.f_get_ss_ben_sum_blk_noti_rr((select pa.parent_application_id
                                                  from dbo.pension_application pa
                                                 where pa.application_id =%PENSION_APPLICATION_ID), %PENSION_APPLICATION_ID))",,Member
566,Member Pension Investment,PENSION_INVESTMENT,"select '$'|| nvl(trim(to_char(to_number(nvl(d.s1 + d.s2, 0), '999990.00'), '999,999,990.00')), 0) as Pen_Inv
   from (Select client.f_get_pfv_value_number(pa.parent_application_id,
                                              'PN_NEW_ANNUITY') s1,
                client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,
                                              'PN_NEW_ANNUITY') s2
           from dbo.pension_option      po,
                dbo.pension_application pa,
                dbo.pension_option_type pot
          where pa.application_id = %PENSION_APPLICATION_ID
            and pa.pension_option_id = po.pension_option_id
            and po.pension_option_type_id = pot.pension_option_type_id) d",,Pension
567,PENSION_OPTION_1,PEN_OPTION_1,"select substr(pot.pension_option_type_desc, 0,8) option_type
  from dbo.pension_application pa,
       dbo.pension_option      po,
       dbo.pension_option_type pot,
       dbo.pension_type pt
 where pa.pension_option_id = po.pension_option_id
   and po.pension_option_type_id = pot.pension_option_type_id
   and pt.pension_type_id=po.pension_type_id
   and pt.pension_type_id=21
   and pa.application_id = %PENSION_APPLICATION_ID",,Member
568,Ben Summ Notice of Recalc - Ret Re-emp months,BEN_SUM_MON_NOT_RECALC_RR,"Select Amount_01 as Last_Month,
       Amount_02 as Current_Month,
       Amount_03 as Next_Month 
       from table(client.f_get_ss_ben_sum_month_noti_rr(%PENSION_APPLICATION_ID, %PERSON_ID))",,Pension
575,SSD Recalc letter,BEN_SS_SUMMARY_MONTHS_SSD,"select Display_name as Descrip,
       Amount_01 as Last_Month,
       Amount_02 as Current_Month,
       Amount_03 as Next_Month
       from table(CLIENT.f_get_ss_ben_summary_ssd_rr(%PENSION_APPLICATION_ID, %PERSON_ID))",,Pension
576,CA Percentage1,CA_PERCENTAGE1,"select trunc(replace(TRIM(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_6_CA_PERCENT_PCT')),'%','')) from dual",,Member
557,Payee_Complete_Address_New,PAYEE_COMPLETE_ADDRESS_NEW,"select decode(a.address_3, null, '', upper(a.address_3) || chr(10)) ||
       decode(a.address_1, null, '', upper(a.address_1)) ||
       decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
       chr(10) || upper(a.city) || ' ' || upper(a.state) || ' ' ||
       dbo.pkg_benefit_s.f_build_zipcode(a.zip) as payee_address,
	 nvl2(pa.first_name, upper(pa.first_name) || ' ', '') ||
       upper(pa.last_name) as payee_first_last_name
  from dbo.addresses a, dbo.person pa
 where a.key_value in (select x.key_value
                         from (select d.recipient_key_value as key_value
                                 from dbo.disbursement d, dbo.person p
                                where d.recipient_key_value = p.person_id
                                  and p.person_id = %PERSON_ID
                                  and d.recipient_entity_id =
                                      dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                                order by d.disbursement_id desc) x
                        where rownum = 1)
   and a.key_value=pa.person_id
   and a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                   a.key_value,
                                                   null,
                                                   'C,R')",,Member
556,Payee_First_Name_Last_Name_New,PAYEE_FIRST_LAST_NAME_NEW,"SELECT payee_first_last_name as payee_first_last_name
  FROM (select TRIM(nvl2(p.first_name, upper(p.first_name) || ' ', '') ||
                    upper(p.last_name)) as payee_first_last_name
          from dbo.person p
         where p.person_id = %PERSON_ID
        UNION
        select distinct (TRIM(nvl2(p.first_name, upper(p.first_name) || ' ', '') ||
            upper(p.last_name))) as payee_first_last_name
          from dbo.disbursement         disb,
               dbo.disbursement_request dr,
               dbo.person               p,
               dbo.pension_application  pa,
               dbo.business_entity_key  bek
         where dr.member_id = %MEMBER_ID
           and dr.disbursement_id = disb.disbursement_id
           and disb.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and disb.recipient_key_value = bek.key_value
           and p.person_id = disb.recipient_key_value
           and dr.source_entity_id = dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
           and dr.source_key_value = pa.application_id
           and pa.owner_business_entity_key_id = bek.business_entity_key_id
           and pa.parent_application_id is not null
           and pa.member_id = %MEMBER_ID
           and rownum = 1)
 WHERE rownum = 1",,Member
624,Beneficiary Death Date,BENEFICIARY_DEATH_DATE,"select p.death_date from dbo.person p where p.person_id = %PERSON_ID
union 
select p.death_date
  from dbo.pension_application pa,
       dbo.business_entity_key bek,
       dbo.person              p
 where pa.owner_business_entity_key_id = bek.business_entity_key_id
   and bek.key_value = p.person_id
   and bek.business_entity_type_id =  (select bet.business_entity_type_id from dbo.business_entity_type
      
bet where bet.internal_name='PARTICIPANT')
  
      and pa.application_id  = %PENSION_APPLICATION_ID",,Member
625,Beneficiary Info,BENEFICIARY_INFO,"select upper(bp.first_name) || case
when bp.last_name is not null THEN
' ' || upper(bp.last_name)
end beneficiary_name,
upper(trim(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
bp.PREFIX,
'Y',
'N') || ' ' ||
(bp.FIRST_NAME) || ' ' || (bp.middle_name) || ' ' ||
(bp.last_name) || ' ' ||
dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
bp.SUFFIX,
'Y',
'N'))) as Beneficiary_Full_Name,
bt.beneficiary_type_code,
to_char(be.start_date, 'mm/dd/rrrr') start_date,
dbo.pkg_benefit_s.f_get_value_description('RELATION',
lb.relation,
lb.relation,
'N') relation,
 nvl2(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                      bp.PREFIX,
                                                      'Y',
                                                      'N'),
            UPPER(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                            bp.PREFIX,
                                                            'Y',
                                                            'N')) || ' ',
            '') || UPPER(bp.FIRST_NAME) || ' ' ||
       nvl2(bp.middle_name, UPPER(bp.middle_name) || ' ', '') ||
       UPPER(bp.last_name) ||
       nvl2(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                      bp.SUFFIX,
                                                      'Y',
                                                      'N'),
            ' ' || dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                             bp.SUFFIX,
                                                             'Y',
                                                             'N'),
            '') as bene_name_space,
            upper(bp.first_name) || case
when bp.last_name is not null THEN
' ' || upper(bp.last_name)||':' 
end new_name , bp.death_date
from web.v_linked_beneficiaries lb,
dbo.beneficiary            be,
dbo.beneficiary_type       bt,
dbo.person                 bp,
DBO.Member                 m
where lb.alt_beneficiary_id = be.alt_beneficiary_id
and be.beneficiary_type_id = bt.beneficiary_type_id
and be.start_date <= trunc(sysdate)
and be.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
and lb.dependent_id = bp.person_id
and m.person_id = be.person_id
and m.member_id = %MEMBER_ID
order by bt.beneficiary_type_code, bp.last_name, bp.first_name
",,Pension
569,Complete_Address_Payee,COMPLETE_ADDRESS_PAYEE,"SELECT payee_address from (SELECT payee_address as payee_address
  FROM (select TRIM(decode(a.address_1, null, '', upper(a.address_1)) ||
                    decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
                    decode(a.address_3, null, '', chr(10) || upper(a.address_3)) || chr(10) ||
                    upper(a.city) || ' ' || upper(a.state) || ' ' ||
                    dbo.pkg_benefit_s.f_build_zipcode(a.zip)) as payee_address,'A' seq
                                            from dbo.addresses a, dbo.person p
                                            where p.person_id = (select bek.key_value
                                            from dbo.business_entity_key bek
                                           where bek.business_entity_key_id =
                                                 (select pa.owner_business_entity_key_id
                                                    from dbo.pension_application pa
                                                   where pa.application_id = nvl(%PENSION_APPLICATION_ID,0)))
                                            and  a.address_id =  dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'), p.person_id, 'R')
 UNION
             select TRIM(decode(a.address_1, null, '', upper(a.address_1)) ||
                    decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
                    decode(a.address_3, null, '', chr(10) || upper(a.address_3)) || chr(10) ||
                    upper(a.city) || ' ' || upper(a.state) || ' ' ||
                    dbo.pkg_benefit_s.f_build_zipcode(a.zip)) as payee_address,'B' seq
          from dbo.addresses a
         where a.key_value = %PERSON_ID
           and a.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and a.address_id =
               dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                            a.key_value,
                                            null,
                                            'C,R')

          and rownum = 1                                           
 UNION
       select distinct (TRIM(decode(a.address_1, null, '', upper(a.address_1)) ||
                    decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
                    decode(a.address_3, null, '', chr(10) || upper(a.address_3)) || chr(10) ||
                    upper(a.city) || ' ' || upper(a.state) || ' ' ||
                    dbo.pkg_benefit_s.f_build_zipcode(a.zip))) as payee_address,'C' seq
  from dbo.addresses a, dbo.member m
 where m.member_id = %MEMBER_ID
   and a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                   m.person_id,
                                                   null,
                                                   'C,R') )
          where payee_address is not null
          order by seq) where rownum = 1",,Member
570,Payee_Full_Name,PAYEE_FULL_NAME,"SELECT payee_first_last_name as payee_first_last_name
  FROM (select TRIM(nvl2(p.first_name, upper(p.first_name) || ' ', '') ||
                    upper(p.last_name)) as payee_first_last_name
  from dbo.pension_application pa,
       dbo.pension_option      po,
       dbo.pension_type        pt,
       dbo.business_entity_key bek,
       dbo.person              p
 where pa.application_id = nvl(%PENSION_APPLICATION_ID,0)-----NG
   and pa.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and bek.business_entity_key_id = pa.owner_business_entity_key_id
   and bek.key_value = p.person_id
   UNION
  select distinct (TRIM(nvl2(p.first_name, upper(p.first_name) || ' ', '') ||
            upper(p.last_name))) as payee_first_last_name
          from dbo.disbursement         disb,
               dbo.disbursement_request dr,
               dbo.person               p,
               dbo.pension_application  pa,
               dbo.business_entity_key  bek
         where dr.member_id = %MEMBER_ID
           and dr.disbursement_id = disb.disbursement_id
           and disb.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and disb.recipient_key_value = bek.key_value
           and p.person_id = disb.recipient_key_value
           and dr.source_entity_id = dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
           and dr.source_key_value = pa.application_id
           and pa.owner_business_entity_key_id = bek.business_entity_key_id
           and pa.parent_application_id is not null
           and pa.member_id = %MEMBER_ID
            UNION
   select TRIM(nvl2(p.first_name, upper(p.first_name) || ' ', '') ||
                    upper(p.last_name)) as payee_first_last_name
          from dbo.person p
         where p.person_id = %PERSON_ID
                 and rownum = 1)
 WHERE rownum = 1",,Member
571,EFT Bank Address,EFT_BANK_ADDRESS,"select ea.bank_name,
                                                                   ad.address_1,
                                                                   ad.address_2,
                                                                   ad.city,
                                                                   ad.state,
                                                                   dbo.pkg_benefit_s.f_build_zipcode(ad.zip)
                                                              from dbo.eft_authorization_header eah,
                                                                   dbo.eft_authorization        ea,
                                                                   dbo.oi_organization          oo,
                                                                   dbo.addresses                ad
                                                             where eah.eft_authorization_header_id = ea.eft_authorization_header_id
                                                               and eah.source_entity_id = dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                                                               and eah.source_key_value = %PENSION_APPLICATION_ID
                                                               and trunc(sysdate) between eah.start_date and
                                                                   nvl(eah.end_date, trunc(sysdate)+1)
                                                               and eah.recipient_entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                                                               and eah.recipient_key_value = (select b.beneficiary_id from dbo.beneficiary b where b.person_id=%PERSON_ID)
                                                               and ea.oi_organization_id = oo.oi_organization_id
                                                               and ad.entity_id = dbo.pkg_benefit_s.f_get_entity_id('OI_ORGANIZATION')
                                                               and ad.key_value = oo.oi_organization_id
                                                               and trunc(sysdate) between ad.start_date and
                                                                   nvl(ad.stop_date, trunc(sysdate)+1)",,Pension
572,Beneficiary Demographic Info,BENEFICIARY_DEMOGR_INFO,"select TO_CHAR(p.birth_date, 'MM/DD/YYYY') as birthDate,
 TO_CHAR(p.death_date, 'MM/DD/YYYY') as DeathDate,
 REPLACE(TO_CHAR(p.ssn, '000,99,9999'),',', '-') as ssn,
 UPPER(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                 P.PREFIX,
                                                 'Y',
                                                 'N') || ' ' ||
       (P.FIRST_NAME) || ' ' ||
       NVL2(P.MIDDLE_NAME, p.middle_name || ' ', p.middle_name) ||
       (p.last_name) ||
       NVL2(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                      P.SUFFIX,
                                                      'Y',
                                                      'N'),
            dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                      ' ' || P.SUFFIX,
                                                      'Y',
                                                      'N'),
            rtrim(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                            P.SUFFIX,
                                                            'Y',
                                                            'N')))) as Name_Upper,
 INITCAP(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                   P.PREFIX,
                                                   'Y',
                                                   'N') || ' ' ||
         (P.FIRST_NAME) || ' ' ||
         NVL2(P.MIDDLE_NAME, p.middle_name || ' ', p.middle_name) ||
         (p.last_name) ||
         NVL2(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                        P.SUFFIX,
                                                        'Y',
                                                        'N'),
              dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                        ' ' || P.SUFFIX,
                                                        'Y',
                                                        'N'),
              rtrim(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                              P.SUFFIX,
                                                              'Y',
                                                              'N')))) Name_Initcap
                                                        from dbo.person p
                                                        where p.person_id = %PERSON_ID",,Member
573,Overpayment Month Year and Net Amount,OVERPAY_MONTH_YR_NET_AMT,"select Display_name as Month_Year, Amount_01 as Net_Amount
                                                             from table(CLIENT.f_Get_Over_Pay_Amt_Bookmark(%PENSION_APPLICATION_ID))",,Pension
574,Total Overpayment Recovery Amount,TOTAL_OVERPAY_RECV_AMT,"SELECT '$'||trim( to_char(nvl(SUM(Amount_02), 0),'999,999,999.99'))
                                                              FROM table(client.f_get_over_pay_amt_bookmark(%PENSION_APPLICATION_ID))",,Pension
577,Service Block,SERVICE_BLOCK,"Select TRIM(TO_CHAR((client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_REG_ERSC_DISPLAY')+
            client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_REG_PRSC_DISPLAY'))/12, '999,999,990.99')) as ANN_REG_SERVICE,
       TRIM(TO_CHAR((client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_SHR_PRSC_DISPLAY')+
            client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_SHR_ERSC_DISPLAY'))/12, '999,999,990.99')) as ANN_SHRF_SERVICE ,
       TRIM(TO_CHAR((client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_PRT_ERSC_DISPLAY')+
            client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_PRT_PRSC_DISPLAY'))/12, '999,999,990.99')) as ANN_PRO_SERVICE from dual",,Member
589,AE Lump Sum Amount(Total Inv) With some text ,AE_LUMPSUM_AMT_TOT_INV_WITH_SOME_TEXT,"select trim('eligible to receive a one-time AE retirement benefit of $'||NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_TOTAL_INV'),'0.00'))||' (the nontaxable portion is $'||NVL(client.f_get_federal_tax_amt(%MEMBER_ID,'FP'),'0.00')||'). If you want to apply for this payment, please call us and request an AE application.' as FME from dual",116,Member
590,AE Estimate - MP Option 2 Present age,AE_MP_OPTION2_PRESENT_AGE,"select trim('$'||client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2_MP')) from dual",116,Member
591,DIRECT_DEPOSIT_EFT_INFO_NAME_BM,DIRECT_DEPOSIT_EFT_INFO_NAME_BM,"SELECT payee_first_last_name,
       routing_num,
       rec_acc_type,
       rec_acc_num,
       bank_name,
       dd_change_eff_month,
       rec_acc_type_new
  FROM (select payee_first_last_name,
               routing_num,
               rec_acc_type,
               rec_acc_num,
               bank_name,
               trim(to_char(inserted_date, 'Month')) dd_change_eff_month,
               rec_acc_type_new
          from (select (TRIM(nvl2(p.first_name,
                                  upper(p.first_name) || ' ',
                                  '') || upper(p.last_name))) as payee_first_last_name,
                       lpad(ea.routing_no, 9, '0') as routing_num,
                       decode(nvl(ea.recipient_account_type, 'C'),
                              'C',
                              'checking',
                              'S',
                              'savings') as rec_acc_type,
                       ea.recipient_account_no as rec_acc_num,
                       ea.bank_name as bank_name,
                       ea.inserted_date as inserted_date,
                       decode(nvl(ea.recipient_account_type, 'C'),
                              'C',
                              'Checking',
                              'S',
                              'Savings') as rec_acc_type_new
                  from dbo.person                   p,
                       dbo.eft_authorization        ea,
                       dbo.eft_authorization_header eah
                 where p.person_id = NVL(%PERSON_ID,
                           (select bek.key_value
                              from dbo.pension_application pa,
                                   dbo.business_entity_key bek
                             where pa.application_id = %PENSION_APPLICATION_ID
                               and pa.owner_business_entity_key_id =
                                   bek.business_entity_key_id))                
                   and ea.recipient_key_value = p.person_id
                   and ea.recipient_entity_id =
                       dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                   and ea.eft_authorization_header_id =
                       eah.eft_authorization_header_id
                  -- and trunc(sysdate) between eah.start_date and
                  --     nvl(eah.end_date, sysdate)
                     and ea.eft_approval_status='A')
         order by inserted_date desc)
 where rownum = 1",,Member
593,Direct Deposit Eft Info Name BM1,DIRECT_DEPOSIT_EFT_INFO_NAME_BM1,"SELECT payee_first_last_name,
       routing_num,
       rec_acc_type,
       rec_acc_num,
       bank_name,
       dd_change_eff_month
  FROM (select payee_first_last_name,
               routing_num,
               rec_acc_type,
               rec_acc_num,
               bank_name,
               trim(to_char(inserted_date, 'Month')) dd_change_eff_month
          from (select (TRIM(nvl2(p.first_name,
                                  upper(p.first_name) || ' ',
                                  '') || upper(p.last_name))) as payee_first_last_name,
                       lpad(ea.routing_no, 9, '0') as routing_num,
                       decode(nvl(ea.recipient_account_type, 'C'),
                              'C',
                              'checking',
                              'S',
                              'savings') as rec_acc_type,
                       ea.recipient_account_no as rec_acc_num,
                       ea.bank_name as bank_name,
                       ea.inserted_date as inserted_date
                  from dbo.member          m,
                       dbo.person               p,
                       dbo.eft_authorization    ea,
                       dbo.eft_authorization_header    eah
                 where m.person_id = p.person_id
                   and m.member_id = %MEMBER_ID
                   and ea.recipient_key_value = p.person_id
                   and ea.recipient_entity_id =
                       dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                   and ea.eft_authorization_header_id = eah.eft_authorization_header_id
                   and trunc(sysdate) between eah.start_date and nvl(eah.end_date, sysdate)  )
         order by inserted_date desc)
 where rownum = 1",85,Member
594,Monthly Benefits Paid,MONTHLY_BENEFITS_PAID,"SELECT TRIM(to_char(NVL(SUM(dr.gross_amt), 0), '$999,999,990.99PR')) MonthlyBenefitspaid
  FROM dbo.disbursement d, dbo.disbursement_request dr
 WHERE d.disbursement_id = dr.disbursement_id
   AND d.disbursement_status IN ('I', 'R', 'C')
   AND dr.source_entity_id =
       dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
   AND dr.source_key_value = %PENSION_APPLICATION_ID",116,Member
578,Ben Summary AP Notice of Recalc,BEN_SUM_AP_NOTI_RECALC,"select Display_name as Descrip,
       Amount_01 as Last_Month,
       Amount_02 as Current_Month,
       Amount_03 as Next_Month 
       from table(CLIENT.f_get_ss_ben_sum_blk_ap_recalc(%PENSION_APPLICATION_ID, %PERSON_ID))",,Member
579,FME_PARENT_PEN_ID,FME_PARENT_PEN_ID,"select pa_prim.custom_date_05
  from dbo.pension_application pa_sec, dbo.pension_application pa_prim
 where pa_sec.application_id = %PENSION_APPLICATION_ID
   and pa_sec.parent_application_id = pa_prim.application_id",,Pension
581,Complete Address pension_app_id,COMPLETE_ADDRESS,"select address_1, address_2, address_3, city_state_zip, phone1,  city_state_zip_new

  from (select trim(a.address_1) as address_1,
               trim(a.address_2) as address_2,
               trim(a.address_3) as address_3,
               a.city || ' ' || a.state || ' ' ||dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_zip,
               nvl((REPLACE(TO_CHAR(a.phone_1, '000,999,9999'), ',', '-')), '') as phone1, --NG
               a.city || ', ' || a.state || ' ' ||dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_zip_new
          from dbo.addresses a, dbo.person p
         where a.address_id =
               dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                            p.person_id,
                                            'R')
           and p.person_id =
               (select bek.key_value
                  from dbo.business_entity_key bek
                 where bek.business_entity_key_id =
                       (select pa.owner_business_entity_key_id
                          from dbo.pension_application pa
                         where pa.application_id = %PENSION_APPLICATION_ID))
        UNION         
        select trim(a.address_1) as address_1,
               trim(a.address_2) as address_2,
               trim(a.address_3) as address_3,
               a.city || ' ' || a.state || ' ' ||
               dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_zip,
               nvl((REPLACE(TO_CHAR(a.phone_1, '000,999,9999'), ',', '-')), '') as phone1,  --NG
               a.city || ', ' || a.state || ' ' ||dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_zip_new
           from dbo.addresses a
         where a.key_value = %PERSON_ID
           and a.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and a.address_id =
               dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                            a.key_value,
                                            null,
                                            'C,R')) where rownum=1",,Member
582,Complete Name pension_app_id,COMPLETE_NAME,"SELECT TRIM(payee_first_last_name) as payee_first_last_name FROM (select upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                       P.PREFIX,
                                                       'Y',
                                                       'N')) || ' ' ||
       upper(p.first_name) || ' ' || upper(p.middle_name) || ' ' ||
       upper(p.last_name) || ' ' ||
       upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                       P.SUFFIX,
                                                       'Y',
                                                       'N')) as payee_first_last_name
  from dbo.pension_application pa,
       dbo.pension_option      po,
       dbo.pension_type        pt,
       dbo.business_entity_key bek,
       dbo.person              p
 where pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and bek.business_entity_key_id = pa.owner_business_entity_key_id
   and bek.key_value = p.person_id 
   UNION
   select upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                       P.PREFIX,
                                                       'Y',
                                                       'N')) || ' ' ||
       upper(p.first_name) || ' ' || upper(p.middle_name) || ' ' ||
       upper(p.last_name) || ' ' ||
       upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                       P.SUFFIX,
                                                       'Y',
                                                       'N')) as  payee_first_last_name
          from dbo.person p
         where p.person_id = %PERSON_ID) where rownum=1",,Member
583,Pension Benefit Info1,PENSION_BENEFIT_INFO1,"select trim(to_char(to_date(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FME'),'mm/dd/yyyy'),'Month')) 
as FME from dual",116,Member
584,Ben Summ AMDB Notice of Recalc - Months,BEN_SUM_MON_NOT_RECALC_AMDB,"Select Amount_01 as Last_Month,
       Amount_02 as Current_Month,
       Amount_03 as Next_Month 
       from table(client.f_Get_Ss_Ben_Sum_Blk_amdb_mon(%PENSION_APPLICATION_ID))",,Member
585,Ben Summ AMDB Notice of Recalc,BEN_SUM_AMDB_NOTI_RECALC,"select Display_name as Descrip,
       Amount_01 as Last_Month,
       Amount_02 as Current_Month,
       Amount_03 as Next_Month 
       from table(CLIENT.f_Get_Ss_Ben_Sum_Blk_amdb_Rr(%PENSION_APPLICATION_ID, %PERSON_ID))",,Member
586,Retired Reemployed Option 2,OPTION_2_RR,"select '$' || nvl(trim(to_char(to_number(nvl(AKA.parent_app_id + AKA.pa_app_id, 0), '999990.00'),
                               '999,999,990.00')),
                  0) as OPTION_2
  from (Select client.f_get_pfv_value_number(pa.parent_application_id,
                                             'PN_TOTAL_MEM_INV') parent_app_id,
               client.f_get_pfv_value_number(%PENSION_APPLICATION_ID, 'PN_TOTAL_MEM_INV') pa_app_id
          from dbo.pension_application pa
         where pa.application_id = %PENSION_APPLICATION_ID) AKA",,Member
587,Retired Reemployed Option 6,OPTION_6_RR,"select '$' || nvl(trim(to_char(to_number(nvl(AKA.parent_app_id + AKA.pa_app_id, 0), '999990.00'),
                               '999,999,990.00')),
                  0) as OPTION_6
  from (Select client.f_get_pfv_value_number(pa.parent_application_id,
                                             'PN_WIN_OP_2_REGULAR') parent_app_id,
               client.f_get_pfv_value_number(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2_RER') pa_app_id
          from dbo.pension_application pa
         where pa.application_id = %PENSION_APPLICATION_ID) AKA",,Member
542,Preliminary Letter Benefit Info 2,PENSION_BENEFIT_INFO_2,"select client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FME') as FME,client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_YRS_CS_DISPLAY') as YOS,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_1_PA_ACT_DTH_BENE'), '0.00') as OPTION1,'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OP1_DEATH_BENE'), '0.00') as OPTION1_DB,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_3_PA_BENE'), '0.00') as OPTION_3,'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_4_PA_BENE'),'0.00') as OPTION_4,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_5_PA_BENE'),'0.00') as OPTION_5,'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_6_PRES_AGE'),'0.00') as OPTION_6,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_SS_BENE'),'0.00') as SS_BENEFIT,'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_7_PRE_62_BENE'),'0.00') as PRE62_OPTION7,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_7_POST_62_BENE'),'0.00') as POST62_OPTION7,client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_7_POST_62_CA') as POST62_CA_OPTION7,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_INV_SECTION_TOTAL_MEM_INV'),'0.00') as MEM_INVEST,to_number(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_4_CA_PERCENT')) as CA_PERCENT,                                                                    
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2_REGULAR'),'0.00') as OPTION_2,'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FAS'),'0.00') as WIN_AVG_SAL,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_REG_TTSC_DISPLAY')/12 as ANN_REG_SERVICE,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_SHR_TTSC_DISPLAY')/12 as ANN_SHRF_SERVICE,client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_PRT_TTSC_DISPLAY')/12 as ANN_PRO_SERVICE,client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_DISABILITY_DATE') as DISABILITY_DATE,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_LAST_PAID_DATE')||'.' as LAST_PAID_DATE,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_EFM_MET') as EFM_MET,
to_number(trim(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_6_CA_PERCENT'))) as OPT6_CA_PERCENT,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_DISABILITY') as DISABILITY_FLAG,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2') as OPTION_2_AMT,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_MP_ELIGIBLE') as OPTION_2_MPF,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2_MP') as OPT2_MPF_AMT,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_MONTHLY_ANNUITY_AMT') as MONTHLY_ANNUITY_AMT,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2_REGULAR'),'0.00')||'.' as OPTION_2_1,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_7_POST_62_BENE'),'0.00')||',' as POST62_OPTION7_1,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_SS_BENE'),'0.00')||'.' as SS_BENEFIT_1,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_INV_SECTION_TOTAL_MEM_INV'),'0.00')||',' as MEM_INVEST_1,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_7_PRE_62_BENE'),'0.00') as PRE62_OPTION7_1,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2_MP'),'0.00') as OPT2_MPF_AMT_1,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_WIN_OP_2'),'0.00') as OPTION_2_AMT_1,
'$'||trim(to_char(NVL(client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,'PN_INV_SECTION_TOTAL_MEM_INV'), 0) +
       NVL(client.f_get_pfv_value_number((Select pa.parent_application_id from dbo.pension_application pa where pa.application_id = %PENSION_APPLICATION_ID),
'PN_INV_SECTION_TOTAL_MEM_INV'), 0), '999,999,990.00')) as MEM_INVEST_2,
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_OPT_5_EXPIRE_DATE') as OPTION5_SSD_REC,
'$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_MONTHLY_ANNUITY_AMT'),'0.00') as MONTHLY_ANNUITY_AMT_NEW  from dual",,Member
588,Other Member Info,OTHER_MEMBER_INFO,"SELECT TRIM(dv.custom_comments)
     FROM dbo.datasheet_value dv
    WHERE dv.datasheet_id =
          dbo.pkg_benefit_ds.f_get_datasheet_id(p_ds_name => 'DS_OTHER_MEMBER_INFORMATION')
      AND dv.owner_id =
          dbo.pkg_benefit_ds.f_get_owner_id(pv_owner_name => 'MEMBER')
      AND dv.key_value = %MEMBER_ID
      AND dv.attribute_id =
          dbo.pkg_benefit_s.f_get_attribute_id(attrib => 'DS_LEGACY_BENEFICIARY_STMT')",,Member
595,Remaining Investment,REMAINING_INVESTMENT,"SELECT (SELECT to_number(NVL(client.pkg_client_functions.f_get_pension_formuale_value(pa.application_id,
                                                                                      'PN_INV_SECTION_TOTAL_MEM_INV',
                                                                                      pa.pension_option_id),
                             0))
          FROM dbo.pension_application pa
         WHERE pa.application_id = %PENSION_APPLICATION_ID) -
       (SELECT NVL(SUM(dr.gross_amt), 0) paid_amt
          FROM dbo.disbursement d, dbo.disbursement_request dr
         WHERE d.disbursement_id = dr.disbursement_id
           AND d.disbursement_status in ('I', 'R', 'C')
           AND dr.source_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
           AND dr.source_key_value = %PENSION_APPLICATION_ID) AS Remaininginvestment
  FROM dual",116,Member
596,Person firstName,PERSON_FIRSTNAME,"SELECT p.first_name,
       p.last_name,
       RTRIM(XMLELEMENT(""tables"", XMLAGG(XMLELEMENT(""table"", sd.department_name || ', '))).extract('//table/text()')
             .getstringval(),
             ', ') title
  FROM dbo.person              p,
       dbo.security_users      su,
       dbo.security_role_user  sru,
       dbo.security_department sd
 WHERE p.person_id = su.person_id
   and su.security_users_id = %SECURITY_USERS_ID
   AND su.security_users_id = sru.security_users_id
   AND sru.department_id = sd.department_id
 GROUP BY p.first_name, p.last_name",116,Member
597,Original Ivestment,ORIGINAL_INVESTMENT,"SELECT TRIM(to_char(NVL(client.pkg_client_functions.f_get_pension_formuale_value(pa.application_id,
                                                                                 'PN_INV_SECTION_TOTAL_MEM_INV',
                                                                                 pa.pension_option_id),
                        0),
                    '$999,999,990.99PR')) AS originalInvestment
  FROM dbo.pension_application pa
 WHERE pa.application_id = %PENSION_APPLICATION_ID",116,Member
605,Current Payroll Date1,CURRENT_PAYROLL_DATE1,"select to_char(client.pkg_client_functions.f_get_fmp_date, 'fmMonth yyyy') from dual",,Pension
604,Pension Primary beneficary count,PENSION_PRIMARY_BENE_COUNT,"select case
         when count(*)=0 then
          'NONE'
         else
          null
       end from(select UPPER(x.name) as P_ben_name, x.birth_date
      from (select b.beneficiary_type_id,
                   nvl2(p.first_name, initcap(p.first_name) || ' ', '') ||
                   nvl2(p.last_name, initcap(p.last_name), '') as name,
                   p.birth_date
              from dbo.pension_beneficiary pb,
                   dbo.beneficiary         b,
                   dbo.pension_application pa,
                   dbo.member              m,
                   dbo.person              p,
                   dbo.beneficiary_type    bt
             where pb.application_id = pa.application_id
               and pa.application_id = %PENSION_APPLICATION_ID
               and pb.alt_beneficiary_id = b.alt_beneficiary_id
               and b.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
               and b.key_value = p.person_id
               and b.beneficiary_type_id = bt.beneficiary_type_id
               and b.stop_date is null
               and bt.beneficiary_type_code = 'Primary'
            union
            select b.beneficiary_type_id,
                   nvl2(p.first_name, initcap(p.first_name) || ' ', '') ||
                   nvl2(p.middle_name, initcap(p.middle_name) || ' ', '') ||
                   nvl2(p.last_name, initcap(p.last_name), '') as name,
                   p.birth_date
              from dbo.pension_beneficiary pb,
                   dbo.beneficiary         b,
                   dbo.pension_application pa,
                   dbo.member              m,
                   dbo.person              p,
                   dbo.beneficiary_type    bt,
                   dbo.oi_person           op
             where pb.application_id = pa.application_id
               and pa.application_id = %PENSION_APPLICATION_ID
               and pb.alt_beneficiary_id = b.alt_beneficiary_id
               and p.person_id = op.person_id
               and b.beneficiary_type_id = bt.beneficiary_type_id
               and b.entity_id =
                   dbo.pkg_benefit_s.f_get_entity_id('OI_PERSON')
               and op.oi_person_id = b.key_value
               and b.stop_date is null
                      and bt.beneficiary_type_code ='Primary'
            union
            select b.beneficiary_type_id,
                   initcap(oo.oi_name) as name,
                   null birth_date
              from dbo.pension_beneficiary pb,
                   dbo.beneficiary         b,
                   dbo.pension_application pa,
                   dbo.member              m,
                   dbo.beneficiary_type    bt,
                   dbo.oi_organization     oo
             where pb.application_id = pa.application_id
               and pa.application_id = %PENSION_APPLICATION_ID
               and pb.alt_beneficiary_id = b.alt_beneficiary_id
               and b.beneficiary_type_id = bt.beneficiary_type_id
               and b.entity_id =
                   dbo.pkg_benefit_s.f_get_entity_id('OI_ORGANIZATION')
               and oo.oi_organization_id = b.key_value
               and b.stop_date is null) x)",,Member
540,Member Info Upper 1,MEMBER_INFO_UPPER_1,"select upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N')) ||' '|| upper(P.FIRST_NAME) ||' '|| upper(p.middle_name) ||' '|| 
                                   upper(p.last_name) ||' '|| upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N')) as memberName,upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',P.PREFIX,'Y','N')) as prefix, upper(p.first_name) 
                                   as firstName, upper(p.middle_name) as middleName, TRIM(upper(p.last_name))||':' as lastName, upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',P.SUFFIX,'Y','N')) as suffix, 
                                   p.birth_date as birthDate, upper(p.sex) as sex, p.alt_identifier as altId, upper(p.status) as status, p.ssn as ssn, nvl2(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                            P.PREFIX,
                                                            'Y',
                                                            'N'),
            UPPER(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                            P.PREFIX,
                                                            'Y',
                                                            'N')) || ' ',
            '') || UPPER(P.FIRST_NAME) || ' ' ||
       nvl2(p.middle_name, UPPER(p.middle_name)|| ' ',
       '') || UPPER(p.last_name) ||
       nvl2(P.SUFFIX, ' ' || P.SUFFIX || ':', ':') as member_name_space,
       'Member ID: '||p.alt_identifier as altId_concat,
       add_months(p.birth_date, 840) age_plus_70yrs,
       nvl2(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                            P.PREFIX,
                                                            'Y',
                                                            'N'),
            UPPER(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                            P.PREFIX,
                                                            'Y',
                                                            'N')) || ' ',
            '') || UPPER(P.FIRST_NAME) || ' ' ||
       nvl2(p.middle_name, UPPER(p.middle_name)|| ' ',
       '') || UPPER(p.last_name) ||
       nvl2(P.SUFFIX, ' ' || P.SUFFIX ,'') as header_member_name,   ---NG4    
       p.alt_identifier||' ' as altId_new
                                   from dbo.member m, dbo.person p 
                                   where m.member_id = %MEMBER_ID and p.person_id = m.person_id",,Member
606,payroll date,PAYROLL_DATE,"select to_char(client.pkg_client_functions.f_get_fmp_date, 'fmMonth yyyy') from dual",,Member
607,Years of service,YOS,"select YOS_DATE
  from (select trim(to_char(pad.period_to_date, 'fmMonth yyyy')) as YOS_DATE
          from dbo.part_acct_detail_summary pads,
       dbo.part_account_detail      pad,
       dbo.part_account             pa,
       dbo.part_acct_dtl_type_cat   padtc,
       dbo.part_account_detail_type padt
 where pads.part_account_id = pa.part_account_id
   and pad.part_acct_detail_summary_id = pads.part_acct_detail_summary_id
   and padtc.part_acct_dtl_type_cat_id = padt.part_acct_dtl_type_cat_id
   and padt.part_account_detail_type_id = pad.part_account_detail_type_id
   and pa.member_id = %MEMBER_ID 
   and padt.internal_name = 'CB'
   and pad.wages > 0 
 order by pad.period_to_date desc)
 where rownum = 1",,Member
608,Refund Overpayment Details,REFUND_OVER_PAYMENT_DTLS,"select to_number(f.rate_value_06) as Gross,
                                                             f.rate_value_07 as FederalTax,
                                                             f.rate_value_08 as StateTax,
                                                             f.rate_value_06 - (nvl(f.rate_value_07,0) + nvl(f.rate_value_08,0)) as NetAmt,
                                                             decode(trim(to_char(sysdate,'yyyy')), trim(to_char(f.rate_value_05)),'A','B') as CondRefund,
                                                             (select ppr.date_04 from dbo.pension_preapp ppr where ppr.pension_application_id=%PENSION_APPLICATION_ID) AS AppDate
                                                             from dbo.factor f, dbo.factor_definition fd, dbo.member m, dbo.person p
                                                             where fd.factor_name like 'BF Violation Overpayment'
                                                             and fd.factor_id = f.factor_id 
                                                             and m.member_id = %MEMBER_ID
                                                             and m.person_id = p.person_id
                                                             and p.ssn = f.rate_value_02
                                                             and f.rate_value_01 = 'Refund'
                                                             and f.rate_value_05 = trim(to_char(%TAX_YEAR))",,Member
627,Service Block LC,SERVICE_BLOCK_LC,"Select TRIM(TO_CHAR((NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                 'PN_REG_ERSC_DISPLAY'),
                          0) + NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                            'PN_POST_REG_ERSC_DISPLAY'),
                                     0) + NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                                       'PN_REG_PRSC_DISPLAY'),
                                                0) +
                    NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                 'PN_POST_REG_PRSC_DISPLAY'),
                          0)) / 12,
                    '999,999,990.99')) as ANN_REG_SERVICE,
       TRIM(TO_CHAR((NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                 'PN_SHR_ERSC_DISPLAY'),
                          0) + NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                            'PN_POST_SHR_ERSC_DISPLAY'),
                                     0) + NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                                       'PN_SHR_PRSC_DISPLAY'),
                                                0) +
                    NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                 'PN_POST_SHR_PRSC_DISPLAY'),
                          0)) / 12,
                    '999,999,990.99')) as ANN_SHRF_SERVICE,
       TRIM(TO_CHAR((NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                 'PN_PRT_ERSC_DISPLAY'),
                          0) + NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                            'PN_POST_PRT_ERSC_DISPLAY'),
                                     0) + NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                                       'PN_PRT_PRSC_DISPLAY'),
                                                0) +
                    NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                 'PN_POST_PRT_PRSC_DISPLAY'),
                          0)) / 12,
                    '999,999,990.99')) as ANN_PRO_SERVICE

  from dual",,Member
628,Service Block LC Display Condition,SERVICE_BLOCK_LC_DISPLAY,"select nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_REG_ERSC_DISPLAY'), 0) PRE_EARNED_CREDITS_REG,
       nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_POST_REG_ERSC_DISPLAY'), 0) POST_EARNED_CREDITS_REG,
       nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_SHR_ERSC_DISPLAY'), 0) PRE_EARNED_CREDITS_SHE,
       nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_POST_SHR_ERSC_DISPLAY'), 0) POST_EARNED_CREDITS_SHE,
       nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_PRT_ERSC_DISPLAY'), 0) PRE_EARNED_CREDITS_PRO,
       nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_POST_PRT_ERSC_DISPLAY'), 0) POST_EARNED_CREDITS_PRO,
       nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_REG_PRSC_DISPLAY'), 0) PRE_PURCHASED_CREDITS_REG,
       nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_POST_REG_PRSC_DISPLAY'), 0) POST_PURCHASED_CREDITS_REG,
       nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_SHR_PRSC_DISPLAY'), 0) PRE_PURCHASED_CREDITS_SHE,
       nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_POST_SHR_PRSC_DISPLAY'), 0) POST_PURCHASED_CREDITS_SHE,
       nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_PRT_PRSC_DISPLAY'), 0) PRE_PURCHASED_CREDITS_PRO,
       nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_POST_PRT_PRSC_DISPLAY'), 0) POST_PURCHASED_CREDITS_PRO
  from dual",,Member
629,Winning Average Salary SS LC,WIN_AVG_SAL_LC,"Select '$'||trim(nvl(to_char(sum(nvl(pfv.value, 

0)),'999,999,990.00'),'0.00')) as win_avg_sal
  from dbo.pension_formula_value pfv, dbo.pension_application pa, dbo.pension_option po, dbo.pension_type pt
 where pfv.application_id = pa.application_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and pa.pension_option_id = pfv.pension_option_id
   and pfv.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPSSDIS'
   and pfv.business_rule_id in
       (select br.business_rule_id
          from dbo.business_rule br
         where br.internal_name in
               ('PN_FAS_SS'))",,Member
616,BENE_INFORMATION,BENE_INFORMATION,"Select UPPER(decode(trim(a.address_3),
                    null,
                    null,
                    trim(a.address_3) || chr(10)) || trim(a.address_1) ||
             chr(10) || decode(trim(a.address_2),
                               null,
                               null,
                               trim(a.address_2) || chr(10)) || a.city || '  ' ||
             a.state || ' ' || dbo.pkg_benefit_s.f_build_zipcode(a.zip)) as member_address,
case --NG2
when a.country = 'US' then
 TRIM(decode(a.address_3,
             null,
             '',
             upper(a.address_3) || chr(10)) ||
      decode(a.address_1, null, '', upper(a.address_1)) ||
      decode(a.address_2,
             null,
             '',
             chr(10) || upper(a.address_2)) || chr(10) ||
      upper(a.city) || ' ' || upper(a.state) || ' ' ||
      dbo.pkg_benefit_s.f_build_zipcode(a.zip))
else
 TRIM(decode(a.address_3,
          null,
          '',
          upper(a.address_3) || chr(10)) ||
   decode(a.address_1, null, '', upper(a.address_1)) ||
   decode(a.address_2,
          null,
          '',
          chr(10) || upper(a.address_2)) || chr(10) ||
   upper(a.city) ||
   (select case
             when upper((Select upper(s.state_name)
                          from dbo.state s, dbo.country c
                         where s.country_id = c.country_id
                           and c.country_code = a.country
                           and s.state_code = a.state)) is not null then
              ', ' ||
              upper((Select upper(s.state_name)
                      from dbo.state s, dbo.country c
                     where s.country_id = c.country_id
                       and c.country_code = a.country
                       and s.state_code = a.state))
             else
              ''
           end
      from dual) ||
      (select case
             when a.postal_code  is not null then
              ', ' ||
              a.postal_code
             else
              ''
           end
      from dual)|| chr(10) ||
   upper((Select upper(c.country_name)
           from dbo.country c
          where c.country_code = a.country)))
end as complete_address,
a.country
  from dbo.beneficiary      b,
       dbo.v_member_q       vmq,
       dbo.person           p,
       dbo.beneficiary_type bt,
       dbo.addresses a
 where vmq.member_id = %MEMBER_ID
   and vmq.person_id = b.person_id
   and p.person_id = b.beneficiary_id
   and b.beneficiary_type_id = bt.beneficiary_type_id
   and bt.beneficiary_type_code = 'Primary'
   and a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                   b.beneficiary_id,
                                                   'R')
   and rownum = 1",,Member
630,Winning Average Salary based on Category,WAS_BASED_ON_CATEGORY,"select '$'||nvl(decode(client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_CAL_CAT'), 'Sheriff Deputy', 
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FAS_SS'),'Protection Occupation', 
client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FAS_SS'), client.f_get_pfv_value(%PENSION_APPLICATION_ID,'PN_FAS')),'0.00') as WIN_AVG_SAL from dual",,Pension
634,Member Address US and NON US,MEMBER_ADDRESS_US_NON_US,"select case
         when a.country = 'US' then
          TRIM(decode(a.address_3, null, '', upper(a.address_3) || chr(10)) ||
               decode(a.address_1, null, '', upper(a.address_1)) ||
               decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
               chr(10) || upper(a.city) || ' ' || upper(a.state) || ' ' ||
               dbo.pkg_benefit_s.f_build_zipcode(a.zip))
         else
          TRIM(decode(a.address_3, null, '', upper(a.address_3) || chr(10)) ||
               decode(a.address_1, null, '', upper(a.address_1)) ||
               decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
               chr(10) || upper(a.city) ||
               (select case
                         when upper((Select upper(s.state_name)
                                      from dbo.state s, dbo.country c
                                     where s.country_id = c.country_id
                                       and c.country_code = a.country
                                       and s.state_code = a.state)) is not null then
                          ', ' ||
                          upper((Select upper(s.state_name)
                                  from dbo.state s, dbo.country c
                                 where s.country_id = c.country_id
                                   and c.country_code = a.country
                                   and s.state_code = a.state))
                         else
                          ''
                       end
                  from dual) || ' ' || chr(10) ||
               upper((Select upper(c.country_name)
                       from dbo.country c
                      where c.country_code = a.country)) || chr(10) ||
               a.postal_code)
       end as complete_address
  from dbo.addresses a, dbo.member m
 where m.member_id = %MEMBER_ID
   and a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                   m.person_id,
                                                   null,
                                                   'C,R')",,Member
635,Years of Service till FME,YOS_FME_DATE,"select YOS_FME_DATE
  from (select trim(to_char(pad.period_to_date, 'fmMonth yyyy')) as YOS_FME_DATE
          from dbo.part_acct_detail_summary pads,
               dbo.part_account_detail      pad,
               dbo.part_account             pa,
               dbo.part_acct_dtl_type_cat   padtc,
               dbo.part_account_detail_type padt
         where pads.part_account_id = pa.part_account_id
           and pad.part_acct_detail_summary_id =
               pads.part_acct_detail_summary_id
           and padtc.part_acct_dtl_type_cat_id =
               padt.part_acct_dtl_type_cat_id
           and padt.part_account_detail_type_id =
               pad.part_account_detail_type_id
           and (select to_char(to_date(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                              'PN_EFM_DATE'),
                                       'mm/dd/yyyy'),
                               'fmMonth yyyy') 
                  from dual)<= to_char(pad.period_from_date,'fmMonth yyyy')
           and pa.member_id = %MEMBER_ID 
           and padt.internal_name in ('CB' , 'AC')
           and pad.wages > 0
         order by pad.period_from_date desc)
 where rownum = 1",,Member
617,Payee_Complete_Address_1,PAYEE_COMPLETE_ADDRESS_1,"select decode(a.address_3, null, '', upper(a.address_3) || chr(10)) ||
       decode(a.address_1, null, '', upper(a.address_1)) ||
       decode(a.address_2, null,'', chr(10) || upper(a.address_2)) ||
       chr(10) || upper(a.city) ||' ' || upper(a.state) || ' ' ||
       dbo.pkg_benefit_s.f_build_zipcode(a.zip) as payee_address
  from dbo.addresses a
 where a.key_value in (select x.key_value
                         from (select d.recipient_key_value as key_value
                                 from dbo.disbursement d, dbo.person p
                                where d.recipient_key_value = p.person_id
                                  and p.person_id = %PERSON_ID
                                  and d.recipient_entity_id =
                                      dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                                order by d.disbursement_id desc) x
                        where rownum = 1)
   and a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                   a.key_value,
                                                   null,
                                                   'C,R')
union 
select  decode(a.address_3, null, '', upper(a.address_3)|| chr(10)) ||
       decode(a.address_1, null, '', upper(a.address_1)) ||
       decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
       chr(10) || upper(a.city) || ' ' || upper(a.state) || ' ' ||
       dbo.pkg_benefit_s.f_build_zipcode(a.zip) as payee_address
  from dbo.addresses a
 where a.key_value in
       (select DISTINCT d.recipient_key_value as key_value
          from dbo.disbursement        d,
               dbo.pension_application pa,
               dbo.business_entity_key bek
         where pa.owner_business_entity_key_id = bek.business_entity_key_id
           and bek.business_entity_type_id =
               (select bet.business_entity_type_id
                  from dbo.business_entity_type bet
                 where bet.internal_name = 'PARTICIPANT')
           and pa.application_id = %PENSION_APPLICATION_ID
           and d.recipient_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PERSON')
           and d.recipient_key_value = bek.key_value )
   and a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                   a.key_value,
                                                   null,
                                                   'C,R')",,Member
618,Money Purchase Eligible Block Recalc,MPNE_BLOCK_RECALC," select case
         when nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_MP_ELIGIBLE'),'N') = 'N' then
          '$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OPT_2_PRES_AGE'),
              '0.00')
         else
          '$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2_MP'), '0.00')
       end OPTION_2,
       case
         when nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_MP_ELIGIBLE'),'N') = 'N' then
          '$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2_SS'),
              '0.00')
         else
          '$'||nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_WIN_OP_2_MP'), '0.00')
       end AE_OPTION2
       
  from dual",,Member
636,Member Address concatenated,GENERIC_MEMBER_ADDRESS,"select client.f_get_address(nvl(%PERSON_ID,
                                (select vmq.person_id
                                   from dbo.v_member_q vmq
                                  where vmq.member_id = %MEMBER_ID))) as address_using_member_id,
       client.f_get_address(nvl(%PERSON_ID,
                                (select bek.key_value
                                   from dbo.business_entity_key bek
                                  where bek.business_entity_key_id =
                                        (select pa.owner_business_entity_key_id
                                           from dbo.pension_application pa
                                          where pa.application_id =
                                                %PENSION_APPLICATION_ID)))) as address_using_pen_app_id
  from dual",,Member
532,AP Address - QDRO,AP_ADDR_QDRO,"select trim(upper(a.address_1)) as address_1,
       trim(upper(a.address_2)) as address_2,
       trim(upper(a.address_3)) as address_3,
       upper(a.city) || ' ' || upper(a.state) || ' ' ||
       dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_zip,
       initcap(a.city) as city,
  case  --NG2
  when a.country = 'US' then
   TRIM(decode(a.address_3,
               null,
               '',
               upper(a.address_3) || chr(10)) ||
        decode(a.address_1, null, '', upper(a.address_1)) ||
        decode(a.address_2,
               null,
               '',
               chr(10) || upper(a.address_2)) || chr(10) ||
        upper(a.city) || ' ' || upper(a.state) || ' ' ||
        dbo.pkg_benefit_s.f_build_zipcode(a.zip))
  else
   TRIM(decode(a.address_3,
            null,
            '',
            upper(a.address_3) || chr(10)) ||
     decode(a.address_1, null, '', upper(a.address_1)) ||
     decode(a.address_2,
            null,
            '',
            chr(10) || upper(a.address_2)) || chr(10) ||
     upper(a.city) ||
     (select case
               when upper((Select upper(s.state_name)
                            from dbo.state s, dbo.country c
                           where s.country_id = c.country_id
                             and c.country_code = a.country
                             and s.state_code = a.state)) is not null then
                ', ' ||
                upper((Select upper(s.state_name)
                        from dbo.state s, dbo.country c
                       where s.country_id = c.country_id
                         and c.country_code = a.country
                         and s.state_code = a.state))
               else
                ''
             end
        from dual) ||
        (select case
               when a.postal_code  is not null then
                ', ' ||
                a.postal_code
               else
                ''
             end
        from dual)|| chr(10) ||
     upper((Select upper(c.country_name)
             from dbo.country c
            where c.country_code = a.country)))
end as complete_address --NG1
  from dbo.pension_application pa,
       dbo.pension_option      po,
       dbo.pension_type        pt,
       dbo.business_entity_key bek,
       dbo.person              ap,
       dbo.addresses           a
 where pa./*parent_*/application_id = %PENSION_APPLICATION_ID----NG
   and pa.pension_option_id = po.pension_option_id
   and po.pension_type_id = pt.pension_type_id
   and pt.pension_type_code = 'IPQDRO'
   and bek.business_entity_key_id = pa.owner_business_entity_key_id
   and bek.key_value = ap.person_id
   and a.address_id =
       dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                    ap.person_id,
                                    'R')",,Pension
609,EFT Bank Address of member thrg ben pension app id,EFT_BANK_ADDRESS_NEW,"select ea.bank_name,
       ad.address_1,
       ad.address_2,
       ad.city,
       ad.state,
       dbo.pkg_benefit_s.f_build_zipcode(ad.zip)
  from dbo.eft_authorization_header eah,
       dbo.eft_authorization        ea,
       dbo.oi_organization          oo,
       dbo.addresses                ad,
       dbo.pension_application      pa,
       dbo.v_member_q               vmq
 where eah.eft_authorization_header_id = ea.eft_authorization_header_id
   and eah.source_entity_id =
       dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
   and eah.source_key_value = pa.parent_application_id
   and pa.member_Id = vmq.member_id
   and pa.application_id = %PENSION_APPLICATION_ID
   and trunc(sysdate) between eah.start_date and
       nvl(eah.end_date, trunc(sysdate) + 1)
   and eah.recipient_entity_id =
       dbo.pkg_benefit_s.f_get_entity_id('PERSON')
   and eah.recipient_key_value = vmq.person_id
   and ea.oi_organization_id = oo.oi_organization_id
   and ad.entity_id =
       dbo.pkg_benefit_s.f_get_entity_id('OI_ORGANIZATION')
   and ad.key_value = oo.oi_organization_id
   and trunc(sysdate) between ad.start_date and
       nvl(ad.stop_date, trunc(sysdate) + 1)",,Pension
431,Beneficiary Info Upper,BENEFICIARY_INFO_UPPER,"select upper(bp.first_name) || case
when bp.last_name is not null THEN
' ' || upper(bp.last_name)
end beneficiary_name,
upper(trim(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
bp.PREFIX,
'Y',
'N') || ' ' ||
(bp.FIRST_NAME) || ' ' || (bp.middle_name) || ' ' ||
(bp.last_name) || ' ' ||
dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
bp.SUFFIX,
'Y',
'N'))) as Beneficiary_Full_Name,
bt.beneficiary_type_code,
to_char(be.start_date, 'mm/dd/rrrr') start_date,
dbo.pkg_benefit_s.f_get_value_description('RELATION',
lb.relation,
lb.relation,
'N') relation,
 nvl2(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                      bp.PREFIX,
                                                      'Y',
                                                      'N'),
            UPPER(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                            bp.PREFIX,
                                                            'Y',
                                                            'N')) || ' ',
            '') || UPPER(bp.FIRST_NAME) || ' ' ||
       nvl2(bp.middle_name, UPPER(bp.middle_name) || ' ', '') ||
       UPPER(bp.last_name) ||
       nvl2(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                      bp.SUFFIX,
                                                      'Y',
                                                      'N'),
            ' ' || dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                             bp.SUFFIX,
                                                             'Y',
                                                             'N'),
            '') as bene_name_space,
            upper(bp.first_name) || case
when bp.last_name is not null THEN
' ' || upper(bp.last_name)||':' 
end new_name
from web.v_linked_beneficiaries lb,
dbo.beneficiary            be,
dbo.beneficiary_type       bt,
dbo.person                 bp,
DBO.Member                 m
where lb.alt_beneficiary_id = be.alt_beneficiary_id
and be.beneficiary_type_id = bt.beneficiary_type_id
and (be.stop_date is null or be.stop_date > trunc(sysdate))
and be.start_date <= trunc(sysdate)
and be.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
and lb.dependent_id = bp.person_id
and m.person_id = be.person_id
and m.member_id = %MEMBER_ID
order by bt.beneficiary_type_code, bp.last_name, bp.first_name
",,Pension
610,Amdb pension FME months,AMDB_PENSION_FME_MONTH_NEW,"SELECT (CASE
         WHEN SYSDATE > to_date(f.rate_value_01, 'MM/dd/yyyy') THEN
          (SELECT TRIM(to_char(to_date(f.rate_value_01, 'MM/dd/yyyy'),
                               'fmMonth yyyy'))
             FROM dbo.factor f
            WHERE f.factor_id =
                  web.pkg_util.f_get_factor_id('MONTHLY_PAYROLL_DATE')
              AND f.lookup_value_01 =
                  (TRIM(to_char(add_months(SYSDATE, 1), 'Month')) || ' ' ||
                  TRIM(to_char(SYSDATE, 'yyyy'))))
         ELSE
          TRIM(to_char(SYSDATE, 'fmMonth yyyy'))
       END) fme_month
  FROM dbo.factor f
 WHERE f.factor_id = web.pkg_util.f_get_factor_id('MONTHLY_PAYROLL_DATE')
   AND f.lookup_value_01 = (TRIM(to_char(SYSDATE, 'Month')) || ' ' ||
       TRIM(to_char(SYSDATE, 'yyyy')))",,Pension
611,Bene info new,BENE_INFO_NEW,"select ssn, fund,name,beneficiary_type,percentage,relationship,trim(to_char(start_date,'mm/dd/yyyy')),stop_date,birth_date, beneficiary_name,bene_name_space,new_name from
(select dbo.pkg_benefit_s.f_build_ssn(p.ssn) as ssn,
       f.fund_name as fund,
       nvl2(p.first_name, initcap(p.first_name) || ' ', '') ||
       nvl2(p.middle_name, initcap(p.middle_name) || ' ', '') ||
       nvl2(p.last_name, initcap(p.last_name), '') as name,
       bt.beneficiary_type_code as beneficiary_type,
       b.percent as percentage,
       vav.description as relationship,
       b.start_date as start_date,
       to_char(b.stop_date,'mm/dd/yyyy') as stop_date,
       p.birth_date,
       upper(p.first_name) || case
         when p.last_name is not null THEN
          ' ' || upper(p.last_name)
       end beneficiary_name,
        nvl2(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                      p.PREFIX,
                                                      'Y',
                                                      'N'),
            UPPER(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                            p.PREFIX,
                                                            'Y',
                                                            'N')) || ' ',
            '') || UPPER(p.FIRST_NAME) ||' ' ||
       nvl2(p.middle_name, UPPER(p.middle_name) || ' ', '') ||
       UPPER(p.last_name) ||
       nvl2(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                      p.SUFFIX,
                                                      'Y',
                                                      'N'),
            ' ' || dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                             p.SUFFIX,
                                                             'Y',
                                                             'N'),
            '') as bene_name_space,
           upper(p.first_name) || case when p.last_name is not null THEN ' ' || upper(p.last_name) || ':' end new_name
  from dbo.beneficiary       b,
       dbo.member            m,
       dbo.person            p,
       dbo.beneficiary_type  bt,
       dbo.fund              f,
       dbo.dependent         d,
       dbo.v_attribute_value vav
 where m.member_id = %MEMBER_ID
   and m.person_id = b.person_id
   and b.beneficiary_id = p.person_id
   and b.beneficiary_type_id = bt.beneficiary_type_id
   and f.fund_id = b.fund_id
   and b.beneficiary_id = d.dependent_id
   and d.person_id = m.person_id
   and d.relation = vav.internal_value
   and vav.attribute_name = 'RELATION'
   and b.stop_date is null
union 
select '000-00-0000' as ssn,
       f.fund_name as fund,
       nvl2(p.first_name, initcap(p.first_name) || ' ', '') ||
       nvl2(p.middle_name, initcap(p.middle_name) || ' ', '') ||
       nvl2(p.last_name, initcap(p.last_name), '') as name,
       bt.beneficiary_type_code as beneficiary_type,
       b.percent as percentage,
       'Other Person, Beneficiary' as relationship,
       b.start_date as start_date,
       to_char(b.stop_date,'mm/dd/yyyy') as stop_date,
       p.birth_date,
       upper(p.first_name) || case
         when p.last_name is not null THEN
          ' ' || upper(p.last_name)
       end beneficiary_name,
       '' bene_name_space,  
       '' new_name
  from dbo.beneficiary       b,
       dbo.member            m,
       dbo.person            p,
       dbo.beneficiary_type  bt,
       dbo.fund              f,
       dbo.oi_person op
 where m.member_id = %MEMBER_ID
   and m.person_id = b.person_id
   and p.person_id = op.person_id   
   and b.beneficiary_type_id = bt.beneficiary_type_id
   and b.entity_id = dbo.pkg_benefit_s.f_get_entity_id('OI_PERSON')
   and op.oi_person_id = b.key_value
   and f.fund_id = b.fund_id
   and b.stop_date is null)
order by beneficiary_type,percentage ",,Pension
612,Pension Option Type Percent for ret re-employed,PEN_OPT_TYPE_PER_RREMP,"select case
         when pot.pension_option_type_code = 'JSA100' then
          100
         when pot.pension_option_type_code = 'JSA75' then
          75
         when pot.pension_option_type_code = 'JSA50' then
          50
         when pot.pension_option_type_code = 'JSA25' then
          25
         when pot.pension_option_type_code = 'JSAP100' then
          100
         when pot.pension_option_type_code = 'JSAP75' then
          75
         when pot.pension_option_type_code = 'JSAP50' then
          50
         when pot.pension_option_type_code = 'JSAP25' then
          25
         when pot.pension_option_type_code = 'LPJSA100' then
          100
         when pot.pension_option_type_code = 'LPJSA75' then
          75
         when pot.pension_option_type_code = 'LPJSA50' then
          50
         when pot.pension_option_type_code = 'LPJSA25' then
          25
         else
          0
       end percentage
  from dbo.pension_application pa,
       dbo.pension_option      po,
       dbo.pension_option_type pot
 where pa.pension_option_id = po.pension_option_id
   and po.pension_option_type_id = pot.pension_option_type_id
   and pa.application_id = (select p.parent_application_id from dbo.pension_application p where p.application_id=%PENSION_APPLICATION_ID)",,Member
614,Overpayment Total Amount,BENE_RECLA_BOOKMARK,"select trim(to_char(sum(Amount_02),'999,999,990.00')) as total_amount
  from table(CLIENT.f_Get_Over_Pay_Amt_Bookmark(%PENSION_APPLICATION_ID))",,Member
592,DIRECT_DEPOSIT_EFT_ADDRESS_BM,DIRECT_DEPOSIT_EFT_ADDRESS_BM,"select complete_address, payee_first_last_name from (select complete_address,indate,payee_first_last_name
          from (select  case
               when addr.country = 'US' then
                TRIM(decode(addr.address_3, null, '', upper(addr.address_3) || chr(10)) ||
                     decode(addr.address_1, null, '', upper(addr.address_1)) ||
                     decode(addr.address_2, null, '', chr(10) || upper(addr.address_2)) ||
                     chr(10) || upper(addr.city) || ' ' || upper(addr.state) || ' ' ||
                     dbo.pkg_benefit_s.f_build_zipcode(addr.zip))
               else
            	   TRIM(decode(addr.address_3,null,'',upper(addr.address_3) || chr(10)) ||decode(addr.address_1, null, '', upper(addr.address_1)) ||
                    decode(addr.address_2,null,'',chr(10) || upper(addr.address_2)) || chr(10) ||upper(addr.city) ||
                    (select case
                              when upper((Select upper(s.state_name)
                                           from dbo.state s, dbo.country c
                                          where s.country_id = c.country_id
                                            and c.country_code = addr.country
                                            and s.state_code = addr.state)) is not null then
                               ', ' ||
                               upper((Select upper(s.state_name)
                                       from dbo.state s, dbo.country c
                                      where s.country_id = c.country_id and c.country_code = addr.country and s.state_code = addr.state))
                              else
                               ''
                            end
                       from dual) || 
                       (select case
                              when addr.postal_code  is not null then
                               ', ' ||
                               addr.postal_code
                              else
                               ''
                            end
                       from dual)|| chr(10) ||
                    upper((Select upper(c.country_name)
                            from dbo.country c
                           where c.country_code = addr.country)))
            end as complete_address,ea.inserted_date indate,
        (TRIM(nvl2(p.first_name,
                                  upper(p.first_name) || ' ',
                                  '') || upper(p.last_name))) as payee_first_last_name
                  from dbo.person                   p,dbo.eft_authorization_header eah,dbo.eft_authorization        ea,dbo.addresses                addr
                 where p.person_id = NVL(%PERSON_ID,
                           (select bek.key_value
                              from dbo.pension_application pa,
                                   dbo.business_entity_key bek
                             where pa.application_id = %PENSION_APPLICATION_ID
                               and pa.owner_business_entity_key_id = bek.business_entity_key_id))                             
                   and ea.recipient_key_value = p.person_id
                   and ea.recipient_entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                   and ea.eft_authorization_header_id = eah.eft_authorization_header_id
                   and addr.entity_id =dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                   and addr.key_value = ea.recipient_key_value
                   and addr.address_id =dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),addr.key_value,null,'C,R')))
 where rownum = 1",,Member
631,Beneficiary Info through Pension application id,BEN_INFO_VIA_PENSION_APP,"select TRIM(NVL2(ap.prefix,
                 upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                                 ap.prefix,
                                                                 'Y',
                                                                 'N')) || ' ',
                 '') || upper(ap.first_name) || ' ' ||
            NVL2(ap.middle_name, upper(ap.middle_name) || ' ', '') ||
            upper(ap.last_name) || ' ' ||
            upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                            ap.suffix,
                                                            'Y',
                                                            'N')))
       
       ap_full_name,
       ap.death_date death_date
  from dbo.pension_application pa,
       dbo.business_entity_key bek,
       dbo.person              ap
 where pa.application_id = %PENSION_APPLICATION_ID
   and bek.business_entity_key_id = pa.owner_business_entity_key_id
   and bek.key_value = ap.person_id",,Member
632,Member Address Info US,MEM_ADDR_INFO_US,"select upper(a.address_1) as address_line_1,
       upper(nvl(a.address_2, '')) as address_line_2,
       upper(nvl(a.address_3, '')) as address_line_3,
       upper(a.city) || ', ' || upper(a.state) || ' ' ||
       dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_line,
       upper(a.city) as city,    
      (Select upper(s.state_name) from dbo.state s, dbo.country c 
              where s.country_id = c.country_id
              and c.country_code = a.country
              and s.state_code = a.state) as state,
              (Case when a.country = 'US'
             Then a.country
            else
              (Select upper(c.country_name) from dbo.country c where c.country_code = a.country)                    
            end  ) as county,       
       (case when a.country='US' then dbo.pkg_benefit_s.f_build_zipcode(a.zip) else a.postal_code end) as zip_code,a.country as country_Code,        
       nvl(a.phone_1, '') as phone1,
       nvl(a.phone_2, '') as phone2,
       nvl(a.phone_3, '') as phone3,
       nvl(a.phone_4, '') as phone4
  from dbo.addresses a, dbo.member m
 where m.member_id = %MEMBER_ID -- 341402 
 and a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'), m.person_id, null,'C,R')",,Member
633,Earning Limit Reach Month Year,EAR_LIMIT_MONTH_YEAR,"select trim(to_char((add_months(sysdate, -1)), 'YYYY')) AS YEAR,
       trim(to_char((add_months(sysdate, -1)), 'Month')) AS MONTH
  from dual",,Member
615,Pay By Date period,PAY_BY_DATE_PERIOD,"select to_char(CLIENT.f_get_rfd_amount(%PENSION_APPLICATION_ID), 'mm/dd/yyyy') ||'. ' as rfddate
                                                              from dual",,Pension
76,Employer Name,EMPLOYER_NAME,select upper(e.employer_name) from dbo.employer e where e.employer_id=%EMPLOYER_ID,,Employer
619,Outdated_Warrant_Grid_New,OUTDATED_WARRANT_GRID_NEW,"select to_char(d.check_eft_no) warrant_number, '09-0791-553-4410-4612' state_accounting_number
, to_char(d.disbursement_date,'mm/dd/yyyy') issue_date, '$'||trim(to_char(d.disbursement_amt, '999,990.00')) warrant_amount
  from dbo.person m join dbo.disbursement d on d.recipient_key_value = m.person_id
  where m.person_id = %PERSON_ID and d.recipient_entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
  and d.disbursement_status = 'ST' and d.disbursement_type = 'C' order by d.disbursement_date",,Member
620,Pension Person Name Info,PEN_PERSON_NAME,"select TRIM(NVL2(ap.prefix,
                 upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                                 ap.prefix,
                                                                 'Y',
                                                                 'N')) || ' ',
                 '') || upper(ap.first_name) || ' ' ||
            NVL2(ap.middle_name, upper(ap.middle_name) || ' ', '') ||
            upper(ap.last_name) || ' ' ||
            upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                            ap.suffix,
                                                            'Y',
                                                            'N')))
       
       as ap_full_name,
       dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                 ap.PREFIX,
                                                 'Y',
                                                 'N') as prefix,
       (ap.first_name) as firstName,
       (ap.middle_name) as middleName,
       (ap.last_name) as lastName,
       dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                 ap.SUFFIX,
                                                 'Y',
                                                 'N') as suffix
  from dbo.pension_application pa,       
       dbo.business_entity_key bek,
       dbo.person              ap
 where pa.application_id = %PENSION_APPLICATION_ID
   and bek.business_entity_key_id = pa.owner_business_entity_key_id
   and bek.key_value = ap.person_id",,Member
621,Pension Person Address,PEN_PERSON_ADDR,"select trim(upper(addr.address_1)) as address_1,
       trim(upper(addr.address_2)) as address_2,
       trim(upper(addr.address_3)) as address_3,
       upper(addr.city) || ' ' || upper(addr.state) || ' ' ||
       dbo.pkg_benefit_s.f_build_zipcode(addr.zip) as city_state_zip,
       initcap(addr.city) as city
  from dbo.pension_application pa,       
       dbo.business_entity_key bek,
       dbo.person              ap,
       dbo.addresses           addr
 where pa.application_id = %PENSION_APPLICATION_ID 
   and bek.business_entity_key_id = pa.owner_business_entity_key_id
   and bek.key_value = ap.person_id
   and addr.address_id =
       dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                    ap.person_id,
                                    'R')",,Member
622,DIRECT_DEPOSIT_PAY_ROLE_DATE,DIRECT_DEPOSIT_PAY_ROLE_DATE,"select case
         when trunc(sysdate) >
              (SELECT to_date(f.rate_value_01, 'MM/dd/yyyy') as current_pay_role_date
                 FROM dbo.factor f
                WHERE f.factor_id =
                      web.pkg_util.f_get_factor_id('MONTHLY_PAYROLL_DATE')
                  AND f.lookup_value_01 =
                      (TRIM(to_char(add_months(SYSDATE, 0), 'Month')) || ' ' ||
                      TRIM(to_char(SYSDATE, 'yyyy')))) then
          TRIM(to_char(add_months(SYSDATE, 1), 'Month')) --next month
         else
          TRIM(to_char(add_months(SYSDATE, 0), 'Month')) --current month
       END PAY_ROLE_DATE
  from dual",,Member
623,Rollover Account Information,ROLLOVER_ACCOUNT_INFORMATION,"select ACCOUNT_NUMBER,
       ROLLOVER_COMPANY_NAME,
       ROLLOVER_COMPANYS_ADDRESS,
       COUNTRY,
       ZIP,
       STATE,
       COUNTY,
       CITY  --NG
  from (SELECT dd.account_number ACCOUNT_NUMBER,
               ad.address_1 ROLLOVER_COMPANY_NAME,
               ad.address_3 ROLLOVER_COMPANYS_ADDRESS,
               ad.country COUNTRY,
               dbo.pkg_benefit_s.f_build_zipcode(ad.zip) ZIP,
               ad.state STATE,
               ad.county COUNTY,
               ad.city CITY --NG
          FROM dbo.disbursement_distribution dd,
               dbo.oi_organization           oi,
               dbo.addresses                 ad,
               dbo.benefit_account           ba
         where dd.recipient_key_value = oi.oi_organization_id
           AND dd.source_entity_id =
               dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
           AND ad.entity_id(+) =
               dbo.pkg_benefit_s.f_get_entity_id('DISBURSEMENT_DISTRIBUTION')
           and ad.key_value(+) = dd.disbursement_distribution_id
           and ba.benefit_account_id = dd.benefit_account_id
           AND dd.source_key_value = %PENSION_APPLICATION_ID--981856
           and ba.internal_name = 'ROLLOVER'
         order by dd.inserted_date desc)
 where rownum = 1",,Member
626,Beneficiary Address,BENEFICIARY_ADDRESS,"SELECT *
  FROM (select upper(a.address_1) as address_line_1,
               upper(nvl(a.address_2, '')) as address_line_2,
               upper(nvl(a.address_3, '')) as address_line_3,
               upper(a.city) || ', ' || upper(a.state) || ' ' ||
               dbo.pkg_benefit_s.f_build_zipcode(a.zip) as city_state_line,
               upper(a.city) as city,
               upper(a.state) as state,
               upper(a.county) as county,
               dbo.pkg_benefit_s.f_build_zipcode(a.zip) as zip_code,
               nvl(a.phone_1, '') as phone1,
               nvl(a.phone_2, '') as phone2,
               nvl(a.phone_3, '') as phone3,
               nvl(a.phone_4, '') as phone4
          from dbo.pension_application  pa,
               dbo.business_entity_key  bek,
               dbo.business_entity_type bet,
               dbo.person               bp,
               DBO.ADDRESSES            A
         where pa.owner_business_entity_key_id = bek.business_entity_key_id
           and bek.business_entity_type_id = bet.business_entity_type_id
           and bp.person_id = bek.key_value
           AND A.KEY_VALUE = BP.PERSON_ID
           AND A.ENTITY_ID = 254
           and bet.internal_name = 'PARTICIPANT'
           and a.address_id =
               dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                            BP.PERSON_ID,
                                            null,
                                            'C,R')
           and pa.application_id = %PENSION_APPLICATION_ID)",,Member
238,Payee_Complete_Address,PAYEE_COMPLETE_ADDRESS,"select case --NG2
        when a.country = 'US' then
        TRIM(decode(a.address_3,
                    null,
                    '',
                    upper(a.address_3) || chr(10)) ||
             decode(a.address_1, null, '', upper(a.address_1)) ||
             decode(a.address_2,
                    null,
                    '',
                    chr(10) || upper(a.address_2)) || chr(10) ||
             upper(a.city) || ' ' || upper(a.state) || ' ' ||
             dbo.pkg_benefit_s.f_build_zipcode(a.zip))
       else
        TRIM(decode(a.address_3,
                 null,
                 '',
                 upper(a.address_3) || chr(10)) ||
          decode(a.address_1, null, '', upper(a.address_1)) ||
          decode(a.address_2,
                 null,
                 '',
                 chr(10) || upper(a.address_2)) || chr(10) ||
          upper(a.city) ||
          (select case
                    when upper((Select upper(s.state_name)
                                 from dbo.state s, dbo.country c
                                where s.country_id = c.country_id
                                  and c.country_code = a.country
                                  and s.state_code = a.state)) is not null then
                     ', ' ||
                     upper((Select upper(s.state_name)
                             from dbo.state s, dbo.country c
                            where s.country_id = c.country_id
                              and c.country_code = a.country
                              and s.state_code = a.state))
                    else
                     ''
                  end
             from dual) ||
             (select case
                    when a.postal_code  is not null then
                     ', ' ||
                     a.postal_code
                    else
                     ''
                  end
             from dual)|| chr(10) ||
          upper((Select upper(c.country_name)
                  from dbo.country c
                 where c.country_code = a.country)))
     end as payee_address
from dbo.addresses a
where a.key_value in (select x.key_value
                       from (select d.recipient_key_value as key_value
                               from dbo.disbursement d, dbo.v_member_q p
                              where d.recipient_key_value = p.person_id
                                and p.member_id = %MEMBER_ID
                                and d.recipient_entity_id =
                                    dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                              order by d.disbursement_id desc) x
                      where rownum = 1)
 and a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                 a.key_value,
                                                 null,
                                                 'C,R')",,Member
216,AP Info Address,AP_INFO_ADDRESS,"select ap_info_address
from (select case --NG2
        when a.country = 'US' then
        TRIM(decode(a.address_3,
                    null,
                    '',
                    upper(a.address_3) || chr(10)) ||
             decode(a.address_1, null, '', upper(a.address_1)) ||
             decode(a.address_2,
                    null,
                    '',
                    chr(10) || upper(a.address_2)) || chr(10) ||
             upper(a.city) || ' ' || upper(a.state) || ' ' ||
             dbo.pkg_benefit_s.f_build_zipcode(a.zip))
       else
        TRIM(decode(a.address_3,
                 null,
                 '',
                 upper(a.address_3) || chr(10)) ||
          decode(a.address_1, null, '', upper(a.address_1)) ||
          decode(a.address_2,
                 null,
                 '',
                 chr(10) || upper(a.address_2)) || chr(10) ||
          upper(a.city) ||
          (select case
                    when upper((Select upper(s.state_name)
                                 from dbo.state s, dbo.country c
                                where s.country_id = c.country_id
                                  and c.country_code = a.country
                                  and s.state_code = a.state)) is not null then
                     ', ' ||
                     upper((Select upper(s.state_name)
                             from dbo.state s, dbo.country c
                            where s.country_id = c.country_id
                              and c.country_code = a.country
                              and s.state_code = a.state))
                    else
                     ''
                  end
             from dual) ||
             (select case
                    when a.postal_code  is not null then
                     ', ' ||
                     a.postal_code
                    else
                     ''
                  end
             from dual)|| chr(10) ||
          upper((Select upper(c.country_name)
                  from dbo.country c
                 where c.country_code = a.country)))
     end as ap_info_address,
             a.address_type
        from dbo.person    p,
             dbo.member    m,
             dbo.addresses a,
             dbo.dependent d,
             dbo.person    dp
       where d.person_id = p.person_id
         and p.person_id = m.person_id
         and m.member_id = %MEMBER_ID
         and d.relation = 'AP'
         and a.key_value = dp.person_id
         and dp.person_id = d.dependent_id
         and a.address_type in ('C', 'R')
         and a.stop_date is null
       order by a.address_type asc)
where rownum = 1",,Member
580,Retired Reemployed Option 1,OPTION_1_RR,"SELECT TRIM(TO_CHAR((NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                'PN_YRLY_ERSC_DISPLAY'),
                         0) + NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                          'PN_POST_YRLY_ERSC_DISPLAY'),
                                   0) + NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                                    'PN_YRLY_PRSC_DISPLAY'),
                                             0) +
                    NVL(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                'PN_POST_YRLY_PRSC_DISPLAY'),
                         0)),
                    '999,999,990.99')) as OPTION1_YR,
       '$' || TRIM(NVL(client.f_get_pfv_value(pa.parent_application_id,
                                              'PN_OP1_DEATH_BENE'),
                       '0.00')) AS OPTION1_DB
  FROM dbo.pension_application pa
 WHERE pa.application_id = %PENSION_APPLICATION_ID",,Pension
643,Address using person id,ADDRESSS_USING_PERSON_ID,"select case
         when a.country = 'US' then
          TRIM(decode(a.address_3, null, '', upper(a.address_3) || chr(10)) ||
               decode(a.address_1, null, '', upper(a.address_1)) ||
               decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
               chr(10) || upper(a.city) || ' ' || upper(a.state) || ' ' ||
               dbo.pkg_benefit_s.f_build_zipcode(a.zip))
         else
          TRIM(decode(a.address_3, null, '', upper(a.address_3) || chr(10)) ||
               decode(a.address_1, null, '', upper(a.address_1)) ||
               decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
               chr(10) || upper(a.city) ||
               (select case
                         when upper((Select upper(s.state_name)
                                      from dbo.state s, dbo.country c
                                     where s.country_id = c.country_id
                                       and c.country_code = a.country
                                       and s.state_code = a.state)) is not null then
                          ', ' ||
                          upper((Select upper(s.state_name)
                                  from dbo.state s, dbo.country c
                                 where s.country_id = c.country_id
                                   and c.country_code = a.country
                                   and s.state_code = a.state))
                         else
                          ''
                       end
                  from dual) || (select case
                                          when a.postal_code is not null then
                                           ', ' || a.postal_code
                                          else
                                           ''
                                        end
                                   from dual) || chr(10) ||
               upper((Select upper(c.country_name)
                       from dbo.country c
                      where c.country_code = a.country)))
       end as complete_address
  from dbo.addresses a
 where a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                   %PERSON_ID,
                                                   null,
                                                   'C,R')",,Member
644,Person demographics using person id,PERSON_DEMOGRAPHICS_PERSON_ID,"select trim(dbo.pkg_benefit_s.f_get_value_description  ('PREFIX',
                                                 P.PREFIX,
                                                 'Y',
                                                 'N') || ' ' ||
       (P.FIRST_NAME) || ' ' || (p.middle_name) || ' ' || (p.last_name) || ' ' ||
       dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                 P.SUFFIX,
                                                 'Y',
                                                 'N')) as memberName
  from dbo.person p
 where p.person_id = %PERSON_ID",,Member
655,Member Info Upper 2,MEMBER_INFO_UPPER_2,"select trim(decode(PREFIX,
                   null,
                   null,
                   upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                                   P.PREFIX,
                                                                   'Y',
                                                                   'N')) || ' ') ||
            upper(P.FIRST_NAME) || ' ' || upper(p.middle_name) || ' ' ||
            upper(p.last_name) || ' ' ||
            upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                            P.SUFFIX,
                                                            'Y',
                                                            'N'))) as memberName,
       upper(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                       P.PREFIX,
                                                       'Y',
                                                       'N')) as prefix,
       TRIM(upper(p.first_name)) as firstName,
       upper(p.middle_name) as middleName,
       TRIM(upper(p.last_name)) as lastName,
       upper(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                       P.SUFFIX,
                                                       'Y',
                                                       'N')) as suffix,
       p.birth_date as birthDate,
       upper(p.sex) as sex,
       p.alt_identifier as altId,
       upper(p.status) as status,
       p.ssn as ssn
  from dbo.person p
 where p.person_id = (select nvl(%PERSON_ID,(select p.person_id
  from dbo.business_entity_key bek, dbo.person p
 where bek.key_value = p.person_id
   and bek.business_entity_key_id in
       (select pa.owner_business_entity_key_id
          from dbo.pension_application pa
         where pa.application_id = %PENSION_APPLICATION_ID
         and rownum=1))) from dual)",,Member
653,Total Recovery Amount,TOTAL_RECOVERY_AMOUNT,"select '$'||trim(to_char(nvl((select trim(sum(od.taxable_amount))
               from dbo.overpayment o, dbo.overpayment_detail od
              where o.overpayment_id = od.overpayment_id
                and od.source_key_value =%PENSION_APPLICATION_ID),
             0),'999,999,990.99'))
    from dual",,Pension
656,Member Info 1,MEMBER_INFO_1,"select trim(dbo.pkg_benefit_s.f_get_value_description  ('PREFIX',
                                                 P.PREFIX,
                                                 'Y',
                                                 'N') || ' ' ||
       (P.FIRST_NAME) || ' ' || (p.middle_name) || ' ' || (p.last_name) || ' ' ||
       dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                 P.SUFFIX,
                                                 'Y',
                                                 'N')) as memberName,
       dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                 P.PREFIX,
                                                 'Y',
                                                 'N') as prefix,
       (p.first_name) as firstName,
       (p.middle_name) as middleName,
       (p.last_name) as lastName,
       dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                 P.SUFFIX,
                                                 'Y',
                                                 'N') as suffix,
       p.birth_date as birthDate,
       p.sex as sex,
       p.alt_identifier as altId,
       p.status as status,
       p.ssn as ssn,
       p.death_date as DeathDate
  from dbo.person p
 where p.person_id = (select nvl(%PERSON_ID,(select p.person_id
  from dbo.business_entity_key bek, dbo.person p
 where bek.key_value = p.person_id
   and bek.business_entity_key_id in
       (select pa.owner_business_entity_key_id
          from dbo.pension_application pa
         where pa.application_id = %PENSION_APPLICATION_ID
         and rownum=1))) from dual)",,Member
657,Generic Member Address 1,GENERIC_MEMBER_ADDRESS_1,"select case
         when a.country = 'US' then
          TRIM(decode(a.address_3, null, '', upper(a.address_3) || chr(10)) ||
               decode(a.address_1, null, '', upper(a.address_1)) ||
               decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
               chr(10) || upper(a.city) || ' ' || upper(a.state) || ' ' ||
               dbo.pkg_benefit_s.f_build_zipcode(a.zip))
         else
          TRIM(decode(a.address_3, null, '', upper(a.address_3) || chr(10)) ||
               decode(a.address_1, null, '', upper(a.address_1)) ||
               decode(a.address_2, null, '', chr(10) || upper(a.address_2)) ||
               chr(10) || upper(a.city) ||
               (select case
                         when upper((Select upper(s.state_name)
                                      from dbo.state s, dbo.country c
                                     where s.country_id = c.country_id
                                       and c.country_code = a.country
                                       and s.state_code = a.state)) is not null then
                          ', ' ||
                          upper((Select upper(s.state_name)
                                  from dbo.state s, dbo.country c
                                 where s.country_id = c.country_id
                                   and c.country_code = a.country
                                   and s.state_code = a.state))
                         else
                          ''
                       end
                  from dual) || (select case
                                          when a.postal_code is not null then
                                           ', ' || a.postal_code
                                          else
                                           ''
                                        end
                                   from dual) || chr(10) ||
               upper((Select upper(c.country_name)
                       from dbo.country c
                      where c.country_code = a.country)))
       end as complete_address
  from dbo.addresses a
 where a.address_id = dbo.f_get_current_address_id(dbo.pkg_benefit_s.f_get_entity_id('PERSON'),
                                                   (select nvl(%PERSON_ID,
                                                               (select p.person_id
                                                                  from dbo.business_entity_key bek,
                                                                       dbo.person              p
                                                                 where bek.key_value =
                                                                       p.person_id
                                                                   and bek.business_entity_key_id in
                                                                       (select pa.owner_business_entity_key_id
                                                                          from dbo.pension_application pa
                                                                         where pa.application_id =
                                                                               %PENSION_APPLICATION_ID
                                                                           and rownum = 1)))
                                                      from dual),
                                                   null,
                                                   'C,R')
",,Member
638,Employer name using Member ID,EMPLOYER_NAME_VIA_MEM_ID,"select upper(e.employer_name)
          from dbo.employer E, dbo.member_contract mc
         where E.Employer_Id = mc.employer_id
           and mc.member_id = %MEMBER_ID
           and (mc.stop_date is null or mc.stop_date >= sysdate)",,Member
639,Winning Average Salary,WINNING_AVG_SAL,"select case --case 1
         when (select client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,
                                                    'PN_FAS')
                 from dual) = 0 and (select client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,
                                                                          'PN_FAS_SS')
                                       from dual) > 0 then
          (select '$' || nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                    'PN_FAS_SS'),
                             '0.00')
             from dual)
       --case 2
         when (select client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,
                                                    'PN_FAS')
                 from dual) > 0 and (select client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,
                                                                          'PN_FAS_SS')
                                       from dual) = 0 then
          (select '$' || nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                    'PN_FAS'),
                             '0.00')
             from dual)
       --case 3
         when (select client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,
                                                    'PN_FAS')
                 from dual) <> 0 and
              ((select client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,
                                                     'PN_FAS')
                  from dual) > (select client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,
                                                                      'PN_FAS_SS')
                                   from dual)) then
          (select '$' || nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                    'PN_FAS'),
                             '0.00')
             from dual)
       --case 4
         when (select client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,
                                                    'PN_FAS_SS')
                 from dual) <> 0 and
              ((select client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,
                                                     'PN_FAS_SS')
                  from dual) > (select client.f_get_pfv_value_number(%PENSION_APPLICATION_ID,
                                                                      'PN_FAS')
                                   from dual)) then
          (select '$' || nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                    'PN_FAS_SS'),
                             '0.00')
             from dual)
       --case 5
         else
          (select '$' || nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID,
                                                    'PN_FAS_SS'),
                             '0.00')
             from dual)
       end as win_avg_sal
  from dual",,Member
645,Total Overpayment Amount,TOTAL_OVERPAYMENT_AMOUNT,"select '$' || trim(to_char((nvl(trim(sum(total_overpayment_amount)), 0)),
                            '999,999,990.99'))
   from (select distinct (td.trans_id),
                         td.trans_identifier,
                         case
                           when o.tax_year <> to_char(sysdate, 'yyyy') then
                            o.total_overpayment_amount
                           else
                            o.taxable_amount
                         end as total_overpayment_amount
           from dbo.transaction        td,
                dbo.overpayment        o,
                dbo.overpayment_detail od
          where o.overpayment_id = od.overpayment_id
            and td.trans_source_key = o.overpayment_id
            and od.source_entity_id =
                dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
            and od.source_key_value = %PENSION_APPLICATION_ID
            and td.trans_source_entity =
                dbo.pkg_benefit_s.f_get_entity_id('OVERPAYMENT')
            and td.balance_due <> 0
          order by td.trans_id)",,Pension
646,Overpayment Monthly Deduction Amt,OVERPAYMENT_MONT_DED_AMT,"select '$'||trim(to_char(dr.net_amt * 0.3,'999,999,999.99'))
  													from dbo.disbursement_request dr
 													where dr.source_key_value = %PENSION_APPLICATION_ID",,Pension
647,CA Death letter,CA_DEATH_LETTER_BOOKMARK,"select case
         when p.death_date between trunc(SYSDATE, 'MM') and
              (ADD_MONTHS(trunc(SYSDATE, 'MM'), 1) - 1) then
          'FP_NT_MADE'
         when p.death_date <= (trunc(SYSDATE, 'MM') - 1) then
          'FP_MADE'
       end
  from dbo.person p, dbo.member mem
 where mem.person_id = p.person_id
   and mem.member_id =%MEMBER_ID",,Member
648,Member Overpayment Count,MEMBER_OVERPAYMENT_CNT,"select decode(nvl((select trim(sum(od.total_overpayment_amount))
                    from dbo.overpayment o, dbo.overpayment_detail od
                   where o.overpayment_id = od.overpayment_id
                     and od.source_key_value = %PENSION_APPLICATION_ID),
                  0),
              0,
              'F',
              'T')
  from dual",,Member
649,CA Death letter mail block bkmrk,CA_DEATH_LTR_MAIL_BLK,"select case
           when count(*) >= 1 then
            'made by direct deposit'
           else
            'mailed'
         end
    from dbo.eft_authorization ea, dbo.eft_authorization_header eah
   where eah.source_key_value = %PENSION_APPLICATION_ID
     and ea.recipient_entity_id =
         dbo.pkg_benefit_s.f_get_entity_id('PERSON')
     and ea.eft_authorization_header_id = eah.eft_authorization_header_id
     and trunc(sysdate) between eah.start_date and
         nvl(eah.end_date, trunc(sysdate))
     and ea.eft_approval_status = 'A'",,Member
650,CA Death letter overpymnt bkmrk,CA_DEATH_LTR_OVR_PYMT_AMT,"select '$'||trim(to_char(nvl((select trim(sum(od.total_overpayment_amount))
               from dbo.overpayment o, dbo.overpayment_detail od
              where o.overpayment_id = od.overpayment_id
                and od.source_key_value =%PENSION_APPLICATION_ID),
             0),'999,999,990.99'))
    from dual",,Member
651,CA Death letter CA net payment amount,CA_DEATH_LTR_CA_NET_PAY_AMT,"select '$' || trim(to_char(client.pkg_ipers_disb.f_get_deduction_est_value(ds.disbursement_schedule_id,
                                                                           'NET'),
                           '999,999,990.99'))
  from dbo.disburse_schedule ds
 where ds.source_entity =
       dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
   and ds.source_key = %PENSION_APPLICATION_ID
   and (select per.death_date
          from dbo.person per
         where per.person_id =
               (select bek.key_value
                  from dbo.business_entity_key bek
                 where bek.business_entity_key_id =
                       (select pa.owner_business_entity_key_id
                          from dbo.pension_application pa
                         where pa.application_id = %PENSION_APPLICATION_ID))) between
       ds.start_date and
       nvl(ds.stop_date,
           (select per.death_date
              from dbo.person per
             where per.person_id =
                   (select bek.key_value
                      from dbo.business_entity_key bek
                     where bek.business_entity_key_id =
                           (select pa.owner_business_entity_key_id
                              from dbo.pension_application pa
                             where pa.application_id = %PENSION_APPLICATION_ID))))",,Member
652,CA Death letter payment date,CA_DEATH_LTR_PAYMENT_DATE,"select trim(to_char(ADD_MONTHS(trunc((select per.death_date
                                       from dbo.person per
                                      where per.person_id =
                                            (select bek.key_value
                                               from dbo.business_entity_key bek
                                              where bek.business_entity_key_id =
                                                    (select pa.owner_business_entity_key_id
                                                       from dbo.pension_application pa
                                                      where pa.application_id =
                                                            %PENSION_APPLICATION_ID))),
                                     'MM'),
                               1) - 1,
                    'mm/dd/yyyy')) as death_date
  from dual",,Member
658,Member Info2,MEMBER_INFO_2,"select trim(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                      P.PREFIX,
                                                      'Y',
                                                      'N') || ' ' ||
            (P.FIRST_NAME) || ' ' || (p.middle_name) || ' ' ||
            (p.last_name) || ' ' ||
            dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                      P.SUFFIX,
                                                      'Y',
                                                      'N')) as memberName,
       dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                 P.PREFIX,
                                                 'Y',
                                                 'N') as prefix,
       (p.first_name) as firstName,
       (p.middle_name) as middleName,
       (p.last_name) as lastName,
       dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                 P.SUFFIX,
                                                 'Y',
                                                 'N') as suffix,
       p.birth_date as birthDate,
       p.sex as sex,
       p.alt_identifier as altId,
       p.status as status,
       p.ssn as ssn,
       p.death_date as DeathDate
  from dbo.member m, dbo.person p
 where m.member_id = (select pa.member_id
                        from dbo.pension_application pa
                       where pa.application_id = %PENSION_APPLICATION_ID
                      )
   and p.person_id = m.person_id
",,Member
659,Beneficiary Info2,BENEFICIARY_INFO_2,"select upper(bp.first_name) || case
         when bp.last_name is not null THEN
          ' ' || upper(bp.last_name)
       end beneficiary_name,
       upper(trim(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                            bp.PREFIX,
                                                            'Y',
                                                            'N') || ' ' ||
                  (bp.FIRST_NAME) || ' ' || (bp.middle_name) || ' ' ||
                  (bp.last_name) || ' ' ||
                  dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                            bp.SUFFIX,
                                                            'Y',
                                                            'N'))) as Beneficiary_Full_Name,
       bt.beneficiary_type_code,
       to_char(be.start_date, 'mm/dd/rrrr') start_date,
       dbo.pkg_benefit_s.f_get_value_description('RELATION',
                                                 lb.relation,
                                                 lb.relation,
                                                 'N') relation,
       nvl2(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                      bp.PREFIX,
                                                      'Y',
                                                      'N'),
            UPPER(dbo.pkg_benefit_s.f_get_value_description('PREFIX',
                                                            bp.PREFIX,
                                                            'Y',
                                                            'N')) || ' ',
            '') || UPPER(bp.FIRST_NAME) || ' ' ||
       nvl2(bp.middle_name, UPPER(bp.middle_name) || ' ', '') ||
       UPPER(bp.last_name) ||
       nvl2(dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                      bp.SUFFIX,
                                                      'Y',
                                                      'N'),
            ' ' || dbo.pkg_benefit_s.f_get_value_description('SUFFIX',
                                                             bp.SUFFIX,
                                                             'Y',
                                                             'N'),
            '') as bene_name_space,
       upper(bp.first_name) || case
         when bp.last_name is not null THEN
          ' ' || upper(bp.last_name) || ':'
       end new_name,
       bp.death_date
  from web.v_linked_beneficiaries lb,
       dbo.beneficiary            be,
       dbo.beneficiary_type       bt,
       dbo.person                 bp,
       DBO.Member                 m
 where lb.alt_beneficiary_id = be.alt_beneficiary_id
   and be.beneficiary_type_id = bt.beneficiary_type_id
   and be.start_date <= trunc(sysdate)
   and be.entity_id = dbo.pkg_benefit_s.f_get_entity_id('PERSON')
   and lb.dependent_id = bp.person_id
   and m.person_id = be.person_id
   and m.member_id =
       (select pa.member_id
          from dbo.pension_application pa
         where pa.application_id = %PENSION_APPLICATION_ID)
 order by bt.beneficiary_type_code, bp.last_name, bp.first_name
",,Pension
640,Member Address concatenated with member_id,GENERIC_MEMBER_ADDRESS_MEM_ID,"select client.f_get_member_address(%MEMBER_ID) as address_using_member_id
from dual",,Member
228,Authorized Agent Complete Address,AUTHORIZED_AGENT_COMPLETE_ADDRESS,"select decode(%PID_STOP_DATE,

              null,

              (select decode(a.address, null, '', a.address || chr(10)) ||

                      a.city || ' ' || a.state || ' ' || (a.zip) as address

                 from (select max(decode(a.attribute_name,

                                         'DS_MC_ADDRESS',

                                         dv.value)) as address,

                              max(decode(a.attribute_name,

                                         'DS_MC_CITY',

                                         dv.value)) as city,

                              max(decode(a.attribute_name,

                                         'DS_MC_STATE',

                                         dv.value)) as state,

                              max(decode(a.attribute_name,

                                         'DS_MC_ZIP',

                                         dv.value)) as zip

                         from dbo.datasheet_value dv

                        inner join dbo.attribute a

                           on dv.attribute_id = a.attribute_id

                        where dv.datasheet_id =

                              dbo.pkg_benefit_ds.f_get_datasheet_id('DS_MEMBER_CONTACTS')

                          and dv.owner_id =

                              dbo.pkg_benefit_ds.f_get_owner_id('MEMBER')

                          and dv.key_value = %MEMBER_ID

                          and dv.seq_no =

                              (select max(dv.seq_no)

                                 from dbo.datasheet_value dv

                                where dv.key_value = %MEMBER_ID

                                  and dv.datasheet_id =

                                      dbo.pkg_benefit_ds.f_get_datasheet_id('DS_MEMBER_CONTACTS')

                                  and dv.owner_id =

                                      dbo.pkg_benefit_ds.f_get_owner_id('MEMBER')

                                  and dv.value = 'Y')) a),

              (select address

                 from (select decode(dq.ds_mc_address,

                                     null,

                                     '',

                                     dq.ds_mc_address || chr(10)) ||

                              dq.ds_mc_city || ' ' || dq.ds_mc_state || ' ' ||

                              (dq.ds_mc_zip) as address

                         from dbo.V_DS_MEMBER_DSMEMBERCON_073_Q dq

                        where dq.key_value = %MEMBER_ID

                          and dq.ds_mc_stop_date = %PID_STOP_DATE

                        order by dq.seq_no desc)

                where rownum = 1))

  from dual",,Member
641,New IPERS logo Full Image,IPERS_LOGO,"select fpd.page_image,25 as x_scale,7 as y_scale

                                                    from imaging.form_page_definition fpd

                                                    inner join imaging.form_definition fd on fpd.form_definition_id = fd.form_definition_id

                                                    where fd.internal_name = 'IPERS_LOGO'",,Pension
637,option 6 using ben_summary_block,OPTION_6_RECALC,"Select decode(pt.pension_type_code,
--checking if its a switched app and if pension_type is regular deisability then pull option6 amount else use exisiting logic
              'IPREGDIS',
              (select '$' ||
                      nvl(client.f_get_pfv_value(%PENSION_APPLICATION_ID, 'PN_OPT_6_PRES_AGE'),
                          '0.00')
                 from dual),
              (select trim(Amount_02) as Current_Month
                 from table(CLIENT.f_get_ss_ben_summary_block(%PENSION_APPLICATION_ID,
                                                              %PERSON_ID))
                where rownum = 1)) option_6
  from dbo.pension_application pa,
       dbo.pension_option      po,
       dbo.pension_type        pt
 where po.pension_type_id = pt.pension_type_id
   and po.pension_option_id = pa.pension_option_id
   and pa.application_id = %PENSION_APPLICATION_ID",,Member
613,EFT Bank Address Pension App,EFT_BANK_ADDRESS_PENSION_APP,"select BANK_NAME,ADDRESS_1,ADDRESS_2,CITY,STATE, ZIP_CODE,routing_num,rec_acc_type,rec_acc_num 
                                                               from(select oo.oi_name BANK_NAME,
                                                                           ad.address_1 ADDRESS_1,
                                                                           ad.address_2 ADDRESS_2,
                                                                           ad.city CITY,
                                                                           ad.state STATE,
                                                                           dbo.pkg_benefit_s.f_build_zipcode(ad.zip) ZIP_CODE,
                                                                           lpad(ea.routing_no, 9, '0') as routing_num,
                                                                           decode(nvl(ea.recipient_account_type, 'C'),
                                                                                  'C',
                                                                                  'checking',
                                                                                  'S',
                                                                                  'savings') as rec_acc_type,
                                                                           trim(ea.recipient_account_no) as rec_acc_num
                                                                      from dbo.eft_authorization        ea,
                                                                           dbo.eft_authorization_header eah,
                                                                           dbo.addresses                ad,
                                                                           dbo.oi_organization          oo
                                                                     where ea.eft_authorization_header_id = eah.eft_authorization_header_id
                                                                       and eah.source_entity_id =
                                                                           dbo.pkg_benefit_s.f_get_entity_id('PENSION_APPLICATION')
                                                                       and eah.source_key_value = %PENSION_APPLICATION_ID
                                                                       and trunc(sysdate) between eah.start_date and
                                                                           nvl(eah.end_date, trunc(sysdate) + 1)
                                                                       and eah.recipient_entity_id =
                                                                           dbo.pkg_benefit_s.f_get_entity_id('PERSON')
                                                                       and ea.oi_organization_id = oo.oi_organization_id
                                                                       and ad.entity_id =
                                                                           dbo.pkg_benefit_s.f_get_entity_id('OI_ORGANIZATION')
                                                                       and ad.key_value = oo.oi_organization_id
                                                                       and trunc(sysdate) between ad.start_date and
                                                                           nvl(ad.stop_date, trunc(sysdate) + 1))
                                                              where ROWNUM = 1",,Member
642,Correspondence datasheet bookmarks,CORRESPONDENCE_DATASHEET_BOOKMARKS,"select upper(CORRESPONDENT_FIRST_NAME) as CORRESPONDENT_FIRST_NAME,
       upper(CORRESPONDENT_LAST_NAME) as CORRESPONDENT_LAST_NAME,
       upper(TRIM(decode(ADDRESS_QUALIFIER,
                         null,
                         '',
                         upper(ADDRESS_QUALIFIER) || chr(10)) ||
                  decode(ADDRESS_01, null, '', upper(ADDRESS_01)) ||
                  decode(ADDRESS_02, null, '', chr(10) || upper(ADDRESS_02)) ||
                  chr(10) || upper(CITY) || ' ' || upper(STATE) || ' ' ||
                  dbo.pkg_benefit_s.f_build_zipcode(ZIP))) as CORRESPONDENT_FULL_ADDRESS
  from (select max(decode(ata.attribute_name, 'DS_FIRST_NAME_2', dav.value)) as CORRESPONDENT_FIRST_NAME,
               max(decode(ata.attribute_name, 'DS_LAST_NAME_2', dav.value)) as CORRESPONDENT_LAST_NAME,
               max(decode(ata.attribute_name,
                          'DS_ADDRESS_QUALIFIER',
                          dav.value)) as ADDRESS_QUALIFIER,
               max(decode(ata.attribute_name, 'DS_ADDRESS_01', dav.value)) as ADDRESS_01,
               max(decode(ata.attribute_name, 'DS_ADDRESS_02', dav.value)) as ADDRESS_02,
               max(decode(ata.attribute_name, 'DS_CITY_2', dav.value)) as CITY,
               max(decode(ata.attribute_name, 'DS_STATE_2', dav.value)) as STATE,
               max(decode(ata.attribute_name, 'DS_ZIP_2', dav.value)) as ZIP
          from dbo.attribute ata, dbo.datasheet_value dav
         where dav.attribute_id = ata.attribute_id
           and dav.datasheet_id =
               dbo.pkg_benefit_ds.f_get_datasheet_id('DS_CORRESPONDENCE')
           and dav.owner_id =
               dbo.pkg_benefit_ds.f_get_owner_id('PENSION_APPLICATION')
           and dav.key_value = to_char(%PENSION_APPLICATION_ID)
           and dav.seq_no = 1)",,Member
654,AP Pen First Mon Of Payment,AP_PEN_FIRST_MON_OF_PAYMENT,select CLIENT.f_get_first_mnt_of_pyt_date(%PENSION_APPLICATION_ID) from dual,,Member
